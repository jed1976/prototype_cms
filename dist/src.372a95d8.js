(function () {function q(a){return a&&a.__esModule?{d:a.default}:{d:a}}var n=this;var jj="#".charCodeAt(0),Bi=".".charCodeAt(0),Ud=0,Qd=1,Ah=2,sh=function($){for(var t=null,e=null,r=null,a=Ud,o=0,i=0;i<=$.length;i++){var n=$.charCodeAt(i),s=n===jj,l=n===Bi;(s||l||!n)&&(a===Ud?t=0===i?"div":$.substring(o,i):a===Qd?e=$.substring(o,i):r?r+=" "+$.substring(o,i):r=$.substring(o,i),s?a=Qd:l&&(a=Ah),o=i+1)}return{tag:t,id:e,className:r}},ud=function($,t){var e=sh($),r=e.tag,a=e.id,o=e.className,i=t?document.createElementNS(t,r):document.createElement(r);return a&&(i.id=a),o&&(t?i.setAttribute("class",o):i.className=o),i},X=function($,t){var e=p($),r=p(t);return t===r&&r.__redom_view&&(t=r.__redom_view),r.parentNode&&(Yc(t,r,e),e.removeChild(r)),t},Yc=function($,t,e){var r=t.__redom_lifecycle;if(Uc(r))t.__redom_mounted=!1;else{var a=e;for(t.__redom_mounted&&Va(t,"onunmount");a;){var o=a.__redom_lifecycle||{};for(var i in r)o[i]&&(o[i]-=r[i]);Uc(o)&&(a.__redom_lifecycle=null),a=a.parentNode}}},Uc=function($){if(null==$)return!0;for(var t in $)if($[t])return!1;return!0},Sc=["onmount","onunmount"],sf="undefined"!=typeof window&&"ShadowRoot"in window,W=function($,t,e){var r=p($),a=p(t);t===a&&a.__redom_view&&(t=a.__redom_view),t!==a&&(a.__redom_view=t);var o=a.__redom_mounted,i=a.parentNode;return o&&i!==r&&Yc(t,a,i),null!=e?r.insertBefore(a,p(e)):r.appendChild(a),mf(t,a,r,i),t},mf=function($,t,e,r){for(var a=t.__redom_lifecycle||(t.__redom_lifecycle={}),o=e===r,i=!1,n=0;n<Sc.length;n++){var s=Sc[n];!o&&$!==t&&s in $&&(a[s]=(a[s]||0)+1),a[s]&&(i=!0)}if(i){var l=e,L=!1;if((o||!L&&l&&l.__redom_mounted)&&(Va(t,o?"onremount":"onmount"),L=!0),!o)for(;l;){var v=l.parentNode,F=l.__redom_lifecycle||(l.__redom_lifecycle={});for(var u in a)F[u]=(F[u]||0)+a[u];!L&&(l===document||sf&&l instanceof window.ShadowRoot||v&&v.__redom_mounted)&&(Va(l,o?"onremount":"onmount"),L=!0),l=v}}else t.__redom_mounted=!0},Va=function($,t){"onmount"===t?$.__redom_mounted=!0:"onunmount"===t&&($.__redom_mounted=!1);var e=$.__redom_lifecycle;if(e){var r=$.__redom_view,a=0;for(var o in r&&r[t]&&r[t](),e)o&&a++;if(a)for(var i=$.firstChild;i;){var n=i.nextSibling;Va(i,t),i=n}}},s=function($,t,e){var r=p($);if(void 0!==e)r.style[t]=e;else if(Da(t))r.setAttribute("style",t);else for(var a in t)s(r,a,t[a])},ff="http://www.w3.org/1999/xlink",Kb=function($,t,e){var r=p($),a=r instanceof SVGElement;if(void 0!==e){if("style"===t)s(r,e);else if(a&&Ea(e))r[t]=e;else if("dataset"===t)cf(r,e);else if(!a&&(t in r||Ea(e)))r[t]=e;else{if(a&&"xlink"===t)return void df(r,e);r.setAttribute(t,e)}}else for(var o in t)Kb(r,o,t[o])};function df($,t){for(var e in t)$.setAttributeNS(ff,e,t[e])}function cf($,t){for(var e in t)$.dataset[e]=t[e]}var ha=function($){return document.createTextNode(null!=$?$:"")},Ob=function($,t){for(var e=0;e<t.length;e++){var r=t[e];(0===r||r)&&("function"==typeof r?r($):Da(r)||fe(r)?$.appendChild(ha(r)):cb(p(r))?W($,r):r.length?Ob($,r):"object"==typeof r&&Kb($,r))}},pc=function($){return Da($)?T($):p($)},p=function($){return $.nodeType&&$||!$.el&&$||p($.el)},Da=function($){return"string"==typeof $},fe=function($){return"number"==typeof $},Ea=function($){return"function"==typeof $},cb=function($){return $&&$.nodeType},jc={},mc=function($){return jc[$]||(jc[$]=ud($))},T=function($){for(var t,e=[],r=arguments.length-1;r-->0;)e[r]=arguments[r+1];if(Da($))t=mc($).cloneNode(!1);else if(cb($))t=$.cloneNode(!1);else{if(!Ea($))throw new Error("At least one argument required");var a=$;t=new(Function.prototype.bind.apply(a,[null].concat(e)))}return Ob(p(t),e),t};T.extend=function($){for(var t=[],e=arguments.length-1;e-->0;)t[e]=arguments[e+1];var r=mc($);return T.bind.apply(T,[this,r].concat(t))};var Jg=T,e=T,u=function($){for(var t=[],e=arguments.length-1;e-->0;)t[e]=arguments[e+1];for(var r=yc($,t,p($).firstChild);r;){var a=r.nextSibling;X($,r),r=a}};function yc($,t,e){for(var r=e,a=0;a<t.length;a++){var o=t[a];if(o){var i=p(o);i!==r?cb(i)?W($,o,r):null!=o.length&&(r=yc($,o,r)):r=r.nextSibling}}return r}var eg=function($){return function(t){return t[$]}},Ee=function($,t,e){return new Na($,t,e)},Na=function($,t,e){this.View=$,this.initData=e,this.oldLookup={},this.lookup={},this.oldViews=[],this.views=[],null!=t&&(this.lookup={},this.key=Ea(t)?t:eg(t))};Na.prototype.update=function($,t){for(var e=this.View,r=this.key,a=this.initData,o=null!=r,i=this.lookup,n={},s=new Array($.length),l=this.views,L=0;L<$.length;L++){var v=$[L],F=void 0;if(o){var u=r(v);F=i[u]||new e(a,v,L,$),n[u]=F,F.__redom_id=u}else F=l[L]||new e(a,v,L,$);F.update&&F.update(v,L,$,t),p(F.el).__redom_view=F,s[L]=F}this.oldViews=l,this.views=s,this.oldLookup=i,this.lookup=n};var Zb=function($,t,e,r){return new ca($,t,e,r)},ca=function($,t,e,r){this.__redom_list=!0,this.View=t,this.initData=r,this.views=[],this.pool=new Na(t,e,r),this.el=pc($),this.keySet=null!=e};ca.prototype.update=function($,t){void 0===$&&($=[]);var e=this.keySet,r=this.views,a=e&&this.lookup;this.pool.update($,t);var o=this.pool,i=o.views,n=o.lookup;if(e)for(var s=0;s<r.length;s++){var l=r[s].__redom_id;l in n||X(this,a[l])}u(this,i),e&&(this.lookup=n),this.views=i},ca.extend=function($,t,e,r){return ca.bind(ca,$,t,e,r)},Zb.extend=ca.extend;var tg=function($,t){return new Xb($,t)},Xb=function($,t){this.el=ha(""),this.visible=!1,this.view=null,this._placeholder=this.el,$ instanceof Node?this._el=$:this._View=$,this._initData=t};Xb.prototype.update=function($,t){var e=this._placeholder,r=this.el.parentNode;if($){if(!this.visible){if(this._el)return W(r,this._el,e),X(r,e),this.el=this._el,void(this.visible=$);var a=new(0,this._View)(this._initData);this.el=p(a),this.view=a,W(r,a,e),X(r,e)}this.view&&this.view.update&&this.view.update(t)}else if(this.visible){if(this._el)return W(r,e,this._el),X(r,this._el),this.el=e,void(this.visible=$);W(r,e,this.view),X(r,this.view),this.el=e,this.view=null}this.visible=$};var _f=function($,t,e){return new Db($,t,e)},Db=function($,t,e){this.el=pc($),this.Views=t,this.initData=e};Db.prototype.update=function($,t){if($!==this.route){var e=this.Views[$];this.route=$,this.view=e&&new e(this.initData,t),u(this.el,[this.view])}this.view&&this.view.update&&this.view.update(t,$)};var $c="http://www.w3.org/2000/svg",ed={},md=function($){return ed[$]||(ed[$]=ud($,$c))},na=function($){for(var t,e=[],r=arguments.length-1;r-->0;)e[r]=arguments[r+1];if(Da($))t=md($).cloneNode(!1);else if(cb($))t=$.cloneNode(!1);else{if(!Ea($))throw new Error("At least one argument required");var a=$;t=new(Function.prototype.bind.apply(a,[null].concat(e)))}return Ob(p(t),e),t};na.extend=function($){var t=md($);return na.bind(this,t)},na.ns=$c;var $f=na;ha,na,$f,u,s,Kb,Db,_f,Xb,tg,X,W,Na,Ee,ca,Zb,T,e,Jg;var kg=function(e,t){var r=e.el||e,n=function(e){var r=e.detail,n=r.type,o=r.data;t[n]&&t[n](o)};return r.addEventListener("redom",n),{remove:function(){r.removeEventListener("redom",n)}}};var Xd={},Jf=function(e,t,o){return{"collection:add":function(e){},"list:selection":function(t){var c=localStorage.getItem("selectedCollection"),r=localStorage.getItem("selectedRecord"),n=t.target.id;switch(t.list.id){case"collections":if(n!==localStorage.getItem("selectedCollection")){var l=o.filter(function(e){return e.parent===n}).shift();r=l?l._id:null}c=n;break;case"records":r=n;}localStorage.setItem("selectedCollection",c),localStorage.setItem("selectedRecord",r),e.update(o)},"record:add":function(c){var r=localStorage.getItem("selectedCollection"),n=o.filter(function(e){return e._id===r}).shift(),l=n.fields.map(function(e){return e.name}),a=new Date().toJSON(),i={_id:n.name+"-"+a,created:a,modified:a,status:"draft",type:"record",parent:n._id};l.forEach(function(e){return i[e]=""}),i.name="New Record",t.put(i).then(function(t){localStorage.setItem("selectedRecord",i._id),e.update(o)})},"record:delete":function(c){t.get(c.id).then(function(e){return t.remove(e)}).then(function(t){var c=localStorage.getItem("selectedCollection"),r=o.filter(function(e){return e.parent===c}).shift();localStorage.setItem("selectedRecord",r._id),e.update(o)}).catch(function(e){return console.error(e)})},"record:update":function(e){}}};Xd.actions=Jf;var fa,ea,Q={},d=Q={};function Pb(){throw new Error("setTimeout has not been defined")}function cc(){throw new Error("clearTimeout has not been defined")}function ce($){if(fa===setTimeout)return setTimeout($,0);if((fa===Pb||!fa)&&setTimeout)return fa=setTimeout,setTimeout($,0);try{return fa($,0)}catch(e){try{return fa.call(null,$,0)}catch(e){return fa.call(this,$,0)}}}var qa={};function gf(r){return function(){var a=arguments.length;if(a){for(var t=[],$=-1;++$<a;)t[$]=arguments[$];return r.call(this,t)}return r.call(this,[])}}qa=gf;var Dj,ze,M={},be=n.MutationObserver||n.WebKitMutationObserver;if(be){var jg=0,Ng=new be(Ya),ae=n.document.createTextNode("");Ng.observe(ae,{characterData:!0}),Dj=function(){ae.data=jg=++jg%2}}else if(n.setImmediate||void 0===n.MessageChannel)Dj="document"in n&&"onreadystatechange"in n.document.createElement("script")?function(){var $=n.document.createElement("script");$.onreadystatechange=function(){Ya(),$.onreadystatechange=null,$.parentNode.removeChild($),$=null},n.document.documentElement.appendChild($)}:function(){setTimeout(Ya,0)};else{var $d=new n.MessageChannel;$d.port1.onmessage=Ya,Dj=function(){$d.port2.postMessage(0)}}var Qa=[];function Ya(){var $,e;ze=!0;for(var n=Qa.length;n;){for(e=Qa,Qa=[],$=-1;++$<n;)e[$]();n=Qa.length}ze=!1}function of($){1!==Qa.push($)||ze||Dj()}M=of;var l={};function h(){this._events=this._events||{},this._maxListeners=this._maxListeners||void 0}function L(e){return"function"==typeof e}function zg(e){return"number"==typeof e}function Ga(e){return"object"==typeof e&&null!==e}function Vd(e){return void 0===e}l=h,h.EventEmitter=h,h.prototype._events=void 0,h.prototype._maxListeners=void 0,h.defaultMaxListeners=10,h.prototype.setMaxListeners=function(e){if(!zg(e)||e<0||isNaN(e))throw TypeError("n must be a positive number");return this._maxListeners=e,this},h.prototype.emit=function(e){var t,r,i,n,s,v;if(this._events||(this._events={}),"error"===e&&(!this._events.error||Ga(this._events.error)&&!this._events.error.length)){if((t=arguments[1])instanceof Error)throw t;var o=new Error("Uncaught, unspecified \"error\" event. ("+t+")");throw o.context=t,o}if(Vd(r=this._events[e]))return!1;if(L(r))switch(arguments.length){case 1:r.call(this);break;case 2:r.call(this,arguments[1]);break;case 3:r.call(this,arguments[1],arguments[2]);break;default:n=Array.prototype.slice.call(arguments,1),r.apply(this,n);}else if(Ga(r))for(n=Array.prototype.slice.call(arguments,1),i=(v=r.slice()).length,s=0;s<i;s++)v[s].apply(this,n);return!0},h.prototype.addListener=function(e,t){var r;if(!L(t))throw TypeError("listener must be a function");return this._events||(this._events={}),this._events.newListener&&this.emit("newListener",e,L(t.listener)?t.listener:t),this._events[e]?Ga(this._events[e])?this._events[e].push(t):this._events[e]=[this._events[e],t]:this._events[e]=t,Ga(this._events[e])&&!this._events[e].warned&&(r=Vd(this._maxListeners)?h.defaultMaxListeners:this._maxListeners)&&r>0&&this._events[e].length>r&&(this._events[e].warned=!0,console.error("(node) warning: possible EventEmitter memory leak detected. %d listeners added. Use emitter.setMaxListeners() to increase limit.",this._events[e].length),"function"==typeof console.trace&&console.trace()),this},h.prototype.on=h.prototype.addListener,h.prototype.once=function(e,t){if(!L(t))throw TypeError("listener must be a function");var r=!1;function i(){this.removeListener(e,i),r||(r=!0,t.apply(this,arguments))}return i.listener=t,this.on(e,i),this},h.prototype.removeListener=function(e,t){var r,i,n,s;if(!L(t))throw TypeError("listener must be a function");if(!this._events||!this._events[e])return this;if(n=(r=this._events[e]).length,i=-1,r===t||L(r.listener)&&r.listener===t)delete this._events[e],this._events.removeListener&&this.emit("removeListener",e,t);else if(Ga(r)){for(s=n;s-->0;)if(r[s]===t||r[s].listener&&r[s].listener===t){i=s;break}if(i<0)return this;1===r.length?(r.length=0,delete this._events[e]):r.splice(i,1),this._events.removeListener&&this.emit("removeListener",e,t)}return this},h.prototype.removeAllListeners=function(e){var t,r;if(!this._events)return this;if(!this._events.removeListener)return 0===arguments.length?this._events={}:this._events[e]&&delete this._events[e],this;if(0===arguments.length){for(t in this._events)"removeListener"!==t&&this.removeAllListeners(t);return this.removeAllListeners("removeListener"),this._events={},this}if(L(r=this._events[e]))this.removeListener(e,r);else if(r)for(;r.length;)this.removeListener(e,r[r.length-1]);return delete this._events[e],this},h.prototype.listeners=function(e){return this._events&&this._events[e]?L(this._events[e])?[this._events[e]]:this._events[e].slice():[]},h.prototype.listenerCount=function(e){if(this._events){var t=this._events[e];if(L(t))return 1;if(t)return t.length}return 0},h.listenerCount=function(e,t){return e.listenerCount(t)};var we={};we="function"==typeof Object.create?function(t,o){t.super_=o,t.prototype=Object.create(o.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}})}:function(t,o){t.super_=o;var e=function(){};e.prototype=o.prototype,t.prototype=new e,t.prototype.constructor=t};var lb,nb={};!function(t){if("object"==typeof nb)nb=t();else if("function"==typeof lb&&lb.amd)lb(t);else{var r;try{r=window}catch(t){r=self}r.SparkMD5=t()}}(function(t){var r=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"];function e(t,r){var e=t[0],n=t[1],f=t[2],i=t[3];n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&f|~n&i)+r[0]-680876936|0)<<7|e>>>25)+n|0)&n|~e&f)+r[1]-389564586|0)<<12|i>>>20)+e|0)&e|~i&n)+r[2]+606105819|0)<<17|f>>>15)+i|0)&i|~f&e)+r[3]-1044525330|0)<<22|n>>>10)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&f|~n&i)+r[4]-176418897|0)<<7|e>>>25)+n|0)&n|~e&f)+r[5]+1200080426|0)<<12|i>>>20)+e|0)&e|~i&n)+r[6]-1473231341|0)<<17|f>>>15)+i|0)&i|~f&e)+r[7]-45705983|0)<<22|n>>>10)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&f|~n&i)+r[8]+1770035416|0)<<7|e>>>25)+n|0)&n|~e&f)+r[9]-1958414417|0)<<12|i>>>20)+e|0)&e|~i&n)+r[10]-42063|0)<<17|f>>>15)+i|0)&i|~f&e)+r[11]-1990404162|0)<<22|n>>>10)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&f|~n&i)+r[12]+1804603682|0)<<7|e>>>25)+n|0)&n|~e&f)+r[13]-40341101|0)<<12|i>>>20)+e|0)&e|~i&n)+r[14]-1502002290|0)<<17|f>>>15)+i|0)&i|~f&e)+r[15]+1236535329|0)<<22|n>>>10)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&i|f&~i)+r[1]-165796510|0)<<5|e>>>27)+n|0)&f|n&~f)+r[6]-1069501632|0)<<9|i>>>23)+e|0)&n|e&~n)+r[11]+643717713|0)<<14|f>>>18)+i|0)&e|i&~e)+r[0]-373897302|0)<<20|n>>>12)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&i|f&~i)+r[5]-701558691|0)<<5|e>>>27)+n|0)&f|n&~f)+r[10]+38016083|0)<<9|i>>>23)+e|0)&n|e&~n)+r[15]-660478335|0)<<14|f>>>18)+i|0)&e|i&~e)+r[4]-405537848|0)<<20|n>>>12)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&i|f&~i)+r[9]+568446438|0)<<5|e>>>27)+n|0)&f|n&~f)+r[14]-1019803690|0)<<9|i>>>23)+e|0)&n|e&~n)+r[3]-187363961|0)<<14|f>>>18)+i|0)&e|i&~e)+r[8]+1163531501|0)<<20|n>>>12)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n&i|f&~i)+r[13]-1444681467|0)<<5|e>>>27)+n|0)&f|n&~f)+r[2]-51403784|0)<<9|i>>>23)+e|0)&n|e&~n)+r[7]+1735328473|0)<<14|f>>>18)+i|0)&e|i&~e)+r[12]-1926607734|0)<<20|n>>>12)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n^f^i)+r[5]-378558|0)<<4|e>>>28)+n|0)^n^f)+r[8]-2022574463|0)<<11|i>>>21)+e|0)^e^n)+r[11]+1839030562|0)<<16|f>>>16)+i|0)^i^e)+r[14]-35309556|0)<<23|n>>>9)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n^f^i)+r[1]-1530992060|0)<<4|e>>>28)+n|0)^n^f)+r[4]+1272893353|0)<<11|i>>>21)+e|0)^e^n)+r[7]-155497632|0)<<16|f>>>16)+i|0)^i^e)+r[10]-1094730640|0)<<23|n>>>9)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n^f^i)+r[13]+681279174|0)<<4|e>>>28)+n|0)^n^f)+r[0]-358537222|0)<<11|i>>>21)+e|0)^e^n)+r[3]-722521979|0)<<16|f>>>16)+i|0)^i^e)+r[6]+76029189|0)<<23|n>>>9)+f|0,n=((n+=((f=((f+=((i=((i+=((e=((e+=(n^f^i)+r[9]-640364487|0)<<4|e>>>28)+n|0)^n^f)+r[12]-421815835|0)<<11|i>>>21)+e|0)^e^n)+r[15]+530742520|0)<<16|f>>>16)+i|0)^i^e)+r[2]-995338651|0)<<23|n>>>9)+f|0,n=((n+=((i=((i+=(n^((e=((e+=(f^(n|~i))+r[0]-198630844|0)<<6|e>>>26)+n|0)|~f))+r[7]+1126891415|0)<<10|i>>>22)+e|0)^((f=((f+=(e^(i|~n))+r[14]-1416354905|0)<<15|f>>>17)+i|0)|~e))+r[5]-57434055|0)<<21|n>>>11)+f|0,n=((n+=((i=((i+=(n^((e=((e+=(f^(n|~i))+r[12]+1700485571|0)<<6|e>>>26)+n|0)|~f))+r[3]-1894986606|0)<<10|i>>>22)+e|0)^((f=((f+=(e^(i|~n))+r[10]-1051523|0)<<15|f>>>17)+i|0)|~e))+r[1]-2054922799|0)<<21|n>>>11)+f|0,n=((n+=((i=((i+=(n^((e=((e+=(f^(n|~i))+r[8]+1873313359|0)<<6|e>>>26)+n|0)|~f))+r[15]-30611744|0)<<10|i>>>22)+e|0)^((f=((f+=(e^(i|~n))+r[6]-1560198380|0)<<15|f>>>17)+i|0)|~e))+r[13]+1309151649|0)<<21|n>>>11)+f|0,n=((n+=((i=((i+=(n^((e=((e+=(f^(n|~i))+r[4]-145523070|0)<<6|e>>>26)+n|0)|~f))+r[11]-1120210379|0)<<10|i>>>22)+e|0)^((f=((f+=(e^(i|~n))+r[2]+718787259|0)<<15|f>>>17)+i|0)|~e))+r[9]-343485551|0)<<21|n>>>11)+f|0,t[0]=e+t[0]|0,t[1]=n+t[1]|0,t[2]=f+t[2]|0,t[3]=i+t[3]|0}function n(t){var r,e=[];for(r=0;r<64;r+=4)e[r>>2]=t.charCodeAt(r)+(t.charCodeAt(r+1)<<8)+(t.charCodeAt(r+2)<<16)+(t.charCodeAt(r+3)<<24);return e}function f(t){var r,e=[];for(r=0;r<64;r+=4)e[r>>2]=t[r]+(t[r+1]<<8)+(t[r+2]<<16)+(t[r+3]<<24);return e}function i(t){var r,f,i,h,o,a,s=t.length,u=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=s;r+=64)e(u,n(t.substring(r-64,r)));for(f=(t=t.substring(r-64)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<f;r+=1)i[r>>2]|=t.charCodeAt(r)<<(r%4<<3);if(i[r>>2]|=128<<(r%4<<3),r>55)for(e(u,i),r=0;r<16;r+=1)i[r]=0;return h=(h=8*s).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(h[2],16),a=parseInt(h[1],16)||0,i[14]=o,i[15]=a,e(u,i),u}function h(t){var e,n="";for(e=0;e<4;e+=1)n+=r[t>>8*e+4&15]+r[t>>8*e&15];return n}function o(t){var r;for(r=0;r<t.length;r+=1)t[r]=h(t[r]);return t.join("")}function a(t){return /[\u0080-\uFFFF]/.test(t)&&(t=unescape(encodeURIComponent(t))),t}function s(t){var r,e=[],n=t.length;for(r=0;r<n-1;r+=2)e.push(parseInt(t.substr(r,2),16));return String.fromCharCode.apply(String,e)}function u(){this.reset()}return"5d41402abc4b2a76b9719d911017c592"!==o(i("hello"))&&function(t,r){var e=(65535&t)+(65535&r);return(t>>16)+(r>>16)+(e>>16)<<16|65535&e},"undefined"==typeof ArrayBuffer||ArrayBuffer.prototype.slice||function(){function r(t,r){return(t=0|t||0)<0?Math.max(t+r,0):Math.min(t,r)}ArrayBuffer.prototype.slice=function(e,n){var f,i,h,o,a=this.byteLength,s=r(e,a),u=a;return n!==t&&(u=r(n,a)),s>u?new ArrayBuffer(0):(f=u-s,i=new ArrayBuffer(f),h=new Uint8Array(i),o=new Uint8Array(this,s,f),h.set(o),i)}}(),u.prototype.append=function(t){return this.appendBinary(a(t)),this},u.prototype.appendBinary=function(t){this._buff+=t,this._length+=t.length;var r,f=this._buff.length;for(r=64;r<=f;r+=64)e(this._hash,n(this._buff.substring(r-64,r)));return this._buff=this._buff.substring(r-64),this},u.prototype.end=function(t){var r,e,n=this._buff,f=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<f;r+=1)i[r>>2]|=n.charCodeAt(r)<<(r%4<<3);return this._finish(i,f),e=o(this._hash),t&&(e=s(e)),this.reset(),e},u.prototype.reset=function(){return this._buff="",this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},u.prototype.getState=function(){return{buff:this._buff,length:this._length,hash:this._hash}},u.prototype.setState=function(t){return this._buff=t.buff,this._length=t.length,this._hash=t.hash,this},u.prototype.destroy=function(){delete this._hash,delete this._buff,delete this._length},u.prototype._finish=function(t,r){var n,f,i,h=r;if(t[h>>2]|=128<<(h%4<<3),h>55)for(e(this._hash,t),h=0;h<16;h+=1)t[h]=0;n=(n=8*this._length).toString(16).match(/(.*?)(.{0,8})$/),f=parseInt(n[2],16),i=parseInt(n[1],16)||0,t[14]=f,t[15]=i,e(this._hash,t)},u.hash=function(t,r){return u.hashBinary(a(t),r)},u.hashBinary=function(t,r){var e=o(i(t));return r?s(e):e},u.ArrayBuffer=function(){this.reset()},u.ArrayBuffer.prototype.append=function(t){var r,n,i,h,o,a=(n=this._buff.buffer,i=t,h=!0,(o=new Uint8Array(n.byteLength+i.byteLength)).set(new Uint8Array(n)),o.set(new Uint8Array(i),n.byteLength),h?o:o.buffer),s=a.length;for(this._length+=t.byteLength,r=64;r<=s;r+=64)e(this._hash,f(a.subarray(r-64,r)));return this._buff=r-64<s?new Uint8Array(a.buffer.slice(r-64)):new Uint8Array(0),this},u.ArrayBuffer.prototype.end=function(t){var r,e,n=this._buff,f=n.length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(r=0;r<f;r+=1)i[r>>2]|=n[r]<<(r%4<<3);return this._finish(i,f),e=o(this._hash),t&&(e=s(e)),this.reset(),e},u.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._hash=[1732584193,-271733879,-1732584194,271733878],this},u.ArrayBuffer.prototype.getState=function(){var t,r=u.prototype.getState.call(this);return r.buff=(t=r.buff,String.fromCharCode.apply(null,new Uint8Array(t))),r},u.ArrayBuffer.prototype.setState=function(t){return t.buff=function(t,r){var e,n=t.length,f=new ArrayBuffer(n),i=new Uint8Array(f);for(e=0;e<n;e+=1)i[e]=t.charCodeAt(e);return r?i:f}(t.buff,!0),u.prototype.setState.call(this,t)},u.ArrayBuffer.prototype.destroy=u.prototype.destroy,u.ArrayBuffer.prototype._finish=u.prototype._finish,u.ArrayBuffer.hash=function(t,r){var n=o(function(t){var r,n,i,h,o,a,s=t.length,u=[1732584193,-271733879,-1732584194,271733878];for(r=64;r<=s;r+=64)e(u,f(t.subarray(r-64,r)));for(n=(t=r-64<s?t.subarray(r-64):new Uint8Array(0)).length,i=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],r=0;r<n;r+=1)i[r>>2]|=t[r]<<(r%4<<3);if(i[r>>2]|=128<<(r%4<<3),r>55)for(e(u,i),r=0;r<16;r+=1)i[r]=0;return h=(h=8*s).toString(16).match(/(.*?)(.{0,8})$/),o=parseInt(h[2],16),a=parseInt(h[1],16)||0,i[14]=o,i[15]=a,e(u,i),u}(new Uint8Array(t)));return r?s(n):n},u});var Td={},Sd="undefined"!=typeof crypto&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&msCrypto.getRandomValues.bind(msCrypto);if(Sd){var Id=new Uint8Array(16);Td=function(){return Sd(Id),Id}}else{var Hd=new Array(16);Td=function(){for(var r,$=0;$<16;$++)0==(3&$)&&(r=4294967296*Math.random()),Hd[$]=r>>>((3&$)<<3)&255;return Hd}}for(var Gd={},Fd=[],_a=0;_a<256;++_a)Fd[_a]=(_a+256).toString(16).substr(1);function Ug($,r){var s=r||0,p=Fd;return p[$[s++]]+p[$[s++]]+p[$[s++]]+p[$[s++]]+"-"+p[$[s++]]+p[$[s++]]+"-"+p[$[s++]]+p[$[s++]]+"-"+p[$[s++]]+p[$[s++]]+"-"+p[$[s++]]+p[$[s++]]+p[$[s++]]+p[$[s++]]+p[$[s++]]+p[$[s++]]}Gd=Ug;var hh,Gh,Zh={},Ed=0,Dd=0;function xe($,a,c){var e=a&&c||0,r=a||[],s=($=$||{}).node||hh,v=void 0!==$.clockseq?$.clockseq:Gh;if(null==s||null==v){var M=Td();null==s&&(s=hh=[1|M[0],M[1],M[2],M[3],M[4],M[5]]),null==v&&(v=Gh=16383&(M[6]<<8|M[7]))}var l=void 0!==$.msecs?$.msecs:new Date().getTime(),o=void 0!==$.nsecs?$.nsecs:Dd+1,E=l-Ed+(o-Dd)/1e4;if(E<0&&void 0===$.clockseq&&(v=v+1&16383),(E<0||l>Ed)&&void 0===$.nsecs&&(o=0),o>=1e4)throw new Error("uuid.v1(): Can't create more than 10M uuids/sec");Ed=l,Dd=o,Gh=v;var n=(1e4*(268435455&(l+=122192928e5))+o)%4294967296;r[e++]=n>>>24&255,r[e++]=n>>>16&255,r[e++]=n>>>8&255,r[e++]=255&n;var t=l/4294967296*1e4&268435455;r[e++]=t>>>8&255,r[e++]=255&t,r[e++]=t>>>24&15|16,r[e++]=t>>>16&255,r[e++]=v>>>8|128,r[e++]=255&v;for(var i=0;i<6;++i)r[e+i]=s[i];return a||Gd(r)}Zh=xe;var Ha={};function Se(r,$,a){var e=$&&a||0;"string"==typeof r&&($="binary"===r?new Array(16):null,r=null);var n=(r=r||{}).random||(r.rng||Td)();if(n[6]=15&n[6]|64,n[8]=63&n[8]|128,$)for(var U=0;U<16;++U)$[e+U]=n[U];return $||Gd(n)}Ha=Se;var zd={};Ha.v1=Zh,Ha.v4=Ha,zd=Ha;var Ia={},kf=function(e){var r=[];r.push({obj:e});for(var a,s,p,t,o,n,$,l,i,f,c="";a=r.pop();)if(s=a.obj,c+=a.prefix||"",p=a.val||"")c+=p;else if("object"!=typeof s)c+=void 0===s?null:JSON.stringify(s);else if(null===s)c+="null";else if(Array.isArray(s)){for(r.push({val:"]"}),t=s.length-1;t>=0;t--)o=0===t?"":",",r.push({obj:s[t],prefix:o});r.push({val:"["})}else{for($ in n=[],s)s.hasOwnProperty($)&&n.push($);for(r.push({val:"}"}),t=n.length-1;t>=0;t--)i=s[l=n[t]],f=t>0?",":"",f+=JSON.stringify(l)+":",r.push({obj:i,prefix:f});r.push({val:"{"})}return c};function ka(e,r,a){var s=a[a.length-1];e===s.element&&(a.pop(),s=a[a.length-1]);var p=s.element,t=s.index;if(Array.isArray(p))p.push(e);else if(t===r.length-2){p[r.pop()]=e}else r.push(e)}Ia.stringify=kf;var vf=function(e){for(var r,a,s,p,t,o,n,$,l,i=[],f=[],c=0;;)if("}"!==(r=e[c++])&&"]"!==r&&void 0!==r)switch(r){case" ":case"\t":case"\n":case":":case",":break;case"n":c+=3,ka(null,i,f);break;case"t":c+=3,ka(!0,i,f);break;case"f":c+=4,ka(!1,i,f);break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":case"-":for(a="",c--;;){if(s=e[c++],!/[\d\.\-e\+]/.test(s)){c--;break}a+=s}ka(parseFloat(a),i,f);break;case"\"":for(p="",t=void 0,o=0;"\""!==(n=e[c++])||"\\"===t&&o%2==1;)p+=n,"\\"===(t=n)?o++:o=0;ka(JSON.parse("\""+p+"\""),i,f);break;case"[":$={element:[],index:i.length},i.push($.element),f.push($);break;case"{":l={element:{},index:i.length},i.push(l.element),f.push(l);break;default:throw new Error("unexpectedly reached end of input: "+r);}else{if(1===i.length)return i.pop();ka(i.pop(),i,f)}};Ia.parse=vf;function If($){if(ea===clearTimeout)return clearTimeout($);if((ea===cc||!ea)&&clearTimeout)return ea=clearTimeout,clearTimeout($);try{return ea($)}catch(e){try{return ea.call(null,$)}catch(e){return ea.call(this,$)}}}!function(){try{fa="function"==typeof setTimeout?setTimeout:Pb}catch($){fa=Pb}try{ea="function"==typeof clearTimeout?clearTimeout:cc}catch($){ea=cc}}();var wa,t=[],Sb=!1,wd=-1;function mg(){Sb&&wa&&(Sb=!1,wa.length?t=wa.concat(t):wd=-1,t.length&&vd())}function vd(){if(!Sb){var $=ce(mg);Sb=!0;for(var e=t.length;e;){for(wa=t,t=[];++wd<e;)wa&&wa[wd].run();wd=-1,e=t.length}wa=null,Sb=!1,If($)}}function od($,e){this.fun=$,this.array=e}function r(){}d.nextTick=function($){var e=new Array(arguments.length-1);if(arguments.length>1)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];t.push(new od($,e)),1!==t.length||Sb||ce(vd)},od.prototype.run=function(){this.fun.apply(null,this.array)},d.title="browser",d.browser=!0,d.env={},d.argv=[],d.version="",d.versions={},d.on=r,d.addListener=r,d.once=r,d.off=r,d.removeListener=r,d.removeAllListeners=r,d.emit=r,d.prependListener=r,d.prependOnceListener=r,d.listeners=function($){return[]},d.binding=function($){throw new Error("process.binding is not supported")},d.cwd=function(){return"/"},d.chdir=function($){throw new Error("process.chdir is not supported")},d.umask=function(){return 0};var Ta={};function ih(e){return"undefined"!=typeof ArrayBuffer&&e instanceof ArrayBuffer||"undefined"!=typeof Blob&&e instanceof Blob}function Ch(e){if("function"==typeof e.slice)return e.slice(0);var r=new ArrayBuffer(e.byteLength),t=new Uint8Array(r),n=new Uint8Array(e);return t.set(n),r}function Dh(e){if(e instanceof ArrayBuffer)return Ch(e);var r=e.size,t=e.type;return"function"==typeof e.slice?e.slice(0,r,t):e.webkitSlice(0,r,t)}var Xa,C,gd=Function.prototype.toString,oe=gd.call(Object);function se(e){var r=Object.getPrototypeOf(e);if(null===r)return!0;var t=r.constructor;return"function"==typeof t&&t instanceof t&&gd.call(t)==oe}function x(e){var r,t,n;if(!e||"object"!=typeof e)return e;if(Array.isArray(e)){for(r=[],t=0,n=e.length;t<n;t++)r[t]=x(e[t]);return r}if(e instanceof Date)return e.toISOString();if(ih(e))return Dh(e);if(!se(e))return e;for(t in r={},e)if(Object.prototype.hasOwnProperty.call(e,t)){var i=x(e[t]);void 0!==i&&(r[t]=i)}return r}function cd(e){var r=!1;var $uOR$$interop$default=q(qa);return $uOR$$interop$default.d(function(t){if(r)throw new Error("once called more than once");r=!0,e.apply(this,t)})}function ad(e){var $uOR$$interop$default=q(qa);return $uOR$$interop$default.d(function(r){r=x(r);var t=this,n="function"==typeof r[r.length-1]&&r.pop(),i=new Promise(function(n,i){var a;try{var o=cd(function(e,r){e?i(e):n(r)});r.push(o),(a=e.apply(t,r))&&"function"==typeof a.then&&n(a)}catch(e){i(e)}});return n&&i.then(function(e){n(null,e)},n),i})}function Qe(e,r,t){if(e.constructor.listeners("debug").length){for(var n=["api",e.name,r],i=0;i<t.length-1;i++)n.push(t[i]);e.constructor.emit("debug",n);var a=t[t.length-1];t[t.length-1]=function(t,n){var i=["api",e.name,r];i=i.concat(t?["error",t]:["success",n]),e.constructor.emit("debug",i),a(t,n)}}}function f(e,r){var $uOR$$interop$default=q(qa);return ad($uOR$$interop$default.d(function(t){if(this._closed)return Promise.reject(new Error("database is closed"));if(this._destroyed)return Promise.reject(new Error("database is destroyed"));var n=this;return Qe(n,e,t),this.taskqueue.isReady?r.apply(this,t):new Promise(function(r,i){n.taskqueue.addTask(function(a){a?i(a):r(n[e].apply(n,t))})})}))}function $a(e){return"$"+e}function af(e){return e.substring(1)}function O(){this._store={}}function ta(e){if(this._store=new O,e&&Array.isArray(e))for(var r=0,t=e.length;r<t;r++)this.add(e[r])}function lf(){if("undefined"==typeof Symbol||"undefined"==typeof Map||"undefined"==typeof Set)return!1;var e=Object.getOwnPropertyDescriptor(Map,Symbol.species);return e&&"get"in e&&Map[Symbol.species]===Map}function za(e,r){for(var t={},n=0,i=r.length;n<i;n++){var a=r[n];a in e&&(t[a]=e[a])}return t}O.prototype.get=function(e){var r=$a(e);return this._store[r]},O.prototype.set=function(e,r){var t=$a(e);return this._store[t]=r,!0},O.prototype.has=function(e){return $a(e)in this._store},O.prototype.delete=function(e){var r=$a(e),t=r in this._store;return delete this._store[r],t},O.prototype.forEach=function(e){for(var r=Object.keys(this._store),t=0,n=r.length;t<n;t++){var i=r[t];e(this._store[i],i=af(i))}},Object.defineProperty(O.prototype,"size",{get:function(){return Object.keys(this._store).length}}),ta.prototype.add=function(e){return this._store.set(e,!0)},ta.prototype.has=function(e){return this._store.has(e)},ta.prototype.forEach=function(e){this._store.forEach(function(r,t){e(t)})},Object.defineProperty(ta.prototype,"size",{get:function(){return this._store.size}}),lf()?(Xa=Set,C=Map):(Xa=ta,C=O);var pf,Tj,tf=6;function Zc(e){return e}function Ff(e){return[{ok:e}]}function Xc(e,r,t){var n=r.docs,i=new C;n.forEach(function(e){i.has(e.id)?i.get(e.id).push(e):i.set(e.id,[e])});var a=i.size,o=0,$=new Array(a);function s(){var e;++o===a&&(e=[],$.forEach(function(r){r.docs.forEach(function(t){e.push({id:r.id,docs:[t]})})}),t(null,{results:e}))}var c=[];i.forEach(function(e,r){c.push(r)});var u=0;function v(){if(!(u>=c.length)){var t=Math.min(u+tf,c.length),n=c.slice(u,t);!function(t,n){t.forEach(function(t,a){var o=n+a,c=i.get(t),u=za(c[0],["atts_since","attachments"]);u.open_revs=c.map(function(e){return e.rev}),u.open_revs=u.open_revs.filter(Zc);var l=Zc;0===u.open_revs.length&&(delete u.open_revs,l=Ff),["revs","attachments","binary","ajax","latest"].forEach(function(e){e in r&&(u[e]=r[e])}),e.get(t,u,function(e,r){var n,i,a;n=e?[{error:e}]:l(r),i=t,a=n,$[o]={id:i,docs:a},s(),v()})})}(n,u),u+=n.length}}v()}try{localStorage.setItem("_pouch_check_localstorage",1),pf=!!localStorage.getItem("_pouch_check_localstorage")}catch(e){pf=!1}function db(){return pf}function Zf(e){db()&&addEventListener("storage",function(r){e.emit(r.key)})}function da(){l.EventEmitter.call(this),this._listeners={},Zf(this)}function y(e){if("undefined"!=typeof console&&"function"==typeof console[e]){var r=Array.prototype.slice.call(arguments,1);console[e].apply(console,r)}}function dg(e,r){return e=parseInt(e,10)||0,(r=parseInt(r,10))!=r||r<=e?r=(e||1)<<1:r+=1,r>6e5&&(e=3e5,r=6e5),~~((r-e)*Math.random()+e)}function fg(e){var r=0;return e||(r=2e3),dg(e,r)}function Wb(e,r){y("info","The above "+e+" is totally normal. "+r)}var o=q(we);o.d(da,l.EventEmitter),da.prototype.addListener=function(e,r,t,n){if(!this._listeners[r]){var i=this,a=!1;this._listeners[r]=o,this.on(e,o)}function o(){if(i._listeners[r])if(a)a="waiting";else{a=!0;var e=za(n,["style","include_docs","attachments","conflicts","filter","doc_ids","view","since","query_params","binary","return_docs"]);t.changes(e).on("change",function(e){e.seq>n.since&&!n.cancelled&&(n.since=e.seq,n.onChange(e))}).on("complete",function(){var $EK2n$$interop$default=q(M);"waiting"===a&&$EK2n$$interop$default.d(o),a=!1}).on("error",function(){a=!1})}}},da.prototype.removeListener=function(e,r){r in this._listeners&&(l.EventEmitter.prototype.removeListener.call(this,e,this._listeners[r]),delete this._listeners[r])},da.prototype.notifyLocalWindows=function(e){db()&&(localStorage[e]="a"===localStorage[e]?"b":"a")},da.prototype.notify=function(e){this.emit(e),this.notifyLocalWindows(e)};var pa=Tj="function"==typeof Object.assign?Object.assign:function(e){for(var r=Object(e),t=1;t<arguments.length;t++){var n=arguments[t];if(null!=n)for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(r[i]=n[i])}return r};function a(e,r,t){Error.call(this,t),this.status=e,this.name=r,this.message=t,this.error=!0}o.d(a,Error),a.prototype.toString=function(){return JSON.stringify({status:this.status,name:this.name,message:this.message,reason:this.reason})};var Sj=new a(401,"unauthorized","Name or password is incorrect."),xg=new a(400,"bad_request","Missing JSON list of 'docs'"),E=new a(404,"not_found","missing"),oa=new a(409,"conflict","Document update conflict"),Wc=new a(400,"bad_request","_id field must contain a string"),Xg=new a(412,"missing_id","_id is required for puts"),Yg=new a(400,"bad_request","Only reserved document ids may start with underscore."),Rj=new a(412,"precondition_failed","Database not open"),Vc=new a(500,"unknown_error","Database encountered an unknown error"),Rc=new a(500,"badarg","Some query argument is invalid"),Qj=new a(400,"invalid_request","Request was invalid"),xh=new a(400,"query_parse_error","Some query parameter is invalid"),Qc=new a(500,"doc_validation","Bad special document member"),La=new a(400,"bad_request","Something wrong with the request"),jb=new a(400,"bad_request","Document must be a JSON object"),Pj=new a(404,"not_found","Database not found"),kb=new a(500,"indexed_db_went_bad","unknown"),Uj=new a(500,"web_sql_went_bad","unknown"),Nj=new a(500,"levelDB_went_went_bad","unknown"),Mj=new a(403,"forbidden","Forbidden by design doc validate_doc_update function"),Pc=new a(400,"bad_request","Invalid rev format"),Lj=new a(412,"file_exists","The database could not be created, the file already exists."),ee=new a(412,"missing_stub","A pre-existing attachment stub wasn't found"),Kj=new a(413,"invalid_url","Provided URL is invalid");function j(e,r){function t(r){for(var t in e)"function"!=typeof e[t]&&(this[t]=e[t]);void 0!==r&&(this.reason=r)}return t.prototype=a.prototype,new t(r)}function ma(e){if("object"!=typeof e){var r=e;(e=Vc).data=r}return"error"in e&&"conflict"===e.error&&(e.name="conflict",e.status=409),"name"in e||(e.name=e.error||"unknown"),"status"in e||(e.status=500),"message"in e||(e.message=e.message||e.reason),e}function te(e,r,t){try{return!e(r,t)}catch(e){var n="Filter function threw: "+e.toString();return j(La,n)}}function ob(e){var r={},t=e.filter&&"function"==typeof e.filter;return r.query=e.query_params,function(n){n.doc||(n.doc={});var i=t&&te(e.filter,n.doc,r);if("object"==typeof i)return i;if(i)return!1;if(e.include_docs){if(!e.attachments)for(var a in n.doc._attachments)n.doc._attachments.hasOwnProperty(a)&&(n.doc._attachments[a].stub=!0)}else delete n.doc;return!0}}function Pa(e){for(var r=[],t=0,n=e.length;t<n;t++)r=r.concat(e[t]);return r}function Nc(e){var r;if(e?"string"!=typeof e?r=j(Wc):/^_/.test(e)&&!/^_(design|local)/.test(e)&&(r=j(Yg)):r=j(Xg),r)throw r}function H(e){return"boolean"==typeof e._remote?e._remote:"function"==typeof e.type&&(y("warn","db.type() is deprecated and will be removed in a future version of PouchDB"),"http"===e.type())}function Ne(e,r){return"listenerCount"in e?e.listenerCount(r):l.EventEmitter.listenerCount(e,r)}function rb(e){if(!e)return null;var r=e.split("/");return 2===r.length?r:1===r.length?[e,e]:null}function Mc(e){var r=rb(e);return r?r.join("/"):null}var Jc=["source","protocol","authority","userInfo","user","password","host","port","relative","path","directory","file","query","anchor"],Hc="queryKey",bf=/(?:^|&)([^&=]*)=?([^&]*)/g,ef=/^(?:(?![^:@]+:[^:@\/]*@)([^:\/?#.]+):)?(?:\/\/)?((?:(([^:@]*)(?::([^:@]*))?)?@)?([^:\/?#]*)(?::(\d*))?)(((\/(?:[^?#](?![^?#\/]*\.[^?#\/.]+(?:[?#]|$)))*\/?)?([^?#\/]*))(?:\?([^#]*))?(?:#(.*))?)/;function Fc(e){for(var r=ef.exec(e),t={},n=14;n--;){var i=Jc[n],a=r[n]||"",o=-1!==["user","password"].indexOf(i);t[i]=o?decodeURIComponent(a):a}return t[Hc]={},t[Jc[12]].replace(bf,function(e,r,n){r&&(t[Hc][r]=n)}),t}function wb(e,r){var t=[],n=[];for(var i in r)r.hasOwnProperty(i)&&(t.push(i),n.push(r[i]));return t.push(e),Function.apply(null,t).apply(null,n)}function Sa(e,r,t){return new Promise(function(n,i){e.get(r,function(a,o){if(a){if(404!==a.status)return i(a);o={}}var $=o._rev,s=t(o);if(!s)return n({updated:!1,rev:$});s._id=r,s._rev=$,n(nf(e,s,t))})})}function nf(e,r,t){return e.put(r).then(function(e){return{updated:!0,rev:e.rev}},function(n){if(409!==n.status)throw n;return Sa(e,r._id,t)})}var yb=function(e){return atob(e)},ya=function(e){return btoa(e)};function Ab(e,r){e=e||[],r=r||{};try{return new Blob(e,r)}catch(i){if("TypeError"!==i.name)throw i;for(var t=new("undefined"!=typeof BlobBuilder?BlobBuilder:"undefined"!=typeof MSBlobBuilder?MSBlobBuilder:"undefined"!=typeof MozBlobBuilder?MozBlobBuilder:WebKitBlobBuilder),n=0;n<e.length;n+=1)t.append(e[n]);return t.getBlob(r.type)}}function rf(e){for(var r=e.length,t=new ArrayBuffer(r),n=new Uint8Array(t),i=0;i<r;i++)n[i]=e.charCodeAt(i);return t}function Bb(e,r){return Ab([rf(e)],{type:r})}function Cb(e,r){return Bb(yb(e),r)}function Df(e){for(var r="",t=new Uint8Array(e),n=t.byteLength,i=0;i<n;i++)r+=String.fromCharCode(t[i]);return r}function Cc(e,r){var t=new FileReader,n="function"==typeof t.readAsBinaryString;t.onloadend=function(e){var t=e.target.result||"";if(n)return r(t);r(Df(t))},n?t.readAsBinaryString(e):t.readAsArrayBuffer(e)}function Bc(e,r){Cc(e,function(e){r(e)})}function Fb(e,r){Bc(e,function(e){r(ya(e))})}function Kf(e,r){var t=new FileReader;t.onloadend=function(e){var t=e.target.result||new ArrayBuffer(0);r(t)},t.readAsArrayBuffer(e)}var Lf=n.setImmediate||n.setTimeout,Rf=32768;function Tf(e){return ya(e)}function Uf(e,r,t){return e.webkitSlice?e.webkitSlice(r,t):e.slice(r,t)}function Vf(e,r,t,n,i){(t>0||n<r.size)&&(r=Uf(r,t,n)),Kf(r,function(r){e.append(r),i()})}function Wf(e,r,t,n,i){(t>0||n<r.length)&&(r=r.substring(t,n)),e.appendBinary(r),i()}function Gb(e,r){var $AoQO$$interop$default=q(nb);var t="string"==typeof e,n=t?e.length:e.size,i=Math.min(Rf,n),a=Math.ceil(n/i),o=0,$=t?new $AoQO$$interop$default.d:new $AoQO$$interop$default.d.ArrayBuffer,s=t?Wf:Vf;function c(){Lf(v)}function u(){var e=Tf($.end(!0));r(e),$.destroy()}function v(){var r=o*i,t=r+i;s($,e,r,t,++o<a?c:u)}v()}function Ac(e){var $AoQO$$interop$default=q(nb);return $AoQO$$interop$default.d.hash(e)}function zc(e,r){var t=x(e);var $gV9a$$interop$default=q(zd);return r?(delete t._rev_tree,Ac(JSON.stringify(t))):$gV9a$$interop$default.d.v4().replace(/-/g,"").toLowerCase()}var bg=q(zd);var Wa=bg.d.v4;function _(e){for(var r,t,n,i,a=e.rev_tree.slice();i=a.pop();){var o=i.ids,$=o[2],s=i.pos;if($.length)for(var c=0,u=$.length;c<u;c++)a.push({pos:s+1,ids:$[c]});else{var v=!!o[1].deleted,l=o[0];r&&!(n!==v?n:t!==s?t<s:r<l)||(r=l,t=s,n=v)}}return t+"-"+r}function Z(e,r){for(var t,n=e.slice();t=n.pop();)for(var i=t.pos,a=t.ids,o=a[2],$=r(0===o.length,i,a[0],t.ctx,a[1]),s=0,c=o.length;s<c;s++)n.push({pos:i+1,ids:o[s],ctx:$})}function gg(e,r){return e.pos-r.pos}function Lb(e){var r=[];Z(e,function(e,t,n,i,a){e&&r.push({rev:t+"-"+n,pos:t,opts:a})}),r.sort(gg).reverse();for(var t=0,n=r.length;t<n;t++)delete r[t].pos;return r}function Mb(e){for(var r=_(e),t=Lb(e.rev_tree),n=[],i=0,a=t.length;i<a;i++){var o=t[i];o.rev===r||o.opts.deleted||n.push(o.rev)}return n}function lg(e){var r=[];return Z(e.rev_tree,function(e,t,n,i,a){"available"!==a.status||e||(r.push(t+"-"+n),a.status="missing")}),r}function xc(e){for(var r,t=[],n=e.slice();r=n.pop();){var i=r.pos,a=r.ids,o=a[0],$=a[1],s=a[2],c=0===s.length,u=r.history?r.history.slice():[];u.push({id:o,opts:$}),c&&t.push({pos:i+1-u.length,ids:u});for(var v=0,l=s.length;v<l;v++)n.push({pos:i+1,ids:s[v],history:u})}return t.reverse()}function ng(e,r){return e.pos-r.pos}function rg(e,r,t){for(var n,i=0,a=e.length;i<a;)t(e[n=i+a>>>1],r)<0?i=n+1:a=n;return i}function sg(e,r,t){var n=rg(e,r,t);e.splice(n,0,r)}function wc(e,r){for(var t,n,i=r,a=e.length;i<a;i++){var o=e[i],$=[o.id,o.opts,[]];n?(n[2].push($),n=$):t=n=$}return t}function vg(e,r){return e[0]<r[0]?-1:1}function vc(e,r){for(var t=[{tree1:e,tree2:r}],n=!1;t.length>0;){var i=t.pop(),a=i.tree1,o=i.tree2;(a[1].status||o[1].status)&&(a[1].status="available"===a[1].status||"available"===o[1].status?"available":"missing");for(var $=0;$<o[2].length;$++)if(a[2][0]){for(var s=!1,c=0;c<a[2].length;c++)a[2][c][0]===o[2][$][0]&&(t.push({tree1:a[2][c],tree2:o[2][$]}),s=!0);s||(n="new_branch",sg(a[2],o[2][$],vg))}else n="new_leaf",a[2][0]=o[2][$]}return{conflicts:n,tree:e}}function oc(e,r,t){var n,i=[],a=!1,o=!1;if(!e.length)return{tree:[r],conflicts:"new_leaf"};for(var $=0,s=e.length;$<s;$++){var c=e[$];if(c.pos===r.pos&&c.ids[0]===r.ids[0])n=vc(c.ids,r.ids),i.push({pos:c.pos,ids:n.tree}),a=a||n.conflicts,o=!0;else if(!0!==t){var u=c.pos<r.pos?c:r,v=c.pos<r.pos?r:c,l=v.pos-u.pos,f=[],d=[];for(d.push({ids:u.ids,diff:l,parent:null,parentIdx:null});d.length>0;){var p=d.pop();if(0!==p.diff)for(var h=p.ids[2],Q=0,X=h.length;Q<X;Q++)d.push({ids:h[Q],diff:p.diff-1,parent:p.ids,parentIdx:Q});else p.ids[0]===v.ids[0]&&f.push(p)}var _=f[0];_?(n=vc(_.ids,v.ids),_.parent[2][_.parentIdx]=n.tree,i.push({pos:u.pos,ids:u.ids}),a=a||n.conflicts,o=!0):i.push(c)}else i.push(c)}return o||i.push(r),i.sort(ng),{tree:i,conflicts:a||"internal_node"}}function yg(e,r){for(var t,n,i=xc(e),a=0,o=i.length;a<o;a++){var $,s=i[a],c=s.ids;if(c.length>r){t||(t={});var u=c.length-r;$={pos:s.pos+u,ids:wc(c,u)};for(var v=0;v<u;v++){var l=s.pos+v+"-"+c[v].id;t[l]=!0}}else $={pos:s.pos,ids:wc(c,0)};n=n?oc(n,$,!0).tree:[$]}return t&&Z(n,function(e,r,n){delete t[r+"-"+n]}),{tree:n,revs:t?Object.keys(t):[]}}function nc(e,r,t){var n=oc(e,r),i=yg(n.tree,t);return{tree:i.tree,stemmedRevs:i.revs,conflicts:n.conflicts}}function Bg(e,r){for(var t,n=e.slice(),i=r.split("-"),a=parseInt(i[0],10),o=i[1];t=n.pop();){if(t.pos===a&&t.ids[0]===o)return!0;for(var $=t.ids[2],s=0,c=$.length;s<c;s++)n.push({pos:t.pos+1,ids:$[s]})}return!1}function Dg(e){return e.ids}function K(e,r){r||(r=_(e));for(var t,n=r.substring(r.indexOf("-")+1),i=e.rev_tree.map(Dg);t=i.pop();){if(t[0]===n)return!!t[1].deleted;i=i.concat(t[2])}}function V(e){return /^_local/.test(e)}function Pg(e,r){for(var t,n=r.rev_tree.slice();t=n.pop();){var i=t.pos,a=t.ids,o=a[0],$=a[1],s=a[2],c=0===s.length,u=t.history?t.history.slice():[];if(u.push({id:o,pos:i,opts:$}),c)for(var v=0,l=u.length;v<l;v++){var f=u[v];if(f.pos+"-"+f.id===e)return i+"-"+o}for(var d=0,p=s.length;d<p;d++)n.push({pos:i+1,ids:s[d],history:u})}throw new Error("Unable to resolve latest revision for id "+r.id+", rev "+e)}function Tg(e,r,t,n){try{e.emit("change",r,t,n)}catch(e){y("error","Error in .on(\"change\", function):",e)}}function Ca(e,r,t){l.EventEmitter.call(this);var n=this;this.db=e;var i=(r=r?x(r):{}).complete=cd(function(r,t){r?Ne(n,"error")>0&&n.emit("error",r):n.emit("complete",t),n.removeAllListeners(),e.removeListener("destroyed",a)});function a(){n.cancel()}t&&(n.on("complete",function(e){t(null,e)}),n.on("error",t)),e.once("destroyed",a),r.onChange=function(e,r,t){n.isCancelled||Tg(n,e,r,t)};var o=new Promise(function(e,t){r.complete=function(r,n){r?t(r):e(n)}});n.once("cancel",function(){e.removeListener("destroyed",a),r.complete(null,{status:"cancelled"})}),this.then=o.then.bind(o),this.catch=o.catch.bind(o),this.then(function(e){i(null,e)},i),e.taskqueue.isReady?n.validateChanges(r):e.taskqueue.addTask(function(e){e?r.complete(e):n.isCancelled?n.emit("cancel"):n.validateChanges(r)})}function Wg(e,r,t){var n=[{rev:e._rev}];"all_docs"===t.style&&(n=Lb(r.rev_tree).map(function(e){return{rev:e.rev}}));var i={id:r.id,changes:n,doc:e};return K(r,e._rev)&&(i.deleted=!0),t.conflicts&&(i.doc._conflicts=Mb(r),i.doc._conflicts.length||delete i.doc._conflicts),i}function lc(e,r){return e<r?-1:e>r?1:0}function Vb(e,r){return function(t,n){t||n[0]&&n[0].error?((t=t||n[0]).docId=r,e(t)):e(null,n.length?n[0]:n)}}function Zg(e){for(var r=0;r<e.length;r++){var t=e[r];if(t._deleted)delete t._attachments;else if(t._attachments)for(var n=Object.keys(t._attachments),i=0;i<n.length;i++){var a=n[i];t._attachments[a]=za(t._attachments[a],["data","digest","content_type","length","revpos","stub"])}}}function _g(e,r){var t=lc(e._id,r._id);return 0!==t?t:lc(e._revisions?e._revisions.start:0,r._revisions?r._revisions.start:0)}function ah(e){var r={},t=[];return Z(e,function(e,n,i,a){var o=n+"-"+i;return e&&(r[o]=0),void 0!==a&&t.push({from:a,to:o}),o}),t.reverse(),t.forEach(function(e){void 0===r[e.from]?r[e.from]=1+r[e.to]:r[e.from]=Math.min(r[e.from],1+r[e.to])}),r}function bh(e){var r="limit"in e?e.keys.slice(e.skip,e.limit+e.skip):e.skip>0?e.keys.slice(e.skip):e.keys;e.keys=r,e.skip=0,delete e.limit,e.descending&&(r.reverse(),e.descending=!1)}function kc(e){var r=e._compactionQueue[0],t=r.opts,n=r.callback;e.get("_local/compaction").catch(function(){return!1}).then(function(r){r&&r.last_seq&&(t.last_seq=r.last_seq),e._compact(t,function(r,t){var $EK2n$$interop$default=q(M);r?n(r):n(null,t),$EK2n$$interop$default.d(function(){e._compactionQueue.shift(),e._compactionQueue.length&&kc(e)})})})}function gh(e){return"_"===e.charAt(0)&&e+" is not a valid attachment name, attachment names cannot start with '_'"}function c(){for(var e in l.EventEmitter.call(this),c.prototype)"function"==typeof this[e]&&(this[e]=this[e].bind(this))}function Fa(){this.isReady=!1,this.failed=!1,this.queue=[]}function jh(e,r){var t=e.match(/([a-z-]*):\/\/(.*)/);if(t)return{name:/https?/.test(t[1])?t[1]+"://"+t[2]:t[2],adapter:t[1]};var n=b.adapters,i=b.preferredAdapters,a=b.prefix,o=r.adapter;if(!o)for(var $=0;$<i.length&&"idb"===(o=i[$])&&"websql"in n&&db()&&localStorage["_pouch__websqldb_"+a+e];++$)y("log","PouchDB is downgrading \""+e+"\" to WebSQL to avoid data loss, because it was already opened with WebSQL.");var s=n[o];return{name:!(s&&"use_prefix"in s)||s.use_prefix?a+e:e,adapter:o}}function lh(e){function r(r){e.removeListener("closed",t),r||e.constructor.emit("destroyed",e.name)}function t(){e.removeListener("destroyed",r),e.constructor.emit("unref",e)}e.once("destroyed",r),e.once("closed",t),e.constructor.emit("ref",e)}function b(e,r){if(!(this instanceof b))return new b(e,r);var t=this;if(r=r||{},e&&"object"==typeof e&&(e=(r=e).name,delete r.name),void 0===r.deterministic_revs&&(r.deterministic_revs=!0),this.__opts=r=x(r),t.auto_compaction=r.auto_compaction,t.prefix=b.prefix,"string"!=typeof e)throw new Error("Missing/invalid DB name");var n=jh((r.prefix||"")+e,r);if(r.name=n.name,r.adapter=r.adapter||n.adapter,t.name=e,t._adapter=r.adapter,b.emit("debug",["adapter","Picked adapter: ",r.adapter]),!b.adapters[r.adapter]||!b.adapters[r.adapter].valid())throw new Error("Invalid Adapter: "+r.adapter);c.call(t),t.taskqueue=new Fa,t.adapter=r.adapter,b.adapters[r.adapter].call(t,r,function(e){if(e)return t.taskqueue.fail(e);lh(t),t.emit("created",t),b.emit("created",t.name),t.taskqueue.ready(t)})}o.d(Ca,l.EventEmitter),Ca.prototype.cancel=function(){this.isCancelled=!0,this.db.taskqueue.isReady&&this.emit("cancel")},Ca.prototype.validateChanges=function(e){var r=e.complete,t=this;b._changesFilterPlugin?b._changesFilterPlugin.validate(e,function(n){if(n)return r(n);t.doChanges(e)}):t.doChanges(e)},Ca.prototype.doChanges=function(e){var r=this,t=e.complete;if("live"in(e=x(e))&&!("continuous"in e)&&(e.continuous=e.live),e.processChange=Wg,"latest"===e.since&&(e.since="now"),e.since||(e.since=0),"now"!==e.since){if(b._changesFilterPlugin){if(b._changesFilterPlugin.normalize(e),b._changesFilterPlugin.shouldFilter(this,e))return b._changesFilterPlugin.filter(this,e)}else["doc_ids","filter","selector","view"].forEach(function(r){r in e&&y("warn","The \""+r+"\" option was passed in to changes/replicate, but pouchdb-changes-filter plugin is not installed, so it was ignored. Please install the plugin to enable filtering.")});"descending"in e||(e.descending=!1),e.limit=0===e.limit?1:e.limit,e.complete=t;var n=this.db._changes(e);if(n&&"function"==typeof n.cancel){var i=r.cancel;var $uOR$$interop$default=q(qa);r.cancel=$uOR$$interop$default.d(function(e){n.cancel(),i.apply(this,e)})}}else this.db.info().then(function(n){r.isCancelled?t(null,{status:"cancelled"}):(e.since=n.update_seq,r.doChanges(e))},t)},o.d(c,l.EventEmitter),c.prototype.post=f("post",function(e,r,t){if("function"==typeof r&&(t=r,r={}),"object"!=typeof e||Array.isArray(e))return t(j(jb));this.bulkDocs({docs:[e]},r,Vb(t,e._id))}),c.prototype.put=f("put",function(e,r,t){if("function"==typeof r&&(t=r,r={}),"object"!=typeof e||Array.isArray(e))return t(j(jb));if(Nc(e._id),V(e._id)&&"function"==typeof this._putLocal)return e._deleted?this._removeLocal(e,t):this._putLocal(e,t);var n,i,a,o,$=this;function s(t){"function"==typeof $._put&&!1!==r.new_edits?$._put(e,r,t):$.bulkDocs({docs:[e]},r,Vb(t,e._id))}r.force&&e._rev?(n=e._rev.split("-"),i=n[1],a=parseInt(n[0],10)+1,o=zc(),e._revisions={start:a,ids:[o,i]},e._rev=a+"-"+o,r.new_edits=!1,s(function(r){var n=r?null:{ok:!0,id:e._id,rev:e._rev};t(r,n)})):s(t)}),c.prototype.putAttachment=f("putAttachment",function(e,r,t,n,i){var a=this;function o(e){var t="_rev"in e?parseInt(e._rev,10):0;return e._attachments=e._attachments||{},e._attachments[r]={content_type:i,data:n,revpos:++t},a.put(e)}return"function"==typeof i&&(i=n,n=t,t=null),void 0===i&&(i=n,n=t,t=null),i||y("warn","Attachment",r,"on document",e,"is missing content_type"),a.get(e).then(function(e){if(e._rev!==t)throw j(oa);return o(e)},function(r){if(r.reason===E.message)return o({_id:e});throw r})}),c.prototype.removeAttachment=f("removeAttachment",function(e,r,t,n){var i=this;i.get(e,function(e,a){if(e)n(e);else if(a._rev===t){if(!a._attachments)return n();delete a._attachments[r],0===Object.keys(a._attachments).length&&delete a._attachments,i.put(a,n)}else n(j(oa))})}),c.prototype.remove=f("remove",function(e,r,t,n){var i;"string"==typeof r?(i={_id:e,_rev:r},"function"==typeof t&&(n=t,t={})):(i=e,"function"==typeof r?(n=r,t={}):(n=t,t=r)),(t=t||{}).was_delete=!0;var a={_id:i._id,_rev:i._rev||t.rev,_deleted:!0};if(V(a._id)&&"function"==typeof this._removeLocal)return this._removeLocal(i,n);this.bulkDocs({docs:[a]},t,Vb(n,a._id))}),c.prototype.revsDiff=f("revsDiff",function(e,r,t){"function"==typeof r&&(t=r,r={});var n=Object.keys(e);if(!n.length)return t(null,{});var i=0,a=new C;function o(e,r){a.has(e)||a.set(e,{missing:[]}),a.get(e).missing.push(r)}n.map(function(r){this._getRevisionTree(r,function($,s){if($&&404===$.status&&"missing"===$.message)a.set(r,{missing:e[r]});else{if($)return t($);!function(r,t){var n=e[r].slice(0);Z(t,function(e,t,i,a,$){var s=t+"-"+i,c=n.indexOf(s);-1!==c&&(n.splice(c,1),"available"!==$.status&&o(r,s))}),n.forEach(function(e){o(r,e)})}(r,s)}if(++i===n.length){var c={};return a.forEach(function(e,r){c[r]=e}),t(null,c)}})},this)}),c.prototype.bulkGet=f("bulkGet",function(e,r){Xc(this,e,r)}),c.prototype.compactDocument=f("compactDocument",function(e,r,t){var n=this;this._getRevisionTree(e,function(i,a){if(i)return t(i);var o=ah(a),$=[],s=[];Object.keys(o).forEach(function(e){o[e]>r&&$.push(e)}),Z(a,function(e,r,t,n,i){var a=r+"-"+t;"available"===i.status&&-1!==$.indexOf(a)&&s.push(a)}),n._doCompaction(e,s,t)})}),c.prototype.compact=f("compact",function(e,r){"function"==typeof e&&(r=e,e={});e=e||{},this._compactionQueue=this._compactionQueue||[],this._compactionQueue.push({opts:e,callback:r}),1===this._compactionQueue.length&&kc(this)}),c.prototype._compact=function(e,r){var t=this,n={return_docs:!1,last_seq:e.last_seq||0},i=[];t.changes(n).on("change",function(e){i.push(t.compactDocument(e.id,0))}).on("complete",function(e){var n=e.last_seq;Promise.all(i).then(function(){return Sa(t,"_local/compaction",function(e){return(!e.last_seq||e.last_seq<n)&&(e.last_seq=n,e)})}).then(function(){r(null,{ok:!0})}).catch(r)}).on("error",r)},c.prototype.get=f("get",function(e,r,t){if("function"==typeof r&&(t=r,r={}),"string"!=typeof e)return t(j(Wc));if(V(e)&&"function"==typeof this._getLocal)return this._getLocal(e,t);var n=[],i=this;function a(){var a=[],o=n.length;if(!o)return t(null,a);n.forEach(function(n){i.get(e,{rev:n,revs:r.revs,latest:r.latest,attachments:r.attachments,binary:r.binary},function(e,r){if(e)a.push({missing:n});else{for(var i,$=0,s=a.length;$<s;$++)if(a[$].ok&&a[$].ok._rev===r._rev){i=!0;break}i||a.push({ok:r})}--o||t(null,a)})})}if(!r.open_revs)return this._get(e,r,function(n,a){if(n)return n.docId=e,t(n);var o=a.doc,$=a.metadata,s=a.ctx;if(r.conflicts){var c=Mb($);c.length&&(o._conflicts=c)}if(K($,o._rev)&&(o._deleted=!0),r.revs||r.revs_info){for(var u=o._rev.split("-"),v=parseInt(u[0],10),l=u[1],f=xc($.rev_tree),d=null,p=0;p<f.length;p++){var h=f[p],Q=h.ids.map(function(e){return e.id}).indexOf(l);(Q===v-1||!d&&-1!==Q)&&(d=h)}var X=d.ids.map(function(e){return e.id}).indexOf(o._rev.split("-")[1])+1,_=d.ids.length-X;if(d.ids.splice(X,_),d.ids.reverse(),r.revs&&(o._revisions={start:d.pos+d.ids.length-1,ids:d.ids.map(function(e){return e.id})}),r.revs_info){var g=d.pos+d.ids.length;o._revs_info=d.ids.map(function(e){return{rev:--g+"-"+e.id,status:e.opts.status}})}}if(r.attachments&&o._attachments){var m=o._attachments,y=Object.keys(m).length;if(0===y)return t(null,o);Object.keys(m).forEach(function(e){this._getAttachment(o._id,e,m[e],{rev:o._rev,binary:r.binary,ctx:s},function(r,n){var i=o._attachments[e];i.data=n,delete i.stub,delete i.length,--y||t(null,o)})},i)}else{if(o._attachments)for(var b in o._attachments)o._attachments.hasOwnProperty(b)&&(o._attachments[b].stub=!0);t(null,o)}});if("all"===r.open_revs)this._getRevisionTree(e,function(e,r){if(e)return t(e);n=Lb(r).map(function(e){return e.rev}),a()});else{if(!Array.isArray(r.open_revs))return t(j(Vc,"function_clause"));n=r.open_revs;for(var o=0;o<n.length;o++){var $=n[o];if("string"!=typeof $||!/^\d+-/.test($))return t(j(Pc))}a()}}),c.prototype.getAttachment=f("getAttachment",function(e,r,t,n){var i=this;t instanceof Function&&(n=t,t={}),this._get(e,t,function(a,o){return a?n(a):o.doc._attachments&&o.doc._attachments[r]?(t.ctx=o.ctx,t.binary=!0,void i._getAttachment(e,r,o.doc._attachments[r],t,n)):n(j(E))})}),c.prototype.allDocs=f("allDocs",function(e,r){if("function"==typeof e&&(r=e,e={}),e.skip=void 0!==e.skip?e.skip:0,e.start_key&&(e.startkey=e.start_key),e.end_key&&(e.endkey=e.end_key),"keys"in e){if(!Array.isArray(e.keys))return r(new TypeError("options.keys must be an array"));var t=["startkey","endkey","key"].filter(function(r){return r in e})[0];if(t)return void r(j(xh,"Query parameter `"+t+"` is not compatible with multi-get"));if(!H(this)&&(bh(e),0===e.keys.length))return this._allDocs({limit:0},r)}return this._allDocs(e,r)}),c.prototype.changes=function(e,r){return"function"==typeof e&&(r=e,e={}),(e=e||{}).return_docs="return_docs"in e?e.return_docs:!e.live,new Ca(this,e,r)},c.prototype.close=f("close",function(e){return this._closed=!0,this.emit("closed"),this._close(e)}),c.prototype.info=f("info",function(e){var r=this;this._info(function(t,n){if(t)return e(t);n.db_name=n.db_name||r.name,n.auto_compaction=!(!r.auto_compaction||H(r)),n.adapter=r.adapter,e(null,n)})}),c.prototype.id=f("id",function(e){return this._id(e)}),c.prototype.type=function(){return"function"==typeof this._type?this._type():this.adapter},c.prototype.bulkDocs=f("bulkDocs",function(e,r,t){if("function"==typeof r&&(t=r,r={}),r=r||{},Array.isArray(e)&&(e={docs:e}),!e||!e.docs||!Array.isArray(e.docs))return t(j(xg));for(var n=0;n<e.docs.length;++n)if("object"!=typeof e.docs[n]||Array.isArray(e.docs[n]))return t(j(jb));var i;if(e.docs.forEach(function(e){e._attachments&&Object.keys(e._attachments).forEach(function(r){i=i||gh(r),e._attachments[r].content_type||y("warn","Attachment",r,"on document",e._id,"is missing content_type")})}),i)return t(j(La,i));"new_edits"in r||(r.new_edits=!("new_edits"in e)||e.new_edits);var a=this;r.new_edits||H(a)||e.docs.sort(_g),Zg(e.docs);var o=e.docs.map(function(e){return e._id});return this._bulkDocs(e,r,function(e,n){if(e)return t(e);if(r.new_edits||(n=n.filter(function(e){return e.error})),!H(a))for(var i=0,$=n.length;i<$;i++)n[i].id=n[i].id||o[i];t(null,n)})}),c.prototype.registerDependentDatabase=f("registerDependentDatabase",function(e,r){var t=new this.constructor(e,this.__opts);Sa(this,"_local/_pouch_dependentDbs",function(r){return r.dependentDbs=r.dependentDbs||{},!r.dependentDbs[e]&&(r.dependentDbs[e]=!0,r)}).then(function(){r(null,{db:t})}).catch(r)}),c.prototype.destroy=f("destroy",function(e,r){"function"==typeof e&&(r=e,e={});var t=this,n=!("use_prefix"in t)||t.use_prefix;function i(){t._destroy(e,function(e,n){if(e)return r(e);t._destroyed=!0,t.emit("destroyed"),r(null,n||{ok:!0})})}if(H(t))return i();t.get("_local/_pouch_dependentDbs",function(e,a){if(e)return 404!==e.status?r(e):i();var o=a.dependentDbs,$=t.constructor,s=Object.keys(o).map(function(e){var r=n?e.replace(new RegExp("^"+$.prefix),""):e;return new $(r,t.__opts).destroy()});Promise.all(s).then(i,r)})}),Fa.prototype.execute=function(){var e;if(this.failed)for(;e=this.queue.shift();)e(this.failed);else for(;e=this.queue.shift();)e()},Fa.prototype.fail=function(e){this.failed=e,this.execute()},Fa.prototype.ready=function(e){this.isReady=!0,this.db=e,this.execute()},Fa.prototype.addTask=function(e){this.queue.push(e),this.failed&&this.execute()},o.d(b,c);var vh="undefined"!=typeof AbortController?AbortController:function(){return{abort:function(){}}},ic=fetch,ra=Headers;b.adapters={},b.preferredAdapters=[],b.prefix="_pouch_";var hc=new l.EventEmitter;function Eh(e){Object.keys(l.EventEmitter.prototype).forEach(function(r){"function"==typeof l.EventEmitter.prototype[r]&&(e[r]=hc[r].bind(hc))});var r=e._destructionListeners=new C;e.on("ref",function(e){r.has(e.name)||r.set(e.name,[]),r.get(e.name).push(e)}),e.on("unref",function(e){if(r.has(e.name)){var t=r.get(e.name),n=t.indexOf(e);n<0||(t.splice(n,1),t.length>1?r.set(e.name,t):r.delete(e.name))}}),e.on("destroyed",function(e){if(r.has(e)){var t=r.get(e);r.delete(e),t.forEach(function(e){e.emit("destroyed",!0)})}})}Eh(b),b.adapter=function(e,r,t){r.valid()&&(b.adapters[e]=r,t&&b.preferredAdapters.push(e))},b.plugin=function(e){if("function"==typeof e)e(b);else{if("object"!=typeof e||0===Object.keys(e).length)throw new Error("Invalid plugin: got \""+e+"\", expected an object or a function");Object.keys(e).forEach(function(r){b.prototype[r]=e[r]})}return this.__defaults&&(b.__defaults=pa({},this.__defaults)),b},b.defaults=function(e){function r(e,t){if(!(this instanceof r))return new r(e,t);t=t||{},e&&"object"==typeof e&&(e=(t=e).name,delete t.name),t=pa({},r.__defaults,t),b.call(this,e,t)}return o.d(r,b),r.preferredAdapters=b.preferredAdapters.slice(),Object.keys(b).forEach(function(e){e in r||(r[e]=b[e])}),r.__defaults=pa({},this.__defaults,e),r},b.fetch=function(e,r){return ic(e,r)};var Fh="7.0.0";function fc(e,r){for(var t=e,n=0,i=r.length;n<i;n++){if(!(t=t[r[n]]))break}return t}function Nh(e,r){return e<r?-1:e>r?1:0}function ec(e){for(var r=[],t="",n=0,i=e.length;n<i;n++){var a=e[n];"."===a?n>0&&"\\"===e[n-1]?t=t.substring(0,t.length-1)+".":(r.push(t),t=""):t+=a}return r.push(t),r}var Wh=["$or","$nor","$not"];function de(e){return Wh.indexOf(e)>-1}function dd(e){return Object.keys(e)[0]}function bi(e){return e[dd(e)]}function Oa(e){var r={};return e.forEach(function(e){Object.keys(e).forEach(function(t){var n=e[t];if("object"!=typeof n&&(n={$eq:n}),de(t))n instanceof Array?r[t]=n.map(function(e){return Oa([e])}):r[t]=Oa([n]);else{var i=r[t]=r[t]||{};Object.keys(n).forEach(function(e){var r=n[e];return"$gt"===e||"$gte"===e?ui(e,r,i):"$lt"===e||"$lte"===e?Ei(e,r,i):"$ne"===e?Ki(r,i):"$eq"===e?Oi(r,i):void(i[e]=r)})}})}),r}function ui(e,r,t){void 0===t.$eq&&(void 0!==t.$gte?"$gte"===e?r>t.$gte&&(t.$gte=r):r>=t.$gte&&(delete t.$gte,t.$gt=r):void 0!==t.$gt?"$gte"===e?r>t.$gt&&(delete t.$gt,t.$gte=r):r>t.$gt&&(t.$gt=r):t[e]=r)}function Ei(e,r,t){void 0===t.$eq&&(void 0!==t.$lte?"$lte"===e?r<t.$lte&&(t.$lte=r):r<=t.$lte&&(delete t.$lte,t.$lt=r):void 0!==t.$lt?"$lte"===e?r<t.$lt&&(delete t.$lt,t.$lte=r):r<t.$lt&&(t.$lt=r):t[e]=r)}function Ki(e,r){"$ne"in r?r.$ne.push(e):r.$ne=[e]}function Oi(e,r){delete r.$gt,delete r.$gte,delete r.$lt,delete r.$lte,delete r.$ne,r.$eq=e}function uj(e){var r=x(e),t=!1;"$and"in r&&(r=Oa(r.$and),t=!0),["$or","$nor"].forEach(function(e){e in r&&r[e].forEach(function(e){for(var r=Object.keys(e),t=0;t<r.length;t++){var n=r[t],i=e[n];"object"==typeof i&&null!==i||(e[n]={$eq:i})}})}),"$not"in r&&(r.$not=Oa([r.$not]));for(var n=Object.keys(r),i=0;i<n.length;i++){var a=n[i],o=r[a];"object"!=typeof o||null===o?o={$eq:o}:"$ne"in o&&!t&&(o.$ne=[o.$ne]),r[a]=o}return r}function xj(e,r,t){for(var n="",i=t-e.length;n.length<i;)n+=r;return n}function yj(e,r,t){return xj(e,r,t)+e}var gc=-324,ac=3,$b="";function w(e,r){if(e===r)return 0;e=ba(e),r=ba(r);var t=Ub(e),n=Ub(r);if(t-n!=0)return t-n;switch(typeof e){case"number":return e-r;case"boolean":return e<r?-1:1;case"string":return me(e,r);}return Array.isArray(e)?le(e,r):ne(e,r)}function ba(e){switch(typeof e){case"undefined":return null;case"number":return e===1/0||e===-1/0||isNaN(e)?null:e;case"object":var r=e;if(Array.isArray(e)){var t=e.length;e=new Array(t);for(var n=0;n<t;n++)e[n]=ba(r[n])}else{if(e instanceof Date)return e.toJSON();if(null!==e)for(var i in e={},r)if(r.hasOwnProperty(i)){var a=r[i];void 0!==a&&(e[i]=ba(a))}}}return e}function ge(e){if(null!==e)switch(typeof e){case"boolean":return e?1:0;case"number":return pe(e);case"string":return e.replace(/\u0002/g,"\x02\x02").replace(/\u0001/g,"\x01\x02").replace(/\u0000/g,"\x01\x01");case"object":var r=Array.isArray(e),t=r?e:Object.keys(e),n=-1,i=t.length,a="";if(r)for(;++n<i;)a+=D(t[n]);else for(;++n<i;){var o=t[n];a+=D(o)+D(e[o])}return a;}return""}function D(e){return Ub(e=ba(e))+$b+ge(e)+"\0"}function ie(e,r){var t,n=r;if("1"===e[r])t=0,r++;else{var i="0"===e[r];r++;var a="",o=e.substring(r,r+ac),$=parseInt(o,10)+gc;for(i&&($=-$),r+=ac;;){var s=e[r];if("\0"===s)break;a+=s,r++}t=1===(a=a.split(".")).length?parseInt(a,10):parseFloat(a[0]+"."+a[1]),i&&(t-=10),0!==$&&(t=parseFloat(t+"e"+$))}return{num:t,length:r-n}}function je(e,r){var t=e.pop();if(r.length){var n=r[r.length-1];t===n.element&&(r.pop(),n=r[r.length-1]);var i=n.element,a=n.index;if(Array.isArray(i))i.push(t);else if(a===e.length-2){i[e.pop()]=t}else e.push(t)}}function ke(e){for(var r=[],t=[],n=0;;){var i=e[n++];if("\0"!==i)switch(i){case"1":r.push(null);break;case"2":r.push("1"===e[n]),n++;break;case"3":var a=ie(e,n);r.push(a.num),n+=a.length;break;case"4":for(var o="";;){var $=e[n];if("\0"===$)break;o+=$,n++}o=o.replace(/\u0001\u0001/g,"\0").replace(/\u0001\u0002/g,"\x01").replace(/\u0002\u0002/g,"\x02"),r.push(o);break;case"5":var s={element:[],index:r.length};r.push(s.element),t.push(s);break;case"6":var c={element:{},index:r.length};r.push(c.element),t.push(c);break;default:throw new Error("bad collationIndex or unexpectedly reached end of input: "+i);}else{if(1===r.length)return r.pop();je(r,t)}}}function le(e,r){for(var t=Math.min(e.length,r.length),n=0;n<t;n++){var i=w(e[n],r[n]);if(0!==i)return i}return e.length===r.length?0:e.length>r.length?1:-1}function me(e,r){return e===r?0:e>r?1:-1}function ne(e,r){for(var t=Object.keys(e),n=Object.keys(r),i=Math.min(t.length,n.length),a=0;a<i;a++){var o=w(t[a],n[a]);if(0!==o)return o;if(0!==(o=w(e[t[a]],r[n[a]])))return o}return t.length===n.length?0:t.length>n.length?1:-1}function Ub(e){var r=["boolean","number","string","object"].indexOf(typeof e);return~r?null===e?1:Array.isArray(e)?5:r<3?r+2:r+3:Array.isArray(e)?5:void 0}function pe(e){if(0===e)return"1";var r=e.toExponential().split(/e\+?/),t=parseInt(r[1],10),n=e<0,i=n?"0":"2",a=yj(((n?-t:t)-gc).toString(),"0",ac);i+=$b+a;var o=Math.abs(parseFloat(r[0]));n&&(o=10-o);var $=o.toFixed(20);return $=$.replace(/\.?0+$/,""),i+=$b+$}function qe(e){function r(r){return e.map(function(e){var t=ec(dd(e));return fc(r,t)})}return function(e,t){var n=w(r(e.doc),r(t.doc));return 0!==n?n:Nh(e.doc._id,t.doc._id)}}function re(e,r,t){if(e=e.filter(function(e){return ga(e.doc,r.selector,t)}),r.sort){var n=qe(r.sort);e=e.sort(n),"string"!=typeof r.sort[0]&&"desc"===bi(r.sort[0])&&(e=e.reverse())}if("limit"in r||"skip"in r){var i=r.skip||0,a=("limit"in r?r.limit:e.length)+i;e=e.slice(i,a)}return e}function ga(e,r,t){return t.every(function(t){var n=r[t],i=ec(t),a=fc(e,i);return de(t)?ue(t,n,e):Rb(n,e,i,a)})}function Rb(e,r,t,n){return!e||Object.keys(e).every(function(i){var a=e[i];return ve(i,r,a,t,n)})}function ue(e,r,t){return"$or"===e?r.some(function(e){return ga(t,e,Object.keys(e))}):"$not"===e?!ga(t,r,Object.keys(r)):!r.find(function(e){return ga(t,e,Object.keys(e))})}function ve(e,r,t,n,i){if(!rc[e])throw new Error("unknown operator \""+e+"\" - should be one of $eq, $lte, $lt, $gt, $gte, $exists, $ne, $in, $nin, $size, $mod, $regex, $elemMatch, $type, $allMatch or $all");return rc[e](r,t,n,i)}function Aa(e){return null!=e}function S(e){return void 0!==e}function ye(e,r){var t=r[0],n=r[1];if(0===t)throw new Error("Bad divisor, cannot divide by zero");if(parseInt(t,10)!==t)throw new Error("Divisor is not an integer");if(parseInt(n,10)!==n)throw new Error("Modulus is not an integer");return parseInt(e,10)===e&&e%t===n}function qc(e,r){return r.some(function(r){return e instanceof Array?e.indexOf(r)>-1:e===r})}function Ae(e,r){return r.every(function(r){return e.indexOf(r)>-1})}function Be(e,r){return e.length===r}function Ce(e,r){return new RegExp(r).test(e)}function De(e,r){switch(r){case"null":return null===e;case"boolean":return"boolean"==typeof e;case"number":return"number"==typeof e;case"string":return"string"==typeof e;case"array":return e instanceof Array;case"object":return"[object Object]"==={}.toString.call(e);}throw new Error(r+" not supported as a type.Please use one of object, string, array, number, boolean or null.")}var rc={$elemMatch:function(e,r,t,n){return!!Array.isArray(n)&&0!==n.length&&("object"==typeof n[0]?n.some(function(e){return ga(e,r,Object.keys(r))}):n.some(function(n){return Rb(r,e,t,n)}))},$allMatch:function(e,r,t,n){return!!Array.isArray(n)&&0!==n.length&&("object"==typeof n[0]?n.every(function(e){return ga(e,r,Object.keys(r))}):n.every(function(n){return Rb(r,e,t,n)}))},$eq:function(e,r,t,n){return S(n)&&0===w(n,r)},$gte:function(e,r,t,n){return S(n)&&w(n,r)>=0},$gt:function(e,r,t,n){return S(n)&&w(n,r)>0},$lte:function(e,r,t,n){return S(n)&&w(n,r)<=0},$lt:function(e,r,t,n){return S(n)&&w(n,r)<0},$exists:function(e,r,t,n){return r?S(n):!S(n)},$mod:function(e,r,t,n){return Aa(n)&&ye(n,r)},$ne:function(e,r,t,n){return r.every(function(e){return 0!==w(n,e)})},$in:function(e,r,t,n){return Aa(n)&&qc(n,r)},$nin:function(e,r,t,n){return Aa(n)&&!qc(n,r)},$size:function(e,r,t,n){return Aa(n)&&Be(n,r)},$all:function(e,r,t,n){return Array.isArray(n)&&Ae(n,r)},$regex:function(e,r,t,n){return Aa(n)&&Ce(n,r)},$type:function(e,r,t,n){return De(n,r)}};function Fe(e,r){if("object"!=typeof r)throw new Error("Selector error: expected a JSON object");var t=re([{doc:e}],{selector:r=uj(r)},Object.keys(r));return t&&1===t.length}function Ge(e){return wb("\"use strict\";\nreturn "+e+";",{})}function He(e){return wb(["return function(doc) {","  \"use strict\";","  var emitted = false;","  var emit = function (a, b) {","    emitted = true;","  };","  var view = "+e+";","  view(doc);","  if (emitted) {","    return true;","  }","};"].join("\n"),{})}function Ie(e,r){if(e.selector&&e.filter&&"_selector"!==e.filter){var t="string"==typeof e.filter?e.filter:"function";return r(new Error("selector invalid for filter \""+t+"\""))}r()}function Je(e){e.view&&!e.filter&&(e.filter="_view"),e.selector&&!e.filter&&(e.filter="_selector"),e.filter&&"string"==typeof e.filter&&("_view"===e.filter?e.view=Mc(e.view):e.filter=Mc(e.filter))}function Ke(e,r){return r.filter&&"string"==typeof r.filter&&!r.doc_ids&&!H(e.db)}function Le(e,r){var t=r.complete;if("_view"===r.filter){if(!r.view||"string"!=typeof r.view){var n=j(La,"`view` filter parameter not found or invalid.");return t(n)}var i=rb(r.view);e.db.get("_design/"+i[0],function(n,a){if(e.isCancelled)return t(null,{status:"cancelled"});if(n)return t(ma(n));var o=a&&a.views&&a.views[i[1]]&&a.views[i[1]].map;if(!o)return t(j(E,a.views?"missing json key: "+i[1]:"missing json key: views"));r.filter=He(o),e.doChanges(r)})}else if(r.selector)r.filter=function(e){return Fe(e,r.selector)},e.doChanges(r);else{var a=rb(r.filter);e.db.get("_design/"+a[0],function(n,i){if(e.isCancelled)return t(null,{status:"cancelled"});if(n)return t(ma(n));var o=i&&i.filters&&i.filters[a[1]];if(!o)return t(j(E,i&&i.filters?"missing json key: "+a[1]:"missing json key: filters"));r.filter=Ge(o),e.doChanges(r)})}}function Me(e){e._changesFilterPlugin={validate:Ie,normalize:Je,shouldFilter:Ke,filter:Le}}function sc(e){return e.reduce(function(e,r){return e[r]=!0,e},{})}b.plugin(Me),b.version=Fh;var Oe=sc(["_id","_rev","_attachments","_deleted","_revisions","_revs_info","_conflicts","_deleted_conflicts","_local_seq","_rev_tree","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats","_removed"]),Pe=sc(["_attachments","_replication_id","_replication_state","_replication_state_time","_replication_state_reason","_replication_stats"]);function tc(e){if(!/^\d+-./.test(e))return j(Pc);var r=e.indexOf("-"),t=e.substring(0,r),n=e.substring(r+1);return{prefix:parseInt(t,10),id:n}}function Re(e,r){for(var t=e.start-e.ids.length+1,n=e.ids,i=[n[0],r,[]],a=1,o=n.length;a<o;a++)i=[n[a],{status:"missing"},[i]];return[{pos:t,ids:i}]}function uc(e,r,t){var n,i,a;t||(t={deterministic_revs:!0});var o={status:"available"};if(e._deleted&&(o.deleted=!0),r){if(e._id||(e._id=Wa()),i=zc(e,t.deterministic_revs),e._rev){if((a=tc(e._rev)).error)return a;e._rev_tree=[{pos:a.prefix,ids:[a.id,{status:"missing"},[[i,o,[]]]]}],n=a.prefix+1}else e._rev_tree=[{pos:1,ids:[i,o,[]]}],n=1;}else if(e._revisions&&(e._rev_tree=Re(e._revisions,o),n=e._revisions.start,i=e._revisions.ids[0]),!e._rev_tree){if((a=tc(e._rev)).error)return a;n=a.prefix,i=a.id,e._rev_tree=[{pos:n,ids:[i,o,[]]}]}Nc(e._id),e._rev=n+"-"+i;var $={metadata:{},data:{}};for(var s in e)if(Object.prototype.hasOwnProperty.call(e,s)){var c="_"===s[0];if(c&&!Oe[s]){var u=j(Qc,s);throw u.message=Qc.message+": "+s,u}c&&!Pe[s]?$.metadata[s.slice(1)]=e[s]:$.data[s]=e[s]}return $}function Te(e){try{return yb(e)}catch(e){return{error:j(Rc,"Attachment is not a valid base64 string")}}}function Ue(e,r,t){var n=Te(e.data);if(n.error)return t(n.error);e.length=n.length,e.data="blob"===r?Bb(n,e.content_type):"base64"===r?ya(n):n,Gb(n,function(r){e.digest="md5-"+r,t()})}function Ve(e,r,t){Gb(e.data,function(n){e.digest="md5-"+n,e.length=e.data.size||e.data.length||0,"binary"===r?Bc(e.data,function(r){e.data=r,t()}):"base64"===r?Fb(e.data,function(r){e.data=r,t()}):t()})}function We(e,r,t){if(e.stub)return t();"string"==typeof e.data?Ue(e,r,t):Ve(e,r,t)}function Xe(e,r,t){if(!e.length)return t();var n,i=0;function a(){i++,e.length===i&&(n?t(n):t())}e.forEach(function(e){var t=e.data&&e.data._attachments?Object.keys(e.data._attachments):[],i=0;if(!t.length)return a();function o(e){n=e,++i===t.length&&a()}for(var $ in e.data._attachments)e.data._attachments.hasOwnProperty($)&&We(e.data._attachments[$],r,o)})}function Ye(e,r,t,n,i,a,o,$){if(Bg(r.rev_tree,t.metadata.rev)&&!$)return n[i]=t,a();var s=r.winningRev||_(r),c="deleted"in r?r.deleted:K(r,s),u="deleted"in t.metadata?t.metadata.deleted:K(t.metadata),v=/^1-/.test(t.metadata.rev);if(c&&!u&&$&&v){var l=t.data;l._rev=s,l._id=t.metadata.id,t=uc(l,$)}var f=nc(r.rev_tree,t.metadata.rev_tree[0],e);if($&&(c&&u&&"new_leaf"!==f.conflicts||!c&&"new_leaf"!==f.conflicts||c&&!u&&"new_branch"===f.conflicts)){var d=j(oa);return n[i]=d,a()}var p=t.metadata.rev;t.metadata.rev_tree=f.tree,t.stemmedRevs=f.stemmedRevs||[],r.rev_map&&(t.metadata.rev_map=r.rev_map);var h=_(t.metadata),Q=K(t.metadata,h),X=c===Q?0:c<Q?-1:1;o(t,h,Q,p===h?Q:K(t.metadata,p),!0,X,i,a)}function Ij(e){return"missing"===e.metadata.rev_tree[0].ids[1].status}function $e(e,r,t,n,i,a,o,$,s){e=e||1e3;var c=$.new_edits,u=new C,v=0,l=r.length;function f(){++v===l&&s&&s()}r.forEach(function(e,r){if(e._id&&V(e._id)){var n=e._deleted?"_removeLocal":"_putLocal";t[n](e,{ctx:i},function(e,t){a[r]=e||t,f()})}else{var o=e.metadata.id;u.has(o)?(l--,u.get(o).push([e,r])):u.set(o,[[e,r]])}}),u.forEach(function(r,t){var i=0;function s(){++i<r.length?u():f()}function u(){var u=r[i],v=u[0],l=u[1];if(n.has(t))Ye(e,n.get(t),v,a,l,s,o,c);else{var f=nc([],v.metadata.rev_tree[0],e);v.metadata.rev_tree=f.tree,v.stemmedRevs=f.stemmedRevs||[],function(e,r,t){var n=_(e.metadata),i=K(e.metadata,n);if("was_delete"in $&&i)return a[r]=j(E,"deleted"),t();if(c&&Ij(e)){var s=j(oa);return a[r]=s,t()}o(e,n,i,i,!1,i?0:1,r,t)}(v,l,s)}}u()})}var _e=5,k="document-store",z="by-sequence",B="attach-store",U="attach-seq-store",A="meta-store",I="local-store",Ib="detect-blob-support";function hf(e){try{return JSON.parse(e)}catch(r){var $d90$$interop$default=q(Ia);return $d90$$interop$default.d.parse(e)}}function jf(e){try{return JSON.stringify(e)}catch(r){var $d90$$interop$default=q(Ia);return $d90$$interop$default.d.stringify(e)}}function G(e){return function(r){var t="unknown_error";r.target&&r.target.error&&(t=r.target.error.name||r.target.error.message),e(j(kb,t,r.type))}}function Eb(e,r,t){return{data:jf(e),winningRev:r,deletedOrLocal:t?"1":"0",seq:e.seq,id:e.id}}function Y(e){if(!e)return null;var r=hf(e.data);return r.winningRev=e.winningRev,r.deleted="1"===e.deletedOrLocal,r.seq=e.seq,r}function Ua(e){if(!e)return e;var r=e._doc_id_rev.lastIndexOf(":");return e._id=e._doc_id_rev.substring(0,r-1),e._rev=e._doc_id_rev.substring(r+1),delete e._doc_id_rev,e}function Dc(e,r,t,n){t?n(e?"string"!=typeof e?e:Cb(e,r):Ab([""],{type:r})):e?"string"!=typeof e?Cc(e,function(e){n(ya(e))}):n(e):n("")}function Ec(e,r,t,n){var i=Object.keys(e._attachments||{});if(!i.length)return n&&n();var a=0;function o(){++a===i.length&&n&&n()}i.forEach(function(n){r.attachments&&r.include_docs?function(e,r){var n=e._attachments[r],i=n.digest;t.objectStore(B).get(i).onsuccess=function(e){n.body=e.target.result.body,o()}}(e,n):(e._attachments[n].stub=!0,o())})}function vb(e,r){return Promise.all(e.map(function(e){if(e.doc&&e.doc._attachments){var t=Object.keys(e.doc._attachments);return Promise.all(t.map(function(t){var n=e.doc._attachments[t];if("body"in n){var i=n.body,a=n.content_type;return new Promise(function(o){Dc(i,a,r,function(r){e.doc._attachments[t]=pa(za(n,["digest","content_type"]),{data:r}),o()})})}}))}}))}function Gc(e,r,t){var n=[],i=t.objectStore(z),a=t.objectStore(B),o=t.objectStore(U),$=e.length;function s(){--$||function(){if(!n.length)return;n.forEach(function(e){var r=o.index("digestSeq").count(IDBKeyRange.bound(e+"::",e+"::\uFFFF",!1,!1));r.onsuccess=function(r){var t=r.target.result;t||a.delete(e)}})}()}e.forEach(function(e){var t=i.index("_doc_id_rev"),a=r+"::"+e;t.getKey(a).onsuccess=function(e){var r=e.target.result;if("number"!=typeof r)return s();i.delete(r),o.index("seq").openCursor(IDBKeyRange.only(r)).onsuccess=function(e){var r=e.target.result;if(r){var t=r.value.digestSeq.split("::")[0];n.push(t),o.delete(r.primaryKey),r.continue()}else s()}}})}function F(e,r,t){try{return{txn:e.transaction(r,t)}}catch(e){return{error:e}}}var xa=new da;function uf(e,r,t,n,i,a){for(var o,$,s,c,u,v,l,f,d=r.docs,p=0,h=d.length;p<h;p++){var Q=d[p];Q._id&&V(Q._id)||(Q=d[p]=uc(Q,t.new_edits,e)).error&&!l&&(l=Q)}if(l)return a(l);var X=!1,_=0,g=new Array(d.length),m=new C,y=!1,b=n._meta.blobSupport?"blob":"base64";function E(){X=!0,S()}function S(){f&&X&&(f.docCount+=_,v.put(f))}function w(){y||(xa.notify(n._meta.name),a(null,g))}function O(e,r,t,n,i,a,o,$){e.metadata.winningRev=r,e.metadata.deleted=t;var s=e.data;if(s._id=e.metadata.id,s._rev=e.metadata.rev,n&&(s._deleted=!0),s._attachments&&Object.keys(s._attachments).length)return function(e,r,t,n,i,a){var o=e.data,$=0,s=Object.keys(o._attachments);function u(){$===s.length&&T(e,r,t,n,i,a)}function v(){$++,u()}s.forEach(function(t){var n=e.data._attachments[t];if(n.stub)$++,u();else{var i=n.data;delete n.data,n.revpos=parseInt(r,10);var a=n.digest;!function(e,r,t){c.count(e).onsuccess=function(n){var i=n.target.result;if(i)return t();var a={digest:e,body:r},o=c.put(a);o.onsuccess=t}}(a,i,v)}})}(e,r,t,i,o,$);_+=a,S(),T(e,r,t,i,o,$)}function T(e,r,t,i,a,c){var v=e.data,l=e.metadata;function f(a){var s=e.stemmedRevs||[];i&&n.auto_compaction&&(s=s.concat(lg(e.metadata))),s&&s.length&&Gc(s,e.metadata.id,o),l.seq=a.target.result;var c=Eb(l,r,t);$.put(c).onsuccess=d}function d(){g[a]={ok:!0,id:l.id,rev:l.rev},m.set(e.metadata.id,e.metadata),function(e,r,t){var n=0,i=Object.keys(e.data._attachments||{});if(!i.length)return t();function a(){++n===i.length&&t()}function o(t){var n=e.data._attachments[t].digest,i=u.put({seq:r,digestSeq:n+"::"+r});i.onsuccess=a,i.onerror=function(e){e.preventDefault(),e.stopPropagation(),a()}}for(var $=0;$<i.length;$++)o(i[$])}(e,l.seq,c)}v._doc_id_rev=l.id+"::"+l.rev,delete v._id,delete v._rev;var p=s.put(v);p.onsuccess=f,p.onerror=function(e){e.preventDefault(),e.stopPropagation(),s.index("_doc_id_rev").getKey(v._doc_id_rev).onsuccess=function(e){s.put(v,e.target.result).onsuccess=f}}}Xe(d,b,function(r){if(r)return a(r);!function(){var r=F(i,[k,z,B,I,U,A],"readwrite");if(r.error)return a(r.error);(o=r.txn).onabort=G(a),o.ontimeout=G(a),o.oncomplete=w,$=o.objectStore(k),s=o.objectStore(z),c=o.objectStore(B),u=o.objectStore(U),(v=o.objectStore(A)).get(A).onsuccess=function(e){f=e.target.result,S()},function(e){var r=[];if(d.forEach(function(e){e.data&&e.data._attachments&&Object.keys(e.data._attachments).forEach(function(t){var n=e.data._attachments[t];n.stub&&r.push(n.digest)})}),!r.length)return e();var t,n=0;r.forEach(function(i){!function(e,r){c.get(e).onsuccess=function(t){if(t.target.result)r();else{var n=j(ee,"unknown stub attachment with digest "+e);n.status=412,r(n)}}}(i,function(i){i&&!t&&(t=i),++n===r.length&&e(t)})})}(function(r){if(r)return y=!0,a(r);!function(){if(!d.length)return;var r=0;function i(){++r===d.length&&$e(e.revs_limit,d,n,m,o,g,O,t,E)}function a(e){var r=Y(e.target.result);r&&m.set(r.id,r),i()}for(var s=0,c=d.length;s<c;s++){var u=d[s];if(u._id&&V(u._id))i();else{var v=$.get(u.metadata.id);v.onsuccess=a}}}()})}()})}function Ic(e,r,t,n,i){var a,o,$;function s(e){o=e.target.result,a&&i(a,o,$)}function c(e){a=e.target.result,o&&i(a,o,$)}function u(e){var r=e.target.result;if(!r)return i();i([r.key],[r.value],r)}-1===n&&(n=1e3),"function"==typeof e.getAll&&"function"==typeof e.getAllKeys&&n>1&&!t?($={continue:function(){if(!a.length)return i();var t,$=a[a.length-1];if(r&&r.upper)try{t=IDBKeyRange.bound($,r.upper,!0,r.upperOpen)}catch(e){if("DataError"===e.name&&0===e.code)return i()}else t=IDBKeyRange.lowerBound($,!0);r=t,a=null,o=null,e.getAll(r,n).onsuccess=s,e.getAllKeys(r,n).onsuccess=c}},e.getAll(r,n).onsuccess=s,e.getAllKeys(r,n).onsuccess=c):t?e.openCursor(r,"prev").onsuccess=u:e.openCursor(r).onsuccess=u}function wf(e,r,t){if("function"!=typeof e.getAll){var n=[];e.openCursor(r).onsuccess=function(e){var r=e.target.result;r?(n.push(r.value),r.continue()):t({target:{result:n}})}}else e.getAll(r).onsuccess=t}function xf(e,r,t){var n=new Array(e.length),i=0;e.forEach(function(a,o){r.get(a).onsuccess=function(r){r.target.result?n[o]=r.target.result:n[o]={key:a,error:"not_found"},++i===e.length&&t(e,n,{})}})}function yf(e,r,t,n,i){try{if(e&&r)return i?IDBKeyRange.bound(r,e,!t,!1):IDBKeyRange.bound(e,r,!1,!t);if(e)return i?IDBKeyRange.upperBound(e):IDBKeyRange.lowerBound(e);if(r)return i?IDBKeyRange.lowerBound(r,!t):IDBKeyRange.upperBound(r,!t);if(n)return IDBKeyRange.only(n)}catch(e){return{error:e}}return null}function zf(e,r,t){var n,i,a="startkey"in e&&e.startkey,o="endkey"in e&&e.endkey,$="key"in e&&e.key,s="keys"in e&&e.keys,c=e.skip||0,u="number"==typeof e.limit?e.limit:-1,v=!1!==e.inclusive_end;if(!s&&(i=(n=yf(a,o,v,$,e.descending))&&n.error)&&("DataError"!==i.name||0!==i.code))return t(j(kb,i.name,i.message));var l=[k,z,A];e.attachments&&l.push(B);var f=F(r,l,"readonly");if(f.error)return t(f.error);var d=f.txn;d.oncomplete=function(){e.attachments?vb(m,e.binary).then(S):S()},d.onabort=G(t);var p,h,Q=d.objectStore(k),X=d.objectStore(z),_=d.objectStore(A),g=X.index("_doc_id_rev"),m=[];function y(r,t){var n={id:t.id,key:t.id,value:{rev:r}};t.deleted?s&&(m.push(n),n.value.deleted=!0,n.doc=null):c--<=0&&(m.push(n),e.include_docs&&function(r,t,n){var i=r.id+"::"+n;g.get(i).onsuccess=function(n){if(t.doc=Ua(n.target.result)||{},e.conflicts){var i=Mb(r);i.length&&(t.doc._conflicts=i)}Ec(t.doc,e,d)}}(t,n,r))}function b(e){for(var r=0,t=e.length;r<t&&m.length!==u;r++){var n=e[r];if(n.error&&s)m.push(n);else{var i=Y(n);y(i.winningRev,i)}}}function E(e,r,t){t&&(b(r),m.length<u&&t.continue())}function S(){var r={total_rows:p,offset:e.skip,rows:m};e.update_seq&&void 0!==h&&(r.update_seq=h),t(null,r)}return _.get(A).onsuccess=function(e){p=e.target.result.docCount},e.update_seq&&function(e,r){e.openCursor(null,"prev").onsuccess=function(e){var t=e.target.result,n=void 0;t&&t.key&&(n=t.key);return r({target:{result:[n]}})}}(X,function(e){e.target.result&&e.target.result.length>0&&(h=e.target.result[0])}),i||0===u?void 0:s?xf(e.keys,Q,E):-1===u?wf(Q,n,function(r){var t=r.target.result;e.descending&&(t=t.reverse()),b(t)}):void Ic(Q,n,e.descending,u+c,E)}function Af(e){return new Promise(function(r){var t=Ab([""]),n=e.objectStore(Ib).put(t,"key");n.onsuccess=function(){var e=navigator.userAgent.match(/Chrome\/(\d+)/),t=navigator.userAgent.match(/Edge\//);r(t||!e||parseInt(e[1],10)>=43)},n.onerror=e.onabort=function(e){e.preventDefault(),e.stopPropagation(),r(!1)}}).catch(function(){return!1})}function Bf(e,r){e.objectStore(k).index("deletedOrLocal").count(IDBKeyRange.only("0")).onsuccess=function(e){r(e.target.result)}}var Cf=!1,tb=[];function Ef(e,r,t,n){try{e(r,t)}catch(r){n.emit("error",r)}}function Kc(){!Cf&&tb.length&&(Cf=!0,tb.shift()())}function Gf(e,r,t){tb.push(function(){e(function(e,n){var $EK2n$$interop$default=q(M);Ef(r,e,n,t),Cf=!1,$EK2n$$interop$default.d(function(){Kc(t)})})}),Kc()}function Hf(e,r,t,n){if((e=x(e)).continuous){var i=t+":"+Wa();return xa.addListener(t,i,r,e),xa.notify(t),{cancel:function(){xa.removeListener(t,i)}}}var a=e.doc_ids&&new Xa(e.doc_ids);e.since=e.since||0;var o=e.since,$="limit"in e?e.limit:-1;0===$&&($=1);var s,c,u,v,l=[],f=0,d=ob(e),p=new C;function h(e,r,t,n){if(t.seq!==r)return n();if(t.winningRev===e._rev)return n(t,e);var i=e._id+"::"+t.winningRev;v.get(i).onsuccess=function(e){n(t,Ua(e.target.result))}}function Q(){e.complete(null,{results:l,last_seq:o})}var X=[k,z];e.attachments&&X.push(B);var _=F(n,X,"readonly");if(_.error)return e.complete(_.error);(s=_.txn).onabort=G(e.complete),s.oncomplete=function(){!e.continuous&&e.attachments?vb(l).then(Q):Q()},c=s.objectStore(z),u=s.objectStore(k),v=c.index("_doc_id_rev"),Ic(c,e.since&&!e.descending?IDBKeyRange.lowerBound(e.since,!0):null,e.descending,$,function(r,t,n){if(n&&r.length){var i=new Array(r.length),c=new Array(r.length),v=0;t.forEach(function(t,o){!function(e,r,t){if(a&&!a.has(e._id))return t();var n=p.get(e._id);if(n)return h(e,r,n,t);u.get(e._id).onsuccess=function(i){n=Y(i.target.result),p.set(e._id,n),h(e,r,n,t)}}(Ua(t),r[o],function(t,a){c[o]=t,i[o]=a,++v===r.length&&function(){for(var r=[],t=0,a=i.length;t<a&&f!==$;t++){var o=i[t];if(o){var s=c[t];r.push(Q(s,o))}}Promise.all(r).then(function(r){for(var t=0,n=r.length;t<n;t++)r[t]&&e.onChange(r[t])}).catch(e.complete),f!==$&&n.continue()}()})})}function Q(r,t){var n=e.processChange(t,r,e);o=n.seq=r.seq;var i=d(n);return"object"==typeof i?Promise.reject(i):i?(f++,e.return_docs&&l.push(n),e.attachments&&e.include_docs?new Promise(function(r){Ec(t,e,s,function(){vb([n],e.binary).then(function(){r(n)})})}):Promise.resolve(n)):Promise.resolve()}})}var Lc,la=new C,qb=new C;function Oc(e,r){var t=this;Gf(function(r){Mf(t,e,r)},r,t.constructor)}function Mf(e,r,t){var n=r.name,i=null;function a(e,r){var t=e.objectStore(k);t.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),t.openCursor().onsuccess=function(e){var n=e.target.result;if(n){var i=n.value,a=K(i);i.deletedOrLocal=a?"1":"0",t.put(i),n.continue()}else r()}}function o(e,r){var t=e.objectStore(I),n=e.objectStore(k),i=e.objectStore(z);n.openCursor().onsuccess=function(e){var a=e.target.result;if(a){var o=a.value,$=o.id,s=V($),c=_(o);if(s){var u=$+"::"+c,v=$+"::",l=$+"::~",f=i.index("_doc_id_rev"),d=IDBKeyRange.bound(v,l,!1,!1),p=f.openCursor(d);p.onsuccess=function(e){if(p=e.target.result){var r=p.value;r._doc_id_rev===u&&t.put(r),i.delete(p.primaryKey),p.continue()}else n.delete(a.primaryKey),a.continue()}}else a.continue()}else r&&r()}}function $(e,r){var t=e.objectStore(z),n=e.objectStore(B),i=e.objectStore(U);n.count().onsuccess=function(e){if(!e.target.result)return r();t.openCursor().onsuccess=function(e){var t=e.target.result;if(!t)return r();for(var n=t.value,a=t.primaryKey,o=Object.keys(n._attachments||{}),$={},s=0;s<o.length;s++){$[n._attachments[o[s]].digest]=!0}var c=Object.keys($);for(s=0;s<c.length;s++){var u=c[s];i.put({seq:a,digestSeq:u+"::"+a})}t.continue()}}}function s(e){var r=e.objectStore(z),t=e.objectStore(k);t.openCursor().onsuccess=function(e){var n=e.target.result;if(n){var i,a,o,$,s,c=(i=n.value).data?Y(i):(i.deleted="1"===i.deletedOrLocal,i);if(c.winningRev=c.winningRev||_(c),c.seq)return u();a=c.id+"::",o=c.id+"::\uFFFF",$=r.index("_doc_id_rev").openCursor(IDBKeyRange.bound(a,o)),s=0,$.onsuccess=function(e){var r=e.target.result;if(!r)return c.seq=s,u();var t=r.primaryKey;t>s&&(s=t),r.continue()}}function u(){var e=Eb(c,c.winningRev,c.deleted);t.put(e).onsuccess=function(){n.continue()}}}}e._meta=null,e._remote=!1,e.type=function(){return"idb"},e._id=ad(function(r){r(null,e._meta.instanceId)}),e._bulkDocs=function(t,n,a){uf(r,t,n,e,i,a)},e._get=function(e,r,t){var n,a,o,$=r.ctx;if(!$){var s=F(i,[k,z,B],"readonly");if(s.error)return t(s.error);$=s.txn}function c(){t(o,{doc:n,metadata:a,ctx:$})}$.objectStore(k).get(e).onsuccess=function(e){if(!(a=Y(e.target.result)))return o=j(E,"missing"),c();var t;if(r.rev)t=r.latest?Pg(r.rev,a):r.rev;else if(t=a.winningRev,K(a))return o=j(E,"deleted"),c();var i=$.objectStore(z),s=a.id+"::"+t;i.index("_doc_id_rev").get(s).onsuccess=function(e){if((n=e.target.result)&&(n=Ua(n)),!n)return o=j(E,"missing"),c();c()}}},e._getAttachment=function(e,r,t,n,a){var o;if(n.ctx)o=n.ctx;else{var $=F(i,[k,z,B],"readonly");if($.error)return a($.error);o=$.txn}var s=t.digest,c=t.content_type;o.objectStore(B).get(s).onsuccess=function(e){Dc(e.target.result.body,c,n.binary,function(e){a(null,e)})}},e._info=function(r){var t,n,a=F(i,[A,z],"readonly");if(a.error)return r(a.error);var o=a.txn;o.objectStore(A).get(A).onsuccess=function(e){n=e.target.result.docCount},o.objectStore(z).openCursor(null,"prev").onsuccess=function(e){var r=e.target.result;t=r?r.key:0},o.oncomplete=function(){r(null,{doc_count:n,update_seq:t,idb_attachment_format:e._meta.blobSupport?"binary":"base64"})}},e._allDocs=function(e,r){zf(e,i,r)},e._changes=function(r){return Hf(r,e,n,i)},e._close=function(e){i.close(),la.delete(n),e()},e._getRevisionTree=function(e,r){var t=F(i,[k],"readonly");if(t.error)return r(t.error);t.txn.objectStore(k).get(e).onsuccess=function(e){var t=Y(e.target.result);t?r(null,t.rev_tree):r(j(E))}},e._doCompaction=function(e,r,t){var n=F(i,[k,z,B,U],"readwrite");if(n.error)return t(n.error);var a=n.txn;a.objectStore(k).get(e).onsuccess=function(t){var n=Y(t.target.result);Z(n.rev_tree,function(e,t,n,i,a){var o=t+"-"+n;-1!==r.indexOf(o)&&(a.status="missing")}),Gc(r,e,a);var i=n.winningRev,o=n.deleted;a.objectStore(k).put(Eb(n,i,o))},a.onabort=G(t),a.oncomplete=function(){t()}},e._getLocal=function(e,r){var t=F(i,[I],"readonly");if(t.error)return r(t.error);var n=t.txn.objectStore(I).get(e);n.onerror=G(r),n.onsuccess=function(e){var t=e.target.result;t?(delete t._doc_id_rev,r(null,t)):r(j(E))}},e._putLocal=function(e,r,t){"function"==typeof r&&(t=r,r={}),delete e._revisions;var n=e._rev,a=e._id;e._rev=n?"0-"+(parseInt(n.split("-")[1],10)+1):"0-1";var o,$=r.ctx;if(!$){var s=F(i,[I],"readwrite");if(s.error)return t(s.error);($=s.txn).onerror=G(t),$.oncomplete=function(){o&&t(null,o)}}var c,u=$.objectStore(I);n?(c=u.get(a)).onsuccess=function(i){var a=i.target.result;a&&a._rev===n?u.put(e).onsuccess=function(){o={ok:!0,id:e._id,rev:e._rev},r.ctx&&t(null,o)}:t(j(oa))}:((c=u.add(e)).onerror=function(e){t(j(oa)),e.preventDefault(),e.stopPropagation()},c.onsuccess=function(){o={ok:!0,id:e._id,rev:e._rev},r.ctx&&t(null,o)})},e._removeLocal=function(e,r,t){"function"==typeof r&&(t=r,r={});var n,a=r.ctx;if(!a){var o=F(i,[I],"readwrite");if(o.error)return t(o.error);(a=o.txn).oncomplete=function(){n&&t(null,n)}}var $=e._id,s=a.objectStore(I),c=s.get($);c.onerror=G(t),c.onsuccess=function(i){var a=i.target.result;a&&a._rev===e._rev?(s.delete($),n={ok:!0,id:$,rev:"0-0"},r.ctx&&t(null,n)):t(j(E))}},e._destroy=function(e,r){xa.removeAllListeners(n);var t=qb.get(n);t&&t.result&&(t.result.close(),la.delete(n));var i=indexedDB.deleteDatabase(n);i.onsuccess=function(){qb.delete(n),db()&&n in localStorage&&delete localStorage[n],r(null,{ok:!0})},i.onerror=G(r)};var c=la.get(n);var $EK2n$$interop$default=q(M);if(c)return i=c.idb,e._meta=c.global,$EK2n$$interop$default.d(function(){t(null,e)});var u=indexedDB.open(n,_e);qb.set(n,u),u.onupgradeneeded=function(e){var r=e.target.result;if(e.oldVersion<1)return function(e){var r=e.createObjectStore(k,{keyPath:"id"});e.createObjectStore(z,{autoIncrement:!0}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0}),e.createObjectStore(B,{keyPath:"digest"}),e.createObjectStore(A,{keyPath:"id",autoIncrement:!1}),e.createObjectStore(Ib),r.createIndex("deletedOrLocal","deletedOrLocal",{unique:!1}),e.createObjectStore(I,{keyPath:"_id"});var t=e.createObjectStore(U,{autoIncrement:!0});t.createIndex("seq","seq"),t.createIndex("digestSeq","digestSeq",{unique:!0})}(r);var t=e.currentTarget.transaction;e.oldVersion<3&&function(e){e.createObjectStore(I,{keyPath:"_id"}).createIndex("_doc_id_rev","_doc_id_rev",{unique:!0})}(r),e.oldVersion<4&&function(e){var r=e.createObjectStore(U,{autoIncrement:!0});r.createIndex("seq","seq"),r.createIndex("digestSeq","digestSeq",{unique:!0})}(r);var n=[a,o,$,s],i=e.oldVersion;!function e(){var r=n[i-1];i++,r&&r(t,e)}()},u.onsuccess=function(r){(i=r.target.result).onversionchange=function(){i.close(),la.delete(n)},i.onabort=function(e){y("error","Database has a global failure",e.target.error),i.close(),la.delete(n)};var a,o,$,s,c=i.transaction([A,Ib,k],"readwrite"),u=!1;function v(){void 0!==$&&u&&(e._meta={name:n,instanceId:s,blobSupport:$},la.set(n,{idb:i,global:e._meta}),t(null,e))}function l(){if(void 0!==o&&void 0!==a){var e=n+"_id";e in a?s=a[e]:a[e]=s=Wa(),a.docCount=o,c.objectStore(A).put(a)}}c.objectStore(A).get(A).onsuccess=function(e){a=e.target.result||{id:A},l()},Bf(c,function(e){o=e,l()}),Lc||(Lc=Af(c)),Lc.then(function(e){$=e,v()}),c.oncomplete=function(){u=!0,v()},c.onabort=G(t)},u.onerror=function(){var e="Failed to open indexedDB, are you in private browsing mode?";y("error",e),t(j(kb,e))}}function Nf(e){e.adapter("idb",Oc,!0)}function Of(e,r){return new Promise(function(t,n){var i,a=0,o=0,$=0,s=e.length;function c(){++$===s?i?n(i):t():l()}function u(){a--,c()}function v(e){a--,i=i||e,c()}function l(){for(;a<r&&o<s;)a++,e[o++]().then(u,v)}l()})}Oc.valid=function(){try{return"undefined"!=typeof indexedDB&&"undefined"!=typeof IDBKeyRange}catch(e){return!1}};var Pf=25,Qf=50,Ma=5e3,Sf=1e4,hb={};function gb(e){var r=(e.doc||e.ok)._attachments;r&&Object.keys(r).forEach(function(e){var t=r[e];t.data=Cb(t.data,t.content_type)})}function R(e){return /^_design/.test(e)?"_design/"+encodeURIComponent(e.slice(8)):/^_local/.test(e)?"_local/"+encodeURIComponent(e.slice(7)):encodeURIComponent(e)}function Tc(e){return e._attachments&&Object.keys(e._attachments)?Promise.all(Object.keys(e._attachments).map(function(r){var t=e._attachments[r];if(t.data&&"string"!=typeof t.data)return new Promise(function(e){Fb(t.data,e)}).then(function(e){t.data=e})})):Promise.resolve()}function Xf(e){if(!e.prefix)return!1;var r=Fc(e.prefix).protocol;return"http"===r||"https"===r}function Yf(e,r){if(Xf(r)){var t=r.name.substr(r.prefix.length);e=r.prefix.replace(/\/?$/,"/")+encodeURIComponent(t)}var n=Fc(e);(n.user||n.password)&&(n.auth={username:n.user,password:n.password});var i=n.path.replace(/(^\/|\/$)/g,"").split("/");return n.db=i.pop(),-1===n.db.indexOf("%")&&(n.db=encodeURIComponent(n.db)),n.path=i.join("/"),n}function m(e,r){return fb(e,e.db+"/"+r)}function fb(e,r){var t=e.path?"/":"";return e.protocol+"://"+e.host+(e.port?":"+e.port:"")+"/"+e.path+t+r}function Ka(e){return"?"+Object.keys(e).map(function(r){return r+"="+encodeURIComponent(e[r])}).join("&")}function ag(e){var r="undefined"!=typeof navigator&&navigator.userAgent?navigator.userAgent.toLowerCase():"",t=-1!==r.indexOf("msie"),n=-1!==r.indexOf("trident"),i=-1!==r.indexOf("edge"),a=!("method"in e)||"GET"===e.method;return(t||n||i)&&a}function Qb(e,r){var t=this,n=Yf(e.name,e),i=m(n,"");e=x(e);var a,o=function(r,t){if((t=t||{}).headers=t.headers||new ra,e.auth||n.auth){var i=e.auth||n.auth,a=i.username+":"+i.password,o=ya(unescape(encodeURIComponent(a)));t.headers.set("Authorization","Basic "+o)}var $=e.headers||{};return Object.keys($).forEach(function(e){t.headers.append(e,$[e])}),ag(t)&&(r+=(-1===r.indexOf("?")?"?":"&")+"_nonce="+Date.now()),(e.fetch||ic)(r,t)};function $(e,r){var $uOR$$interop$default=q(qa);return f(e,$uOR$$interop$default.d(function(e){c().then(function(){return r.apply(this,e)}).catch(function(r){e.pop()(r)})})).bind(t)}function s(e,r,t){var n={};return(r=r||{}).headers=r.headers||new ra,r.headers.get("Content-Type")||r.headers.set("Content-Type","application/json"),r.headers.get("Accept")||r.headers.set("Accept","application/json"),o(e,r).then(function(e){return n.ok=e.ok,n.status=e.status,e.json()}).then(function(e){if(n.data=e,!n.ok){n.data.status=n.status;var r=ma(n.data);if(t)return t(r);throw r}if(Array.isArray(n.data)&&(n.data=n.data.map(function(e){return e.error||e.missing?ma(e):e})),!t)return n;t(null,n.data)})}function c(){return e.skip_setup?Promise.resolve():a||((a=s(i).catch(function(e){return e&&e.status&&404===e.status?(Wb(404,"PouchDB is just detecting if the remote exists."),s(i,{method:"PUT"})):Promise.reject(e)}).catch(function(e){return!(!e||!e.status||412!==e.status)||Promise.reject(e)})).catch(function(){a=null}),a)}function u(e){return e.split("/").map(encodeURIComponent).join("/")}var $EK2n$$interop$default=q(M);$EK2n$$interop$default.d(function(){r(null,t)}),t._remote=!0,t.type=function(){return"http"},t.id=$("id",function(e){o(fb(n,"")).then(function(e){return e.json()}).then(function(r){var t=r&&r.uuid?r.uuid+n.db:m(n,"");e(null,t)}).catch(function(r){e(r)})}),t.compact=$("compact",function(e,r){"function"==typeof e&&(r=e,e={}),e=x(e),s(m(n,"_compact"),{method:"POST"}).then(function(){!function n(){t.info(function(t,i){i&&!i.compact_running?r(null,{ok:!0}):setTimeout(n,e.interval||200)})}()})}),t.bulkGet=f("bulkGet",function(e,r){var t=this;function i(r){var t={};e.revs&&(t.revs=!0),e.attachments&&(t.attachments=!0),e.latest&&(t.latest=!0),s(m(n,"_bulk_get"+Ka(t)),{method:"POST",body:JSON.stringify({docs:e.docs})}).then(function(t){e.attachments&&e.binary&&t.data.results.forEach(function(e){e.docs.forEach(gb)}),r(null,t.data)}).catch(r)}function a(){var n=Qf,i=Math.ceil(e.docs.length/n),a=0,o=new Array(i);function $(e){return function(t,n){o[e]=n.results,++a===i&&r(null,{results:Pa(o)})}}for(var s=0;s<i;s++){var c=za(e,["revs","attachments","binary","latest"]);c.docs=e.docs.slice(s*n,Math.min(e.docs.length,(s+1)*n)),Xc(t,c,$(s))}}var o=fb(n,""),$=hb[o];"boolean"!=typeof $?i(function(e,t){e?(hb[o]=!1,Wb(e.status,"PouchDB is just detecting if the remote supports the _bulk_get API."),a()):(hb[o]=!0,r(null,t))}):$?i(r):a()}),t._info=function(e){c().then(function(){return o(m(n,""))}).then(function(e){return e.json()}).then(function(r){r.host=m(n,""),e(null,r)}).catch(e)},t.fetch=function(e,r){return c().then(function(){return o(m(n,e),r)})},t.get=$("get",function(e,r,t){"function"==typeof r&&(t=r,r={});var i={};function a(e){var t=e._attachments,i=t&&Object.keys(t);if(t&&i.length)return Of(i.map(function(i){return function(){return function(i){var a=t[i],$=R(e._id)+"/"+u(i)+"?rev="+e._rev;return o(m(n,$)).then(function(e){return void 0===Q||Q.browser?e.blob():e.buffer()}).then(function(e){return r.binary?(void 0===Q||Q.browser||(e.type=a.content_type),e):new Promise(function(r){Fb(e,r)})}).then(function(e){delete a.stub,delete a.length,a.data=e})}(i)}}),5)}(r=x(r)).revs&&(i.revs=!0),r.revs_info&&(i.revs_info=!0),r.latest&&(i.latest=!0),r.open_revs&&("all"!==r.open_revs&&(r.open_revs=JSON.stringify(r.open_revs)),i.open_revs=r.open_revs),r.rev&&(i.rev=r.rev),r.conflicts&&(i.conflicts=r.conflicts),r.update_seq&&(i.update_seq=r.update_seq),e=R(e),s(m(n,e+Ka(i))).then(function(e){return Promise.resolve().then(function(){if(r.attachments)return t=e.data,Array.isArray(t)?Promise.all(t.map(function(e){if(e.ok)return a(e.ok)})):a(t);var t}).then(function(){t(null,e.data)})}).catch(function(r){r.docId=e,t(r)})}),t.remove=$("remove",function(e,r,t,i){var a;"string"==typeof r?(a={_id:e,_rev:r},"function"==typeof t&&(i=t,t={})):(a=e,"function"==typeof r?(i=r,t={}):(i=t,t=r));var o=a._rev||t.rev;s(m(n,R(a._id))+"?rev="+o,{method:"DELETE"},i).catch(i)}),t.getAttachment=$("getAttachment",function(e,r,t,i){"function"==typeof t&&(i=t,t={});var a,$=t.rev?"?rev="+t.rev:"",s=m(n,R(e))+"/"+u(r)+$;o(s,{method:"GET"}).then(function(e){if(a=e.headers.get("content-type"),e.ok)return void 0===Q||Q.browser?e.blob():e.buffer();throw e}).then(function(e){void 0===Q||Q.browser||(e.type=a),i(null,e)}).catch(function(e){i(e)})}),t.removeAttachment=$("removeAttachment",function(e,r,t,i){s(m(n,R(e)+"/"+u(r))+"?rev="+t,{method:"DELETE"},i).catch(i)}),t.putAttachment=$("putAttachment",function(e,r,t,i,a,o){"function"==typeof a&&(o=a,a=i,i=t,t=null);var $=R(e)+"/"+u(r),c=m(n,$);if(t&&(c+="?rev="+t),"string"==typeof i){var v;try{v=yb(i)}catch(e){return o(j(Rc,"Attachment is not a valid base64 string"))}i=v?Bb(v,a):""}s(c,{headers:new ra({"Content-Type":a}),method:"PUT",body:i},o).catch(o)}),t._bulkDocs=function(e,r,t){e.new_edits=r.new_edits,c().then(function(){return Promise.all(e.docs.map(Tc))}).then(function(){return s(m(n,"_bulk_docs"),{method:"POST",body:JSON.stringify(e)},t)}).catch(t)},t._put=function(e,r,t){c().then(function(){return Tc(e)}).then(function(){return s(m(n,R(e._id)),{method:"PUT",body:JSON.stringify(e)})}).then(function(e){t(null,e.data)}).catch(function(r){r.docId=e&&e._id,t(r)})},t.allDocs=$("allDocs",function(e,r){"function"==typeof e&&(r=e,e={});var t,i={},a="GET";(e=x(e)).conflicts&&(i.conflicts=!0),e.update_seq&&(i.update_seq=!0),e.descending&&(i.descending=!0),e.include_docs&&(i.include_docs=!0),e.attachments&&(i.attachments=!0),e.key&&(i.key=JSON.stringify(e.key)),e.start_key&&(e.startkey=e.start_key),e.startkey&&(i.startkey=JSON.stringify(e.startkey)),e.end_key&&(e.endkey=e.end_key),e.endkey&&(i.endkey=JSON.stringify(e.endkey)),void 0!==e.inclusive_end&&(i.inclusive_end=!!e.inclusive_end),void 0!==e.limit&&(i.limit=e.limit),void 0!==e.skip&&(i.skip=e.skip);var o=Ka(i);void 0!==e.keys&&(a="POST",t={keys:e.keys}),s(m(n,"_all_docs"+o),{method:a,body:JSON.stringify(t)}).then(function(t){e.include_docs&&e.attachments&&e.binary&&t.data.rows.forEach(gb),r(null,t.data)}).catch(r)}),t._changes=function(e){var r="batch_size"in e?e.batch_size:Pf;!(e=x(e)).continuous||"heartbeat"in e||(e.heartbeat=Sf);var t="timeout"in e?e.timeout:3e4;"timeout"in e&&e.timeout&&t-e.timeout<Ma&&(t=e.timeout+Ma),"heartbeat"in e&&e.heartbeat&&t-e.heartbeat<Ma&&(t=e.heartbeat+Ma);var i={};"timeout"in e&&e.timeout&&(i.timeout=e.timeout);var a=void 0!==e.limit&&e.limit,o=a;if(e.style&&(i.style=e.style),(e.include_docs||e.filter&&"function"==typeof e.filter)&&(i.include_docs=!0),e.attachments&&(i.attachments=!0),e.continuous&&(i.feed="longpoll"),e.seq_interval&&(i.seq_interval=e.seq_interval),e.conflicts&&(i.conflicts=!0),e.descending&&(i.descending=!0),e.update_seq&&(i.update_seq=!0),"heartbeat"in e&&e.heartbeat&&(i.heartbeat=e.heartbeat),e.filter&&"string"==typeof e.filter&&(i.filter=e.filter),e.view&&"string"==typeof e.view&&(i.filter="_view",i.view=e.view),e.query_params&&"object"==typeof e.query_params)for(var $ in e.query_params)e.query_params.hasOwnProperty($)&&(i[$]=e.query_params[$]);var u,v="GET";e.doc_ids?(i.filter="_doc_ids",v="POST",u={doc_ids:e.doc_ids}):e.selector&&(i.filter="_selector",v="POST",u={selector:e.selector});var l,f=new vh,d=function(t,$){if(!e.aborted){i.since=t,"object"==typeof i.since&&(i.since=JSON.stringify(i.since)),e.descending?a&&(i.limit=o):i.limit=!a||o>r?r:o;var d=m(n,"_changes"+Ka(i)),p={signal:f.signal,method:v,body:JSON.stringify(u)};l=t,e.aborted||c().then(function(){return s(d,p,$)}).catch($)}},p={results:[]},h=function(t,n){if(!e.aborted){var i=0;if(n&&n.results){i=n.results.length,p.last_seq=n.last_seq;var $=null,s=null;"number"==typeof n.pending&&($=n.pending),"string"!=typeof p.last_seq&&"number"!=typeof p.last_seq||(s=p.last_seq);e.query_params,n.results=n.results.filter(function(r){o--;var t=ob(e)(r);return t&&(e.include_docs&&e.attachments&&e.binary&&gb(r),e.return_docs&&p.results.push(r),e.onChange(r,$,s)),t})}else if(t)return e.aborted=!0,void e.complete(t);n&&n.last_seq&&(l=n.last_seq);var c=a&&o<=0||n&&i<r||e.descending;(!e.continuous||a&&o<=0)&&c?e.complete(null,p):$EK2n$$interop$default.d(function(){d(l,h)})}};return d(e.since||0,h),{cancel:function(){e.aborted=!0,f.abort()}}},t.revsDiff=$("revsDiff",function(e,r,t){"function"==typeof r&&(t=r,r={}),s(m(n,"_revs_diff"),{method:"POST",body:JSON.stringify(e)},t).catch(t)}),t._close=function(e){e()},t._destroy=function(e,r){s(m(n,""),{method:"DELETE"}).then(function(e){r(null,e)}).catch(function(e){404===e.status?r(null,{ok:!0}):r(e)})}}function cg(e){e.adapter("http",Qb,!1),e.adapter("https",Qb,!1)}function aa(e){this.status=400,this.name="query_parse_error",this.message=e,this.error=!0;try{Error.captureStackTrace(this,aa)}catch(e){}}function eb(e){this.status=404,this.name="not_found",this.message=e,this.error=!0;try{Error.captureStackTrace(this,eb)}catch(e){}}function Za(e){this.status=500,this.name="invalid_value",this.message=e,this.error=!0;try{Error.captureStackTrace(this,Za)}catch(e){}}function _c(e,r){return r&&e.then(function(e){var $EK2n$$interop$default=q(M);$EK2n$$interop$default.d(function(){r(null,e)})},function(e){var $EK2n$$interop$default=q(M);$EK2n$$interop$default.d(function(){r(e)})}),e}function hg(e){var $uOR$$interop$default=q(qa);return $uOR$$interop$default.d(function(r){var t=r.pop(),n=e.apply(this,r);return"function"==typeof t&&_c(n,t),n})}function ig(e,r){return e.then(function(e){return r().then(function(){return e})},function(e){return r().then(function(){throw e})})}function ub(e,r){return function(){var t=arguments,n=this;return e.add(function(){return r.apply(n,t)})}}function bd(e){var r=new Xa(e),t=new Array(r.size),n=-1;return r.forEach(function(e){t[++n]=e}),t}function sb(e){var r=new Array(e.size),t=-1;return e.forEach(function(e,n){r[++t]=n}),r}function dc(e){return new Za("builtin "+e+" function requires map values to be numbers or number arrays")}function pb(e){for(var r=0,t=0,n=e.length;t<n;t++){var i=e[t];if("number"!=typeof i){if(!Array.isArray(i))throw dc("_sum");r="number"==typeof r?[r]:r;for(var a=0,o=i.length;a<o;a++){var $=i[a];if("number"!=typeof $)throw dc("_sum");void 0===r[a]?r.push($):r[a]+=$}}else"number"==typeof r?r+=i:r[0]+=i}return r}Qb.valid=function(){return!0},o.d(aa,Error),o.d(eb,Error),o.d(Za,Error);var og=y.bind(null,"log"),pg=Array.isArray,qg=JSON.parse;function fd(e,r){return wb("return ("+e.replace(/;\s*$/,"")+");",{emit:r,sum:pb,log:og,isArray:pg,toJSON:qg})}function ua(){this.promise=new Promise(function(e){e()})}function hd(e){if(!e)return"undefined";switch(typeof e){case"function":case"string":return e.toString();default:return JSON.stringify(e);}}function ug(e,r){return hd(e)+hd(r)+"undefined"}function id(e,r,t,n,i,a){var o,$=ug(t,n);if(!i&&(o=e._cachedViews=e._cachedViews||{})[$])return o[$];var s=e.info().then(function(s){var c=s.db_name+"-mrview-"+(i?"temp":Ac($));return Sa(e,"_local/"+a,function(e){e.views=e.views||{};var t=r;-1===t.indexOf("/")&&(t=r+"/"+r);var n=e.views[t]=e.views[t]||{};if(!n[c])return n[c]=!0,e}).then(function(){return e.registerDependentDatabase(c).then(function(r){var i=r.db;i.auto_compaction=!0;var a={name:c,db:i,sourceDB:e,adapter:e.adapter,mapFun:t,reduceFun:n};return a.db.get("_local/lastSeq").catch(function(e){if(404!==e.status)throw e}).then(function(e){return a.seq=e?e.seq:0,o&&a.db.once("destroyed",function(){delete o[$]}),a})})})});return o&&(o[$]=s),s}ua.prototype.add=function(e){return this.promise=this.promise.catch(function(){}).then(function(){return e()}),this.promise},ua.prototype.finish=function(){return this.promise};var jd={},kd=new ua,ld=50;function mb(e){return-1===e.indexOf("/")?[e,e]:e.split("/")}function Ag(e){return 1===e.length&&/^1-/.test(e[0].rev)}function nd(e,r){try{e.emit("error",r)}catch(e){y("error","The user's map/reduce function threw an uncaught error.\nYou can debug this error by doing:\nmyDatabase.on('error', function (err) { debugger; });\nPlease double-check your map/reduce function."),y("error",r)}}function Cg(e,r,t,n){function i(e,r,t){try{r(t)}catch(r){nd(e,r)}}function a(e,r,t,n,i){try{return{output:r(t,n,i)}}catch(r){return nd(e,r),{error:r}}}function o(e,r){var t=w(e.key,r.key);return 0!==t?t:w(e.value,r.value)}function $(e){var r=e.value;return r&&"object"==typeof r&&r._id||e.id}function s(e){return function(r){return e.include_docs&&e.attachments&&e.binary&&function(e){e.rows.forEach(function(e){var r=e.doc&&e.doc._attachments;r&&Object.keys(r).forEach(function(e){var t=r[e];r[e].data=Cb(t.data,t.content_type)})})}(r),r}}function c(e,r,t,n){var i=r[e];void 0!==i&&(n&&(i=encodeURIComponent(JSON.stringify(i))),t.push(e+"="+i))}function u(e){if(void 0!==e){var r=Number(e);return isNaN(r)||r!==parseInt(e,10)?e:r}}function v(e,r){var t=e.descending?"endkey":"startkey",n=e.descending?"startkey":"endkey";if(void 0!==e[t]&&void 0!==e[n]&&w(e[t],e[n])>0)throw new aa("No rows can match your key range, reverse your start_key and end_key or set {descending : true}");if(r.reduce&&!1!==e.reduce){if(e.include_docs)throw new aa("{include_docs:true} is invalid for reduce");if(e.keys&&e.keys.length>1&&!e.group&&!e.group_level)throw new aa("Multi-key fetches for reduce views must use {group: true}")}["group_level","limit","skip"].forEach(function(r){var t=function(e){if(e){if("number"!=typeof e)return new aa("Invalid value for integer: \""+e+"\"");if(e<0)return new aa("Invalid value for positive integer: \""+e+"\"")}}(e[r]);if(t)throw t})}function l(e){return function(r){if(404===r.status)return e;throw r}}function f(e,r,t){var n="_local/doc_"+e,i={_id:n,keys:[]},a=t.get(e),o=a[0];return(Ag(a[1])?Promise.resolve(i):r.db.get(n).catch(l(i))).then(function(e){return function(e){return e.keys.length?r.db.allDocs({keys:e.keys,include_docs:!0}):Promise.resolve({rows:[]})}(e).then(function(r){return function(e,r){for(var t=[],n=new Xa,i=0,a=r.rows.length;i<a;i++){var $=r.rows[i].doc;if($&&(t.push($),n.add($._id),$._deleted=!o.has($._id),!$._deleted)){var s=o.get($._id);"value"in s&&($.value=s.value)}}var c=sb(o);return c.forEach(function(e){if(!n.has(e)){var r={_id:e},i=o.get(e);"value"in i&&(r.value=i.value),t.push(r)}}),e.keys=bd(c.concat(e.keys)),t.push(e),t}(e,r)})})}function d(e){var r="string"==typeof e?e:e.name,t=jd[r];return t||(t=jd[r]=new ua),t}function p(e){return ub(d(e),function(){return function(e){var t,n;var a=r(e.mapFun,function(e,r){var i={id:n._id,key:ba(e)};null!=r&&(i.value=ba(r));t.push(i)}),$=e.seq||0;function s(r,t){return function(){return function(e,r,t){return e.db.get("_local/lastSeq").catch(l({_id:"_local/lastSeq",seq:0})).then(function(n){var i=sb(r);return Promise.all(i.map(function(t){return f(t,e,r)})).then(function(r){var i=Pa(r);return n.seq=t,i.push(n),e.db.bulkDocs({docs:i})})})}(e,r,t)}}var c=new ua;function u(){return e.sourceDB.changes({return_docs:!0,conflicts:!0,include_docs:!0,style:"all_docs",since:$,limit:ld}).then(v)}function v(r){var v=r.results;if(v.length){var l=function(r){for(var s=new C,c=0,u=r.length;c<u;c++){var v=r[c];if("_"!==v.doc._id[0]){t=[],(n=v.doc)._deleted||i(e.sourceDB,a,n),t.sort(o);var l=d(t);s.set(v.doc._id,[l,v.changes])}$=v.seq}return s}(v);if(c.add(s(l,$)),!(v.length<ld))return u()}}function d(e){for(var r,t=new C,n=0,i=e.length;n<i;n++){var a=e[n],o=[a.key,a.id];n>0&&0===w(a.key,r)&&o.push(n),t.set(D(o),a),r=a.key}return t}return u().then(function(){return c.finish()}).then(function(){e.seq=$})}(e)})()}function h(e,r){return ub(d(e),function(){return function(e,r){var n,i=e.reduceFun&&!1!==r.reduce,o=r.skip||0;void 0===r.keys||r.keys.length||(r.limit=0,delete r.keys);function s(r){return r.include_docs=!0,e.db.allDocs(r).then(function(e){return n=e.total_rows,e.rows.map(function(e){if("value"in e.doc&&"object"==typeof e.doc.value&&null!==e.doc.value){var r=Object.keys(e.doc.value).sort(),t=["id","key","value"];if(!(r<t||r>t))return e.doc.value}var n=ke(e.doc._id);return{key:n[0],id:n[1],value:"value"in e.doc?e.doc.value:null}})})}function c(s){var c;if(c=i?function(e,r,n){0===n.group_level&&delete n.group_level;var i=n.group||n.group_level,o=t(e.reduceFun),$=[],s=isNaN(n.group_level)?Number.POSITIVE_INFINITY:n.group_level;r.forEach(function(e){var r=$[$.length-1],t=i?e.key:null;if(i&&Array.isArray(t)&&(t=t.slice(0,s)),r&&0===w(r.groupKey,t))return r.keys.push([e.key,e.id]),void r.values.push(e.value);$.push({keys:[[e.key,e.id]],values:[e.value],groupKey:t})}),r=[];for(var c=0,u=$.length;c<u;c++){var v=$[c],l=a(e.sourceDB,o,v.keys,v.values,!1);if(l.error&&l.error instanceof Za)throw l.error;r.push({value:l.error?null:l.output,key:v.groupKey})}return{rows:function(e,r,t){return t=t||0,"number"==typeof r?e.slice(t,r+t):t>0?e.slice(t):e}(r,n.limit,n.skip)}}(e,s,r):{total_rows:n,offset:o,rows:s},r.update_seq&&(c.update_seq=e.seq),r.include_docs){var u=bd(s.map($));return e.sourceDB.allDocs({keys:u,include_docs:!0,conflicts:r.conflicts,attachments:r.attachments,binary:r.binary}).then(function(e){var r=new C;return e.rows.forEach(function(e){r.set(e.id,e.doc)}),s.forEach(function(e){var t=$(e),n=r.get(t);n&&(e.doc=n)}),c})}return c}if(void 0!==r.keys){var u=r.keys,v=u.map(function(e){var t={startkey:D([e]),endkey:D([e,{}])};return r.update_seq&&(t.update_seq=!0),s(t)});return Promise.all(v).then(Pa).then(c)}var l,f,d={descending:r.descending};if(r.update_seq&&(d.update_seq=!0),"start_key"in r&&(l=r.start_key),"startkey"in r&&(l=r.startkey),"end_key"in r&&(f=r.end_key),"endkey"in r&&(f=r.endkey),void 0!==l&&(d.startkey=r.descending?D([l,{}]):D([l])),void 0!==f){var p=!1!==r.inclusive_end;r.descending&&(p=!p),d.endkey=D(p?[f,{}]:[f])}if(void 0!==r.key){var h=D([r.key]),Q=D([r.key,{}]);d.descending?(d.endkey=h,d.startkey=Q):(d.startkey=h,d.endkey=Q)}return i||("number"==typeof r.limit&&(d.limit=r.limit),d.skip=o),s(d).then(c)}(e,r)})()}function Q(r,t,i){if("function"==typeof r._query)return function(e,r,t){return new Promise(function(n,i){e._query(r,t,function(e,r){if(e)return i(e);n(r)})})}(r,t,i);if(H(r))return function(e,r,t){var n,i,a,o=[],$="GET";if(c("reduce",t,o),c("include_docs",t,o),c("attachments",t,o),c("limit",t,o),c("descending",t,o),c("group",t,o),c("group_level",t,o),c("skip",t,o),c("stale",t,o),c("conflicts",t,o),c("startkey",t,o,!0),c("start_key",t,o,!0),c("endkey",t,o,!0),c("end_key",t,o,!0),c("inclusive_end",t,o),c("key",t,o,!0),c("update_seq",t,o),o=""===(o=o.join("&"))?"":"?"+o,void 0!==t.keys){var u="keys="+encodeURIComponent(JSON.stringify(t.keys));u.length+o.length+1<=2e3?o+=("?"===o[0]?"&":"?")+u:($="POST","string"==typeof r?n={keys:t.keys}:r.keys=t.keys)}if("string"==typeof r){var v=mb(r);return e.fetch("_design/"+v[0]+"/_view/"+v[1]+o,{headers:new ra({"Content-Type":"application/json"}),method:$,body:JSON.stringify(n)}).then(function(e){return i=e.ok,a=e.status,e.json()}).then(function(e){if(!i)throw e.status=a,ma(e);return e.rows.forEach(function(e){if(e.value&&e.value.error&&"builtin_reduce_error"===e.value.error)throw new Error(e.reason)}),e}).then(s(t))}return n=n||{},Object.keys(r).forEach(function(e){Array.isArray(r[e])?n[e]=r[e]:n[e]=r[e].toString()}),e.fetch("_temp_view"+o,{headers:new ra({"Content-Type":"application/json"}),method:"POST",body:JSON.stringify(n)}).then(function(e){return i=e.ok,a=e.status,e.json()}).then(function(e){if(!i)throw e.status=a,ma(e);return e}).then(s(t))}(r,t,i);if("string"!=typeof t)return v(i,t),kd.add(function(){return id(r,"temp_view/temp_view",t.map,t.reduce,!0,e).then(function(e){return ig(p(e).then(function(){return h(e,i)}),function(){return e.db.destroy()})})}),kd.finish();var a=t,o=mb(a),$=o[0],u=o[1];return r.get("_design/"+$).then(function(t){var o=t.views&&t.views[u];if(!o)throw new eb("ddoc "+t._id+" has no view named "+u);return n(t,u),v(i,o),id(r,a,o.map,o.reduce,!1,e).then(function(e){var $EK2n$$interop$default=q(M);return"ok"===i.stale||"update_after"===i.stale?("update_after"===i.stale&&$EK2n$$interop$default.d(function(){p(e)}),h(e,i)):p(e).then(function(){return h(e,i)})})})}return{query:function(e,r,t){var n=this;"function"==typeof r&&(t=r,r={}),r=r?function(e){return e.group_level=u(e.group_level),e.limit=u(e.limit),e.skip=u(e.skip),e}(r):{},"function"==typeof e&&(e={map:e});var i=Promise.resolve().then(function(){return Q(n,e,r)});return _c(i,t),i},viewCleanup:hg(function(){var r=this;return"function"==typeof r._viewCleanup?function(e){return new Promise(function(r,t){e._viewCleanup(function(e,n){if(e)return t(e);r(n)})})}(r):H(r)?function(e){return e.fetch("_view_cleanup",{headers:new ra({"Content-Type":"application/json"}),method:"POST"}).then(function(e){return e.json()})}(r):function(r){return r.get("_local/"+e).then(function(e){var t=new C;Object.keys(e.views).forEach(function(e){var r=mb(e),n="_design/"+r[0],i=r[1],a=t.get(n);a||(a=new Xa,t.set(n,a)),a.add(i)});var n={keys:sb(t),include_docs:!0};return r.allDocs(n).then(function(n){var i={};n.rows.forEach(function(r){var n=r.key.substring(8);t.get(r.key).forEach(function(t){var a=n+"/"+t;e.views[a]||(a=t);var o=Object.keys(e.views[a]),$=r.doc&&r.doc.views&&r.doc.views[t];o.forEach(function(e){i[e]=i[e]||$})})});var a=Object.keys(i).filter(function(e){return!i[e]}).map(function(e){return ub(d(e),function(){return new r.constructor(e,r.__opts).destroy()})()});return Promise.all(a).then(function(){return{ok:!0}})})},l({ok:!0}))}(r)})}}var _b={_sum:function(e,r){return pb(r)},_count:function(e,r){return r.length},_stats:function(e,r){return{sum:pb(r),min:Math.min.apply(null,r),max:Math.max.apply(null,r),count:r.length,sumsqr:function(e){for(var r=0,t=0,n=e.length;t<n;t++){var i=e[t];r+=i*i}return r}(r)}}};function Eg(e){if(/^_sum/.test(e))return _b._sum;if(/^_count/.test(e))return _b._count;if(/^_stats/.test(e))return _b._stats;if(/^_/.test(e))throw new Error(e+" is not a supported reduce function.")}function Fg(e,r){if("function"==typeof e&&2===e.length){var t=e;return function(e){return t(e,r)}}return fd(e.toString(),r)}function Gg(e){var r=e.toString(),t=Eg(r);return t||fd(r)}function Hg(e,r){var t=e.views&&e.views[r];if("string"!=typeof t.map)throw new eb("ddoc "+e._id+" has no string view named "+r+", instead found object of type: "+typeof t.map)}var Ig="mrviews",pd=Cg(Ig,Fg,Gg,Hg);function Kg(e,r,t){return pd.query.call(this,e,r,t)}function Lg(e){return pd.viewCleanup.call(this,e)}var Mg={query:Kg,viewCleanup:Lg};function qd(e){return /^1-/.test(e)}function Og(e,r,t){return!e._attachments||!e._attachments[t]||e._attachments[t].digest!==r._attachments[t].digest}function rd(e,r){var t=Object.keys(r._attachments);return Promise.all(t.map(function(t){return e.getAttachment(r._id,t,{rev:r._rev})}))}function Qg(e,r,t){var n=H(r)&&!H(e),i=Object.keys(t._attachments);return n?e.get(t._id).then(function(n){return Promise.all(i.map(function(i){return Og(n,t,i)?r.getAttachment(t._id,i):e.getAttachment(n._id,i)}))}).catch(function(e){if(404!==e.status)throw e;return rd(r,t)}):rd(r,t)}function Rg(e){var r=[];return Object.keys(e).forEach(function(t){e[t].missing.forEach(function(e){r.push({id:t,rev:e})})}),{docs:r,revs:!0,latest:!0}}function Sg(e,r,t,n){t=x(t);var i=[],a=!0;function o(r){return e.allDocs({keys:r,include_docs:!0,conflicts:!0}).then(function(e){if(n.cancelled)throw new Error("cancelled");e.rows.forEach(function(e){var r;e.deleted||!e.doc||!qd(e.value.rev)||(r=e.doc,r._attachments&&Object.keys(r._attachments).length>0)||function(e){return e._conflicts&&e._conflicts.length>0}(e.doc)||(e.doc._conflicts&&delete e.doc._conflicts,i.push(e.doc),delete t[e.id])})})}return Promise.resolve().then(function(){var e=Object.keys(t).filter(function(e){var r=t[e].missing;return 1===r.length&&qd(r[0])});if(e.length>0)return o(e)}).then(function(){var o=Rg(t);if(o.docs.length)return e.bulkGet(o).then(function(t){if(n.cancelled)throw new Error("cancelled");return Promise.all(t.results.map(function(t){return Promise.all(t.docs.map(function(t){var n=t.ok;return t.error&&(a=!1),n&&n._attachments?Qg(r,e,n).then(function(e){var r=Object.keys(n._attachments);return e.forEach(function(e,t){var i=n._attachments[r[t]];delete i.stub,delete i.length,i.data=e}),n}):n}))})).then(function(e){i=i.concat(Pa(e).filter(Boolean))})})}).then(function(){return{ok:a,docs:i}})}var sd=1,td="pouchdb",Vg=5,v=0;function Yb(e,r,t,n,i){return e.get(r).catch(function(t){if(404===t.status)return"http"!==e.adapter&&"https"!==e.adapter||Wb(404,"PouchDB is just checking if a remote checkpoint exists."),{session_id:n,_id:r,history:[],replicator:td,version:sd};throw t}).then(function(a){if(!i.cancelled&&a.last_seq!==t)return a.history=(a.history||[]).filter(function(e){return e.session_id!==n}),a.history.unshift({last_seq:t,session_id:n}),a.history=a.history.slice(0,Vg),a.version=sd,a.replicator=td,a.session_id=n,a.last_seq=t,e.put(a).catch(function(a){if(409===a.status)return Yb(e,r,t,n,i);throw a})})}function va(e,r,t,n,i){this.src=e,this.target=r,this.id=t,this.returnValue=n,this.opts=i||{}}va.prototype.writeCheckpoint=function(e,r){var t=this;return this.updateTarget(e,r).then(function(){return t.updateSource(e,r)})},va.prototype.updateTarget=function(e,r){return this.opts.writeTargetCheckpoint?Yb(this.target,this.id,e,r,this.returnValue):Promise.resolve(!0)},va.prototype.updateSource=function(e,r){if(this.opts.writeSourceCheckpoint){var t=this;return Yb(this.src,this.id,e,r,this.returnValue).catch(function(e){if(Ad(e))return t.opts.writeSourceCheckpoint=!1,!0;throw e})}return Promise.resolve(!0)};var xd={undefined:function(e,r){return 0===w(e.last_seq,r.last_seq)?r.last_seq:0},1:function(e,r){return $g(r,e).last_seq}};function $g(e,r){return e.session_id===r.session_id?{last_seq:e.last_seq,history:e.history}:yd(e.history,r.history)}function yd(e,r){var t=e[0],n=e.slice(1),i=r[0],a=r.slice(1);return t&&0!==r.length?zb(t.session_id,r)?{last_seq:t.last_seq,history:e}:zb(i.session_id,n)?{last_seq:i.last_seq,history:a}:yd(n,a):{last_seq:v,history:[]}}function zb(e,r){var t=r[0],n=r.slice(1);return!(!e||0===r.length)&&(e===t.session_id||zb(e,n))}function Ad(e){return"number"==typeof e.status&&4===Math.floor(e.status/100)}va.prototype.getCheckpoint=function(){var e=this;return e.opts&&e.opts.writeSourceCheckpoint&&!e.opts.writeTargetCheckpoint?e.src.get(e.id).then(function(e){return e.last_seq||v}).catch(function(e){if(404!==e.status)throw e;return v}):e.target.get(e.id).then(function(r){return e.opts&&e.opts.writeTargetCheckpoint&&!e.opts.writeSourceCheckpoint?r.last_seq||v:e.src.get(e.id).then(function(e){return r.version!==e.version?v:(t=r.version?r.version.toString():"undefined")in xd?xd[t](r,e):v;var t},function(t){if(404===t.status&&r.last_seq)return e.src.put({_id:e.id,last_seq:v}).then(function(){return v},function(t){return Ad(t)?(e.opts.writeSourceCheckpoint=!1,r.last_seq):v});throw t})}).catch(function(e){if(404!==e.status)throw e;return v})};var Bd=0;function dh(e,r,t,n){if(!1===e.retry)return r.emit("error",t),void r.removeAllListeners();if("function"!=typeof e.back_off_function&&(e.back_off_function=fg),r.emit("requestError",t),"active"===r.state||"pending"===r.state){r.emit("paused",t),r.state="stopped";var i=function(){e.current_back_off=Bd};r.once("paused",function(){r.removeListener("active",i)}),r.once("active",i)}e.current_back_off=e.current_back_off||Bd,e.current_back_off=e.back_off_function(e.current_back_off),setTimeout(n,e.current_back_off)}function eh(e){return Object.keys(e).sort(w).reduce(function(r,t){return r[t]=e[t],r},{})}function fh(e,r,t){var n=t.doc_ids?t.doc_ids.sort(w):"",i=t.filter?t.filter.toString():"",a="",o="",$="";return t.selector&&($=JSON.stringify(t.selector)),t.filter&&t.query_params&&(a=JSON.stringify(eh(t.query_params))),t.filter&&"_view"===t.filter&&(o=t.view.toString()),Promise.all([e.id(),r.id()]).then(function(e){var r=e[0]+e[1]+i+o+a+n+$;return new Promise(function(e){Gb(r,e)})}).then(function(e){return"_local/"+(e=e.replace(/\//g,".").replace(/\+/g,"_"))})}function Cd(e,r,t,n,i){var a,o,$,s=[],c={seq:0,changes:[],docs:[]},u=!1,v=!1,l=!1,f=0,d=t.continuous||t.live||!1,p=t.batch_size||100,h=t.batches_limit||10,Q=!1,X=t.doc_ids,_=t.selector,g=[],m=Wa();i=i||{ok:!0,start_time:new Date().toISOString(),docs_read:0,docs_written:0,doc_write_failures:0,errors:[]};var y={};function b(){return $?Promise.resolve():fh(e,r,t).then(function(i){o=i;var a={};a=!1===t.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!1}:"source"===t.checkpoint?{writeSourceCheckpoint:!0,writeTargetCheckpoint:!1}:"target"===t.checkpoint?{writeSourceCheckpoint:!1,writeTargetCheckpoint:!0}:{writeSourceCheckpoint:!0,writeTargetCheckpoint:!0},$=new va(e,r,o,n,a)})}function E(){if(g=[],0!==a.docs.length){var e=a.docs,o={timeout:t.timeout};return r.bulkDocs({docs:e,new_edits:!1},o).then(function(r){if(n.cancelled)throw A(),new Error("cancelled");var t=Object.create(null);r.forEach(function(e){e.error&&(t[e.id]=e)});var a=Object.keys(t).length;i.doc_write_failures+=a,i.docs_written+=e.length-a,e.forEach(function(e){var r=t[e._id];if(r){i.errors.push(r);var a=(r.name||"").toLowerCase();if("unauthorized"!==a&&"forbidden"!==a)throw r;n.emit("denied",x(r))}else g.push(e)})},function(r){throw i.doc_write_failures+=e.length,r})}}function S(){if(a.error)throw new Error("There was a problem getting docs.");i.last_seq=f=a.seq;var e=x(i);return g.length&&(e.docs=g,"number"==typeof a.pending&&(e.pending=a.pending,delete a.pending),n.emit("change",e)),u=!0,$.writeCheckpoint(a.seq,m).then(function(){if(u=!1,n.cancelled)throw A(),new Error("cancelled");a=void 0,I()}).catch(function(e){throw P(e),e})}function w(){return Sg(e,r,a.diffs,n).then(function(e){a.error=!e.ok,e.docs.forEach(function(e){delete a.diffs[e._id],i.docs_read++,a.docs.push(e)})})}function O(){var e;n.cancelled||a||(0!==s.length?(a=s.shift(),(e={},a.changes.forEach(function(r){"_user/"!==r.id&&(e[r.id]=r.changes.map(function(e){return e.rev}))}),r.revsDiff(e).then(function(e){if(n.cancelled)throw A(),new Error("cancelled");a.diffs=e})).then(w).then(E).then(S).then(O).catch(function(e){k("batch processing terminated with error",e)})):T(!0))}function T(e){0!==c.changes.length?(e||v||c.changes.length>=p)&&(s.push(c),c={seq:0,changes:[],docs:[]},"pending"!==n.state&&"stopped"!==n.state||(n.state="active",n.emit("active")),O()):0!==s.length||a||((d&&y.live||v)&&(n.state="pending",n.emit("paused")),v&&A())}function k(e,r){l||(r.message||(r.message=e),i.ok=!1,i.status="aborting",s=[],c={seq:0,changes:[],docs:[]},A(r))}function A(a){if(!(l||n.cancelled&&(i.status="cancelled",u)))if(i.status=i.status||"complete",i.end_time=new Date().toISOString(),i.last_seq=f,l=!0,a){(a=j(a)).result=i;var o=(a.name||"").toLowerCase();"unauthorized"===o||"forbidden"===o?(n.emit("error",a),n.removeAllListeners()):dh(t,n,a,function(){Cd(e,r,t,n)})}else n.emit("complete",i),n.removeAllListeners()}function D(e,r,i){if(n.cancelled)return A();var $EK2n$$interop$default=q(M);"number"==typeof r&&(c.pending=r),ob(t)(e)&&(c.seq=e.seq||i,c.changes.push(e),$EK2n$$interop$default.d(function(){T(0===s.length&&y.live)}))}function C(e){if(Q=!1,n.cancelled)return A();if(e.results.length>0)y.since=e.results[e.results.length-1].seq,I(),T(!0);else{var r=function(){d?(y.live=!0,I()):v=!0,T(!0)};a||0!==e.results.length?r():(u=!0,$.writeCheckpoint(e.last_seq,m).then(function(){u=!1,i.last_seq=f=e.last_seq,r()}).catch(P))}}function R(e){if(Q=!1,n.cancelled)return A();k("changes rejected",e)}function I(){if(!Q&&!v&&s.length<h){Q=!0,n._changes&&(n.removeListener("cancel",n._abortChanges),n._changes.cancel()),n.once("cancel",i);var r=e.changes(y).on("change",D);r.then(a,a),r.then(C).catch(R),t.retry&&(n._changes=r,n._abortChanges=i)}function i(){r.cancel()}function a(){n.removeListener("cancel",i)}}function B(){b().then(function(){if(!n.cancelled)return $.getCheckpoint().then(function(e){y={since:f=e,limit:p,batch_size:p,style:"all_docs",doc_ids:X,selector:_,return_docs:!0},t.filter&&("string"!=typeof t.filter?y.include_docs=!0:y.filter=t.filter),"heartbeat"in t&&(y.heartbeat=t.heartbeat),"timeout"in t&&(y.timeout=t.timeout),t.query_params&&(y.query_params=t.query_params),t.view&&(y.view=t.view),I()});A()}).catch(function(e){k("getCheckpoint rejected with ",e)})}function P(e){u=!1,k("writeCheckpoint completed with error",e)}n.ready(e,r),n.cancelled?A():(n._addedListeners||(n.once("cancel",A),"function"==typeof t.complete&&(n.once("error",t.complete),n.once("complete",function(e){t.complete(null,e)})),n._addedListeners=!0),void 0===t.since?B():b().then(function(){return u=!0,$.writeCheckpoint(t.since,m)}).then(function(){u=!1,n.cancelled?A():(f=t.since,B())}).catch(P))}function bb(){l.EventEmitter.call(this),this.cancelled=!1,this.state="pending";var e=this,r=new Promise(function(r,t){e.once("complete",r),e.once("error",t)});e.then=function(e,t){return r.then(e,t)},e.catch=function(e){return r.catch(e)},e.catch(function(){})}function ab(e,r){var t=r.PouchConstructor;return"string"==typeof e?new t(e,r):e}function bc(e,r,t,n){if("function"==typeof t&&(n=t,t={}),void 0===t&&(t={}),t.doc_ids&&!Array.isArray(t.doc_ids))throw j(La,"`doc_ids` filter parameter is not a list.");t.complete=n,(t=x(t)).continuous=t.continuous||t.live,t.retry="retry"in t&&t.retry,t.PouchConstructor=t.PouchConstructor||this;var i=new bb(t);return Cd(ab(e,t),ab(r,t),t,i),i}function kh(e,r,t,n){return"function"==typeof t&&(n=t,t={}),void 0===t&&(t={}),(t=x(t)).PouchConstructor=t.PouchConstructor||this,new Tb(e=ab(e,t),r=ab(r,t),t,n)}function Tb(e,r,t,n){var i=this;this.canceled=!1;var a=t.push?pa({},t,t.push):t,o=t.pull?pa({},t,t.pull):t;function $(e){i.emit("change",{direction:"pull",change:e})}function s(e){i.emit("change",{direction:"push",change:e})}function c(e){i.emit("denied",{direction:"push",doc:e})}function u(e){i.emit("denied",{direction:"pull",doc:e})}function v(){i.pushPaused=!0,i.pullPaused&&i.emit("paused")}function l(){i.pullPaused=!0,i.pushPaused&&i.emit("paused")}function f(){i.pushPaused=!1,i.pullPaused&&i.emit("active",{direction:"push"})}function d(){i.pullPaused=!1,i.pushPaused&&i.emit("active",{direction:"pull"})}this.push=bc(e,r,a),this.pull=bc(r,e,o),this.pushPaused=!0,this.pullPaused=!0;var p={};function h(e){return function(r,t){("change"===r&&(t===$||t===s)||"denied"===r&&(t===u||t===c)||"paused"===r&&(t===l||t===v)||"active"===r&&(t===d||t===f))&&(r in p||(p[r]={}),p[r][e]=!0,2===Object.keys(p[r]).length&&i.removeAllListeners(r))}}function Q(e,r,t){-1==e.listeners(r).indexOf(t)&&e.on(r,t)}t.live&&(this.push.on("complete",i.pull.cancel.bind(i.pull)),this.pull.on("complete",i.push.cancel.bind(i.push))),this.on("newListener",function(e){"change"===e?(Q(i.pull,"change",$),Q(i.push,"change",s)):"denied"===e?(Q(i.pull,"denied",u),Q(i.push,"denied",c)):"active"===e?(Q(i.pull,"active",d),Q(i.push,"active",f)):"paused"===e&&(Q(i.pull,"paused",l),Q(i.push,"paused",v))}),this.on("removeListener",function(e){"change"===e?(i.pull.removeListener("change",$),i.push.removeListener("change",s)):"denied"===e?(i.pull.removeListener("denied",u),i.push.removeListener("denied",c)):"active"===e?(i.pull.removeListener("active",d),i.push.removeListener("active",f)):"paused"===e&&(i.pull.removeListener("paused",l),i.push.removeListener("paused",v))}),this.pull.on("removeListener",h("pull")),this.push.on("removeListener",h("push"));var X=Promise.all([this.push,this.pull]).then(function(e){var r={push:e[0],pull:e[1]};return i.emit("complete",r),n&&n(null,r),i.removeAllListeners(),r},function(e){if(i.cancel(),n?n(e):i.emit("error",e),i.removeAllListeners(),n)throw e});this.then=function(e,r){return X.then(e,r)},this.catch=function(e){return X.catch(e)}}function mh(e){e.replicate=bc,e.sync=kh,Object.defineProperty(e.prototype,"replicate",{get:function(){var e=this;return void 0===this.replicateMethods&&(this.replicateMethods={from:function(r,t,n){return e.constructor.replicate(r,e,t,n)},to:function(r,t,n){return e.constructor.replicate(e,r,t,n)}}),this.replicateMethods}}),e.prototype.sync=function(e,r,t){return this.constructor.sync(this,e,r,t)}}o.d(bb,l.EventEmitter),bb.prototype.cancel=function(){this.cancelled=!0,this.state="cancelled",this.emit("cancel")},bb.prototype.ready=function(e,r){var t=this;function n(){t.cancel()}t._readyCalled||(t._readyCalled=!0,e.once("destroyed",n),r.once("destroyed",n),t.once("complete",function(){e.removeListener("destroyed",n),r.removeListener("destroyed",n)}))},o.d(Tb,l.EventEmitter),Tb.prototype.cancel=function(){this.canceled||(this.canceled=!0,this.push.cancel(),this.pull.cancel())},b.plugin(Nf).plugin(cg).plugin(Mg).plugin(mh),Ta.default=b;var nh=kg,oh=Xd.actions,ph=function(e){var n=void 0,o=new Ta.default("timothymcallister"),r=new Ta.default("http://192.168.1.86:5984/timothymcallister"),a=function(e,n){for(var o=0,r=e.length,a=void 0;o<r;)e[a=o+r>>>1]._id<n?o=a+1:r=a;return o},i=Ta.default.sync(o,r,{live:!0,retry:!0,since:0}).on("complete",function(e){return console.info(e)}).on("paused",function(e){return console.info(e)}).on("active",function(e){return console.info(e)}).on("denied",function(e){return console.error(e)}).on("error",function(e){return console.error(e)});o.allDocs({attachments:!0,include_docs:!0}).then(function(r){n=r.rows.map(function(e){return e.doc});var a=nh(e,oh(e,o,n));window.addEventListener("unload",function(){a.remove(),i.cancel()}),e.update(n)}).then(function(){o.changes({include_docs:!0,live:!0,since:"now"}).on("change",function(o){var r,i,t;o.deleted?(r=o.id,i=a(n,r),(t=n[i])&&t._id===r&&n.splice(i,1)):function(e){var o=a(n,e._id),r=n[o];r&&r._id===e._id?n[o]=e:n.splice(o,0,e)}(o.doc),e.update(n)}).on("error",function(e){return console.log.bind(console)})}).catch(console.log.bind(console))};var ja={},rh=function(t,e,$){var a=new window.CustomEvent("redom",{bubbles:!0,detail:{type:e,data:$}});(t.el||t).dispatchEvent(a)};ja.dispatch=rh;var N={},th=function(){function e(e,t){for(var r=0;r<t.length;r++){var c=t[r];c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(e,c.key,c)}}return function(t,r,c){return r&&e(t.prototype,r),c&&e(t,c),t}}();function uh(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Jb=e,wh=u,Jd=s,yh=ha;N=function(){function e(t){var r=this;uh(this,e);var c=void 0,i="flex-row",a="0";switch((t=Object.assign({cls:"",iconPosition:"left"},t)).iconPosition){case"b":case"bottom":i="flex-column",a="order-1",c="mt2";break;case"r":case"right":a="order-1",c="ml2";break;case"t":case"top":i="flex-column",c="mb2";break;case"l":default:c="mr2";}c=t.text?c:"ma0";var n=t.icon?this.icon=Jb("span.flex."+a+".items-center.justify-center."+c,t.icon):"",s=yh(t.text?t.text:"");this.el=Jb("button.bg-animate.bg-black-05.bn.br2.f6.input-reset.outline-0.pa0"+t.cls,Jb(".flex."+i+".items-center.justify-center.ph3.pointer-events-none.pv2",this.icon=n,this.text=s)),t.id&&(this.el.id=t.id),t.title&&(this.el.title=t.title),t.disabled&&this.setDisabled(),this.el.onclick=function(e){e.preventDefault(),t.onclick&&t.onclick.call(r,e)}}return th(e,[{key:"setDisabled",value:function(){this.el.disabled=!0,Jd(this.el,{opacity:.5})}},{key:"setEnabled",value:function(){this.el.disabled=!1,Jd(this.el,{opacity:1})}},{key:"setIcon",value:function(e){wh(this.icon,e)}},{key:"setText",value:function(e){this.text.textContent=e}}]),e}();var zh={};zh="/Icons.8527d875.svg";var i={};function Bh(a,$){if(!(a instanceof $))throw new TypeError("Cannot call a class as a function")}var Kd=na;i=function a($){Bh(this,a);$=Object.assign({cls:"",name:""},$),this.el=Kd("svg"+$.cls,Kd("use",{fill:"currentColor",href:zh+"#"+$.name}))};var Ld={},Md=function(){function e(e,t){for(var l=0;l<t.length;l++){var r=t[l];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}return function(t,l,r){return l&&e(t.prototype,l),r&&e(t,r),t}}();function Nd(e){if(Array.isArray(e)){for(var t=0,l=Array(e.length);t<e.length;t++)l[t]=e[t];return l}return Array.from(e)}function Od(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Hh=e,Ih=Zb,Jh=ja.dispatch;Ld=function(){function e(t){var l=this;Od(this,e);var r=function(){function e(){Od(this,e),t.cell&&(this.cell=new t.cell,this.el=Hh("li",this.cell))}return Md(e,[{key:"update",value:function(e){this.el.id=e._id,this.cell&&this.cell.update(e)}}]),e}();this.el=Ih("ul.list.ma0.overflow-y-auto.pa0"+(t.class||""),r,t.key||null),this.el.el.id=t.id||"",this.el.el.onclick=function(e){"UL"!==e.target.nodeName&&(l.toggleSelection(e),Jh(l.el,"list:selection",{list:l.el.el,target:l.selectedElement.parentNode}))},this.selectedElement=null,this.selectedClasses=t.selectedClasses||["bg-black-05","black"]}return Md(e,[{key:"selectElementById",value:function(e){var t=document.getElementById(e);t&&(this.toggleSelection({target:t.firstElementChild}),this.selectedElement.scrollIntoViewIfNeeded())}},{key:"selectElementByIndex",value:function(e){this.el.el.childNodes.length&&(this.toggleSelection({target:this.el.el.childNodes[e]}),this.selectedElement.scrollIntoViewIfNeeded())}},{key:"toggleSelection",value:function(e){var t,l;this.selectedElement&&(l=this.selectedElement.classList).remove.apply(l,Nd(this.selectedClasses));this.selectedElement=e.target,(t=this.selectedElement.classList).add.apply(t,Nd(this.selectedClasses))}},{key:"update",value:function(e){this.el.update(e),!this.selectedElement&&this.el.el.children.length&&this.toggleSelection({target:this.el.el.firstChild})}}]),e}();var Kh={},Lh=function(){function e(e,r){for(var $=0;$<r.length;$++){var t=r[$];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,$,t){return $&&e(r.prototype,$),t&&e(r,t),r}}();function Mh(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var Pd=e,Oh=ha;Kh=function(){function e(){Mh(this,e),this.el=Pd(".f5.flex.items-center.pa3",Pd(".flex.items-center",new i({cls:".h2.mr3.w2",name:"Collection"})),this.text=Oh())}return Lh(e,[{key:"update",value:function(e){this.text.textContent=e.name}}]),e}();var $={};function Qh(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var Rh=e,Sh=u;$=function e(r){Qh(this,e);(r=Object.assign({border:!0,cls:"",items:[],spacing:!0},r)).border?r.cls+=".b--black-10":r.cls+=".b--transparent",r.spacing&&(r.cls+=".ph3.pv2"),this.el=Rh(".bb.bt.flex.flex-none.items-center.relative"+r.cls),Sh(this.el,r.items)};var Th={},Uh=function(){function e(e,r){for(var $=0;$<r.length;$++){var t=r[$];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}return function(r,$,t){return $&&e(r.prototype,$),t&&e(r,t),r}}();function Vh(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var Rd=e,Xh=s,Yh=ja.dispatch;Th=function(){function e(){var r=this;Vh(this,e),this.el=Rd(".b--black-10.bg-black-025.bottom-0.br.fixed.flex.flex-column.left-0.top-0.vh-100",new $({border:!1,items:[Rd("h1.f3.fw7.black.lh-title.ma0","Collections")]}),this.list=new Ld({cell:Kh,class:".black-50.flex-auto",id:"collections",key:"_id",selectedClasses:["bg-black-05","blue"]}),new $({border:!1,items:[new N({icon:new i({cls:".h1.w1",name:"Add"}),onclick:function(e){return Yh(r,"collection:add",e)}})]})),Xh(this.el,{width:"320px"})}return Uh(e,[{key:"update",value:function(e){var r=e.filter(function(e){return"collection"===e.type});this.list.update(r),this.list.selectElementById(localStorage.getItem("selectedCollection"))}}]),e}();var Ra={};function $h(r,e){if(!(r instanceof e))throw new TypeError("Cannot call a class as a function")}var ia=e,Oj=ja.dispatch;Ra=function r(e){$h(this,r);var a={afterFieldDecorator:ia(""),beforeFieldDecorator:ia("")},$=(e=Object.assign(a,e)).required?" *":"",o=""+e.label+$,t="";e.help&&(t=ia("p.black-50.f7.lh-copy.ma0.mt1",e.help)),this.el=ia(".mb4",this.label=ia("label.black-50.db.f7.fw6.mb3.tracked.ttu",o),this.beforeFieldDecorator=e.beforeFieldDecorator,this.content=ia(""),this.afterFieldDecorator=e.afterFieldDecorator,this.help=t)};var J={};function ci(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function di(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function ei(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}var fi=e,gi=u;J=function(e){function r(e,t){ci(this,r);var n=di(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t)),o={autocapitalize:"off",autocorrect:"off",autocomplete:e.name,name:e.name,required:e.required,spellcheck:!1,value:t||""},s=(e=Object.assign({oninput:function(){},singleLine:!0},e)).singleLine?"input":"textarea";return!1===e.singleLine&&(o.rows=10,o.style="resize: none"),n.field=fi(s+".bg-black-05.black.bn.border-box.br2.db.f5.lh-copy.input-reset.ma0.pa2.w-100",o),n.field.oninput=e.oninput,gi(n.content,n.field),n}return ei(r,Ra),r}();var hi={};function ii(r,t){if(!(r instanceof t))throw new TypeError("Cannot call a class as a function")}function ji(r,t){if(!r)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?r:t}function ki(r,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);r.prototype=Object.create(t&&t.prototype,{constructor:{value:r,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(r,t):r.__proto__=t)}hi=function(r){function t(r,e){ii(this,t),r=Object.assign(r,{attributes:{type:"color"}});var o=ji(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,r,e));return o.field.classList.add("h3"),o}return ki(t,J),t}();var li={};function mi(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function ni(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?t:r}function oi(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}li=function(t){function r(t,e){return mi(this,r),t=Object.assign(t,{attributes:{type:t.timepicker?"datetime-local":"date"}}),ni(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e))}return oi(r,J),r}();var pi={};function qi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function ri(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function si(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}pi=function(t){function e(t,r){return qi(this,e),t=Object.assign(t,{attributes:{type:"email"}}),ri(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r))}return si(e,J),e}();var ib,Wd={},Jj=arguments[0];!function(e){var i=/^(b|B)$/,t={iec:{bits:["b","Kib","Mib","Gib","Tib","Pib","Eib","Zib","Yib"],bytes:["B","KiB","MiB","GiB","TiB","PiB","EiB","ZiB","YiB"]},jedec:{bits:["b","Kb","Mb","Gb","Tb","Pb","Eb","Zb","Yb"],bytes:["B","KB","MB","GB","TB","PB","EB","ZB","YB"]}},o={iec:["","kibi","mebi","gibi","tebi","pebi","exbi","zebi","yobi"],jedec:["","kilo","mega","giga","tera","peta","exa","zetta","yotta"]};function r(e){var r,a,b,n,s,f,d,l,u,$,p,B,c,m=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},v=[],g=0,y=void 0,x=void 0;if(isNaN(e))throw new Error("Invalid arguments");return a=!0===m.bits,u=!0===m.unix,r=m.base||2,l=void 0!==m.round?m.round:u?1:2,$=void 0!==m.separator&&m.separator||"",p=void 0!==m.spacer?m.spacer:u?"":" ",c=m.symbols||m.suffixes||{},B=2===r&&m.standard||"jedec",d=m.output||"string",n=!0===m.fullform,s=m.fullforms instanceof Array?m.fullforms:[],y=void 0!==m.exponent?m.exponent:-1,b=r>2?1e3:1024,(f=(x=Number(e))<0)&&(x=-x),(-1===y||isNaN(y))&&(y=Math.floor(Math.log(x)/Math.log(b)))<0&&(y=0),y>8&&(y=8),0===x?(v[0]=0,v[1]=u?"":t[B][a?"bits":"bytes"][y]):(g=x/(2===r?Math.pow(2,10*y):Math.pow(1e3,y)),a&&(g*=8)>=b&&y<8&&(g/=b,y++),v[0]=Number(g.toFixed(y>0?l:0)),v[1]=10===r&&1===y?a?"kb":"kB":t[B][a?"bits":"bytes"][y],u&&(v[1]="jedec"===B?v[1].charAt(0):y>0?v[1].replace(/B$/,""):v[1],i.test(v[1])&&(v[0]=Math.floor(v[0]),v[1]=""))),f&&(v[0]=-v[0]),v[1]=c[v[1]]||v[1],"array"===d?v:"exponent"===d?y:"object"===d?{value:v[0],suffix:v[1],symbol:v[1]}:(n&&(v[1]=s[y]?s[y]:o[B][y]+(a?"bit":"byte")+(1===v[0]?"":"s")),$.length>0&&(v[0]=v[0].toString().replace(".",$)),v.join(p))}r.partial=function(e){return function(i){return r(i,e)}},void 0!==Wd?Wd=r:"function"==typeof ib&&ib.amd?ib(function(){return r}):e.filesize=r}("undefined"!=typeof window?window:n);var wi={},xi=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}();function yi(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function zi(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function Ai(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}var g=e,Ci=u,Di=s,Ja=ha;wi=function(e){function t(e,r){yi(this,t);e=Object.assign({oninput:function(){}},e);var a=zi(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r));return a.field=g(".bg-black-05.black-50.bn.br2.db.f5.h5.pa2",a.inputContainer=g(".h-100",g(".h-100.relative",a.imageInput=g("input.db.h-100.o-0.w-100",{accept:"image/*",type:"file"}),g(".absolute.absolute--fill.flex.items-center.justify-center.pointer-events-none",g(".flex.items-center",new i({cls:".h3.w3",name:"Photo"}),g(".flex-auto.pl3",g("h2.f4.fw5.lh-title.ma0.mb1","Drag & Drop Image Here"),g("p.f7.fw4.lh-copy.ma0","or ",g("u","Upload an Image."),g("span.ml1","(jpeg, gif, png or svg)"))))))),a.imageContainer=g(".dn.h-100",g(".flex.h-100",g(".flex.h-100.items-center.justify-center.w-40",a.image=g("img.db.h-100.w-100")),g(".w-60.pa3",a.imageName=g("h3.black.f5.fw5.lh-title.ma0.mb3"),g(".f6.flex.items-center.lh-copy.mb1",new i({cls:".dib.h1.mr2.w1",name:"Size"}),a.imageWidth=Ja(),Ja(" \xD7 "),a.imageHeight=Ja()),g(".f6.flex.items-center.lh-copy",new i({cls:".dib.h1.mr2.w1",name:"Speed"}),a.imageSize=Ja()),new $({border:!1,spacing:!1,cls:".mv3",children:[g("label.mr2",a.replaceImageButton=new N({text:"Replace",onclick:function(e){return a.imageInput.click()},icon:new i({cls:".h1.w1",name:"Replace"})})),a.deleteImageButton=new N({text:"Delete",onclick:function(e){confirm("Are you sure you want to delete this image?")&&(a.image.src="",a.imageInput.value="",a.toggleImageContainer())},icon:new i({cls:".h1.w1",name:"Delete"})})]}))))),Di(a.image,{objectFit:"contain"}),a.field.ondragover=function(e){return e.preventDefault()},a.field.ondrop=function(e){e.preventDefault(),a.toggleImageContainer(),a.setImageDetails(e.dataTransfer.files[0])},a.imageInput.name=e.name,a.imageInput.oninput=function(t){a.imageContainer.classList.contains("dn")&&a.toggleImageContainer(),a.setImageDetails(t.target.files[0]),e.oninput.call(a,t)},Ci(a.content,a.field),a}return Ai(t,Ra),xi(t,[{key:"setImageDetails",value:function(e){var t=this,r=new FileReader;r.onloadend=function(){return t.image.src=r.result},r.readAsDataURL(e),this.image.onload=function(e){t.imageWidth.textContent=t.image.naturalWidth,t.imageHeight.textContent=t.image.naturalHeight},this.imageName.textContent=e.name,this.imageSize.textContent=Wd(e.size,{base:10,round:0})}},{key:"toggleImageContainer",value:function(){this.inputContainer.classList.toggle("dn"),this.imageContainer.classList.toggle("dn")}}]),t}();var Fi={};function Gi(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Hi(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function Ii(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Fi=function(t){function e(t,n){return Gi(this,e),t=Object.assign(t,{attributes:{max:t.max,min:t.min,type:"number"}}),Hi(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,n))}return Ii(e,J),e}();var Ji={};Ji="/arrow-down.59db0ba6.svg";var Yd={};function Li(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function Mi(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function Ni(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}var Zd=e,Pi=u,Qi=s;Yd=function(e){function r(e,t){Li(this,r);e=Object.assign({oninput:function(){}},e);var n=Mi(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t)),o=e.options.map(function(e){return Zd("option",{value:e.value},e.label)});return n.field=Zd("select.bg-black-05.black.bn.border-box.br2.db.f5.lh-copy.input-reset.ma0.pa2.w-100",{name:e.name},o),n.field.oninput=e.oninput,Qi(n.field,{backgroundImage:"url("+Ji+")",backgroundPosition:"right 8px center",backgroundSize:"16px",backgroundRepeat:"no-repeat"}),Pi(n.content,n.field),n}return Ni(r,Ra),r}();var Ri={};function Si(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Ti(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function Ui(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}Ri=function(t){function e(t,r){return Si(this,e),t.attributes={type:"text"},Ti(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r))}return Ui(e,J),e}();var Vi={};function Wi(t,r){if(!(t instanceof r))throw new TypeError("Cannot call a class as a function")}function Xi(t,r){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?t:r}function Yi(t,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);t.prototype=Object.create(r&&r.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(t,r):t.__proto__=r)}Vi=function(t){function r(t,e){return Wi(this,r),t=Object.assign(t,{attributes:{type:"phone"}}),Xi(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,t,e))}return Yi(r,J),r}();var Zi={};function $i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function _i(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}function aj(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}Zi=function(e){function t(e,r,n){return $i(this,t),e.options=[{label:"",value:""}].concat(n.filter(function(t){return t.parent===e.collection}).map(function(e){return{label:e.name,value:e._id}})),_i(this,(t.__proto__||Object.getPrototypeOf(t)).call(this,e,r))}return aj(t,Yd),t}();var bj={};function cj(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function dj(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function ej(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}bj=function(e){function r(e,t){return cj(this,r),e=Object.assign(e,{beforeFieldDecorator:new $({border:!1,cls:".pb2",spacing:!1,items:[new N({cls:".mr2",icon:new i({cls:".h1.w1",name:"Bold"})}),new N({cls:".mr2",icon:new i({cls:".h1.w1",name:"Italics"})}),new N({icon:new i({cls:".h1.w1",name:"Underline"})})]}),singleLine:!1}),dj(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t))}return ej(r,J),r}();var fj={};function gj(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}function hj(e,r){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!r||"object"!=typeof r&&"function"!=typeof r?e:r}function ij(e,r){if("function"!=typeof r&&null!==r)throw new TypeError("Super expression must either be null or a function, not "+typeof r);e.prototype=Object.create(r&&r.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),r&&(Object.setPrototypeOf?Object.setPrototypeOf(e,r):e.__proto__=r)}var P=e,kj=u,lj=s;fj=function(e){function r(e,t){gj(this,r);e=Object.assign({oninput:function(e){}},e);var n=hj(this,(r.__proto__||Object.getPrototypeOf(r)).call(this,e,t));return n.field=P("label.flex.items-center",[P("input",{name:e.name,type:"hidden",value:"0"}),n.input=P("input.dn.switch",{name:e.name,type:"checkbox",value:"1"}),n.track=P("div.b--transparent.ba.br-pill.bw1.overflow-hidden.white",{"data-name":"track"},n.innerTrack=P("div.flex.items-center.flex-nowrap.w4",{"data-name":"inner-track"},P("span.db.f6.fw7.ph2.tc.ttu.w2","On"),P("span.bg-near-white.br-100.db.h2.w2"),P("span.db.f6.fw7.ph2.tc.ttu.w2","Off")))]),n.input.checked=1==t,n.input.oninput=e.oninput,lj(n.track,{width:"5.5rem"}),kj(n.content,n.field),n}return ij(r,Ra),r}();var mj={};function nj(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function oj(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}function pj(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}mj=function(t){function e(t,r){nj(this,e);var n=["http://","https://"];t=Object.assign(t,{attributes:{maxlength:524288,minlength:n[0].length,pattern:"(http://.*|https://.*)",type:"url"}});var a=oj(this,(e.__proto__||Object.getPrototypeOf(e)).call(this,t,r));return a.field.addEventListener("blur",function(t){var e=t.target,r=e.value;!1===r.startsWith(n[0])&&!1===r.startsWith(n[1])&&""!==r&&(e.value=n[0]+r)}),a}return pj(e,J),e}();var qj={};qj={Color:hi,Datetime:li,Email:pi,Image:wi,Input:J,Number:Fi,Option:Yd,Plaintext:Ri,Phone:Vi,Reference:Zi,Richtext:bj,Switch:fj,URL:mj};var rj={},sj=function(){function e(e,t){for(var r=0;r<t.length;r++){var i=t[r];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,r,i){return r&&e(t.prototype,r),i&&e(t,i),t}}();function tj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var Ba=e,vj=u,wj=s,_d=ja.dispatch;rj=function(){function e(){var t=this;tj(this,e),this.record=null,this.el=Ba(".bg-white.bottom-0.fixed.flex.flex-column.right-0.top-0.vh-100",Ba(".flex-auto.overflow-y-auto.pv5",this.form=Ba("form.center.w-80")),new $({items:[this.deleteButton=new N({icon:new i({cls:".h1.w1",name:"Delete"}),text:"Delete",title:"Delete",onclick:function(e){confirm("Are you sure you want to delete the selected record?")&&_d(t,"record:delete",{id:t.record._id})}}),this.saveButton=new N({cls:".bg-blue.ml-auto.white",icon:new i({cls:".h1.w1",name:"Checkmark"}),text:"Save",title:"Save",onclick:function(e){t.saveButton.disabled=!0,_d(t,"record:update",{target:t.form})}})]})),wj(this.el,{left:"640px",minWidth:"640px"})}return sj(e,[{key:"update",value:function(e){var t=this,r=[],i=e.filter(function(e){return e._id===localStorage.getItem("selectedCollection")}).shift(),$=e.filter(function(e){return e._id===localStorage.getItem("selectedRecord")}).shift();this.deleteButton.setDisabled(),this.saveButton.setDisabled(),void 0!==$&&(null===this.record&&(this.record=$),"_id"in this.record&&$._id!==this.record._id&&(this.el.scrollTop=0),this.record=$,this.record&&(i.fields.map(function(i){var $=t.record[i.name];r.push(new qj[i.type](i,$,e))}),r.push(Ba("input",{name:"_id",type:"hidden",value:this.record._id}),Ba("input",{name:"_rev",type:"hidden",value:this.record._rev}))),this.deleteButton.setEnabled(),this.saveButton.setEnabled()),vj.apply(void 0,[this.form].concat(r)),this.form.elements.length&&this.form.elements[0].focus()}}]),e}();var xb,Nb={};!function(n){var t={},e=/d{1,4}|M{1,4}|YY(?:YY)?|S{1,3}|Do|ZZ|([HhMsDm])\1?|[aA]|"[^"]*"|'[^']*'/g,r=/\d\d?/,u=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,o=/\[([^]*?)\]/gm,a=function(){};function i(n,t){for(var e=[],r=0,u=n.length;r<u;r++)e.push(n[r].substr(0,t));return e}function s(n){return function(t,e,r){var u=r[n].indexOf(e.charAt(0).toUpperCase()+e.substr(1).toLowerCase());~u&&(t.month=u)}}function m(n,t){for(n=String(n),t=t||2;n.length<t;)n="0"+n;return n}var c=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],f=["January","February","March","April","May","June","July","August","September","October","November","December"],d=i(f,3),h=i(c,3);t.i18n={dayNamesShort:h,dayNames:c,monthNamesShort:d,monthNames:f,amPm:["am","pm"],DoFn:function(n){return n+["th","st","nd","rd"][n%10>3?0:(n-n%10!=10)*n%10]}};var l={D:function(n){return n.getDate()},DD:function(n){return m(n.getDate())},Do:function(n,t){return t.DoFn(n.getDate())},d:function(n){return n.getDay()},dd:function(n){return m(n.getDay())},ddd:function(n,t){return t.dayNamesShort[n.getDay()]},dddd:function(n,t){return t.dayNames[n.getDay()]},M:function(n){return n.getMonth()+1},MM:function(n){return m(n.getMonth()+1)},MMM:function(n,t){return t.monthNamesShort[n.getMonth()]},MMMM:function(n,t){return t.monthNames[n.getMonth()]},YY:function(n){return String(n.getFullYear()).substr(2)},YYYY:function(n){return m(n.getFullYear(),4)},h:function(n){return n.getHours()%12||12},hh:function(n){return m(n.getHours()%12||12)},H:function(n){return n.getHours()},HH:function(n){return m(n.getHours())},m:function(n){return n.getMinutes()},mm:function(n){return m(n.getMinutes())},s:function(n){return n.getSeconds()},ss:function(n){return m(n.getSeconds())},S:function(n){return Math.round(n.getMilliseconds()/100)},SS:function(n){return m(Math.round(n.getMilliseconds()/10),2)},SSS:function(n){return m(n.getMilliseconds(),3)},a:function(n,t){return n.getHours()<12?t.amPm[0]:t.amPm[1]},A:function(n,t){return n.getHours()<12?t.amPm[0].toUpperCase():t.amPm[1].toUpperCase()},ZZ:function(n){var t=n.getTimezoneOffset();return(t>0?"-":"+")+m(100*Math.floor(Math.abs(t)/60)+Math.abs(t)%60,4)}},M={D:[r,function(n,t){n.day=t}],Do:[new RegExp(r.source+u.source),function(n,t){n.day=parseInt(t,10)}],M:[r,function(n,t){n.month=t-1}],YY:[r,function(n,t){var e=+(""+new Date().getFullYear()).substr(0,2);n.year=""+(t>68?e-1:e)+t}],h:[r,function(n,t){n.hour=t}],m:[r,function(n,t){n.minute=t}],s:[r,function(n,t){n.second=t}],YYYY:[/\d{4}/,function(n,t){n.year=t}],S:[/\d/,function(n,t){n.millisecond=100*t}],SS:[/\d{2}/,function(n,t){n.millisecond=10*t}],SSS:[/\d{3}/,function(n,t){n.millisecond=t}],d:[r,a],ddd:[u,a],MMM:[u,s("monthNamesShort")],MMMM:[u,s("monthNames")],a:[u,function(n,t,e){var r=t.toLowerCase();r===e.amPm[0]?n.isPm=!1:r===e.amPm[1]&&(n.isPm=!0)}],ZZ:[/([\+\-]\d\d:?\d\d|Z)/,function(n,t){"Z"===t&&(t="+00:00");var e,r=(t+"").match(/([\+\-]|\d\d)/gi);r&&(e=60*r[1]+parseInt(r[2],10),n.timezoneOffset="+"===r[0]?e:-e)}]};M.dd=M.d,M.dddd=M.ddd,M.DD=M.D,M.mm=M.m,M.hh=M.H=M.HH=M.h,M.MM=M.M,M.ss=M.s,M.A=M.a,t.masks={default:"ddd MMM DD YYYY HH:mm:ss",shortDate:"M/D/YY",mediumDate:"MMM D, YYYY",longDate:"MMMM D, YYYY",fullDate:"dddd, MMMM D, YYYY",shortTime:"HH:mm",mediumTime:"HH:mm:ss",longTime:"HH:mm:ss.SSS"},t.format=function(n,r,u){var a=u||t.i18n;if("number"==typeof n&&(n=new Date(n)),"[object Date]"!==Object.prototype.toString.call(n)||isNaN(n.getTime()))throw new Error("Invalid Date in fecha.format");r=t.masks[r]||r||t.masks.default;var i=[];return(r=(r=r.replace(o,function(n,t){return i.push(t),"??"})).replace(e,function(t){return t in l?l[t](n,a):t.slice(1,t.length-1)})).replace(/\?\?/g,function(){return i.shift()})},t.parse=function(n,r,u){var o=u||t.i18n;if("string"!=typeof r)throw new Error("Invalid format in fecha.parse");if(r=t.masks[r]||r,n.length>1e3)return!1;var a=!0,i={};if(r.replace(e,function(t){if(M[t]){var e=M[t],r=n.search(e[0]);~r?n.replace(e[0],function(t){return e[1](i,t,o),n=n.substr(r+t.length),t}):a=!1}return M[t]?"":t.slice(1,t.length-1)}),!a)return!1;var s,m=new Date;return!0===i.isPm&&null!=i.hour&&12!=+i.hour?i.hour=+i.hour+12:!1===i.isPm&&12==+i.hour&&(i.hour=0),null!=i.timezoneOffset?(i.minute=+(i.minute||0)-+i.timezoneOffset,s=new Date(Date.UTC(i.year||m.getFullYear(),i.month||0,i.day||1,i.hour||0,i.minute||0,i.second||0,i.millisecond||0))):s=new Date(i.year||m.getFullYear(),i.month||0,i.day||1,i.hour||0,i.minute||0,i.second||0,i.millisecond||0),s},Nb?Nb=t:"function"==typeof xb&&xb.amd?xb(function(){return t}):n.fecha=t}(Nb);var Aj={},Bj=function(){function e(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,r,a){return r&&e(t.prototype,r),a&&e(t,a),t}}();function Cj(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var sa=e;Aj=function(){function e(){Cj(this,e),this.el=sa(".pl3.relative",sa(".b--black-10.bb.pointer-events-none.pr3.pv3",this.title=sa("h1.f5.fw6.lh-title.ma0.mb1.truncate"),this.body=sa("p.f5.lh-copy.ma0.mb2.truncate"),this.date=sa("time.f7.ma0")))}return Bj(e,[{key:"update",value:function(e){this.title.textContent=e.name,this.body.textContent=e.body,this.date.textContent=Nb.format(new Date(e.modified),"mediumDate")}}]),e}();var Ej={},Fj=function(){function e(e,r){for(var a=0;a<r.length;a++){var n=r[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(r,a,n){return a&&e(r.prototype,a),n&&e(r,n),r}}();function Gj(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var Hb=e;Ej=function(){function e(){var r=this;Gj(this,e),this.el=Hb(".relative.w-100",Hb(".absolute.ml2.mt2.z1",new i({cls:".black-50.h1.w1",name:"Search"})),this.search=Hb("input.bg-black-05.bn.br2.db.f6.input-reset.near-black.outline-0.pa2.pl4.w-100",{oninput:function(e){r.oninput(e.target.value)},placeholder:"Search",type:"search"}))}return Fj(e,[{key:"clear",value:function(){this.search.value=""}},{key:"oninput",value:function(e){}}]),e}();var vi={},ai=function(){function e(e,r){for(var t=0;t<r.length;t++){var o=r[t];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}return function(r,t,o){return t&&e(r.prototype,t),o&&e(r,o),r}}();function he(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var Hj=e,zj=s,ti=ja.dispatch;vi=function(){function e(){var r=this;he(this,e),this.collection=null,this.docs=this.filteredDocs=this.searchResults=[],this.el=Hj(".b--black-10.bg-black-025.bottom-0.br.fixed.flex.flex-column.top-0.vh-100",new $({items:[this.search=new Ej]}),this.list=new Ld({cell:Aj,class:".black.flex-auto",id:"records",key:"_id",selectedClasses:["bg-blue","white"]}),new $({border:!1,items:[new N({icon:new i({cls:".h1.w1",name:"Add"}),onclick:function(e){return ti(r,"record:add",e)}})]})),zj(this.el,{left:"320px",width:"320px"}),this.search.oninput=function(e){e=e.toLocaleLowerCase(),r.searchResults=""===e?r.filteredDocs=r.docs:r.filteredDocs.filter(function(r){return Object.keys(r).some(function(t){var o=!1,a=r[t];return"string"==typeof a&&(o=a.toLocaleLowerCase().includes(e)),o})}),r.list.update(r.searchResults)}}return ai(e,[{key:"applyFilter",value:function(e){var r=this,t=localStorage.getItem("selectedCollection");return t!==this.collection&&(this.searchResults=[],this.search.clear()),this.collection=t,this.docs=e.filter(function(e){return"record"===e.type&&e.parent===r.collection}),this.searchResults.length?this.searchResults:this.docs}},{key:"selectRecord",value:function(){this.docs.length&&(localStorage.getItem("selectedRecord")?this.list.selectElementById(localStorage.getItem("selectedRecord")):this.list.selectElementByIndex(0))}},{key:"update",value:function(e){this.filteredDocs=this.applyFilter(e),this.list.update(this.filteredDocs),this.selectRecord()}}]),e}();var _h={},Ph=function(){function e(e,r){for(var o=0;o<r.length;o++){var $=r[o];$.enumerable=$.enumerable||!1,$.configurable=!0,"value"in $&&($.writable=!0),Object.defineProperty(e,$.key,$)}}return function(r,o,$){return o&&e(r.prototype,o),$&&e(r,$),r}}();function qh(e,r){if(!(e instanceof r))throw new TypeError("Cannot call a class as a function")}var ch=e;_h=function(){function e(){qh(this,e),this.el=ch("main",this.collections=new Th,this.records=new vi,this.record=new rj)}return Ph(e,[{key:"update",value:function(e){this.collections.update(e),this.records.update(e),this.record.update(e)}}]),e}();var wg=u,qf=ph,Ze=function(){var $=new _h;qf($),wg(document.body,$)};Ze();})();